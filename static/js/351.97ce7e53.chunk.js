(self.webpackChunktoolkit=self.webpackChunktoolkit||[]).push([[351],{93160:(e,t,n)=>{"use strict";n.d(t,{Ls:()=>u,MS:()=>d,V2:()=>h,ay:()=>p});var r=n(73365),i=n(64162),o=n.n(i);const s=101,a="d",l="c",c="ss";function d(e){return o().compressToEncodedURIComponent(JSON.stringify(e))}function u(e){e=o().decompressFromEncodedURIComponent(e);try{e=JSON.parse(e)}catch(t){throw new Error("\u6570\u636e\u683c\u5f0f\u5f02\u5e38")}return e}function p(e,t){const n=t.secretKey?r.Wj:void 0,i=r.UE.convertBackupData(JSON.stringify(e),s,n,t.secretKey),o={};n&&(o[c]=n);let d={};return d[a]=i,Object.keys(o).length>0&&(d[l]=o),JSON.stringify(d)}function h(e,t){const n=JSON.parse(e);let i=n[a];if("string"!==typeof i)throw new Error("\u6570\u636e\u683c\u5f0f\u5f02\u5e38");let o=n[l];if(o){if("object"!==typeof o)throw new Error("\u6570\u636e\u683c\u5f0f\u5f02\u5e38");o.secretKey=t}try{let e=JSON.parse(i);i=e[a],o=e[l]}catch(s){}return o||(o={}),JSON.parse(r.UE.convertOriginData(i,o[c],o.secretKey||t))}},73365:(e,t,n)=>{"use strict";n.d(t,{UE:()=>l,Wj:()=>s,fp:()=>u});var r=n(52984),i=n.n(r),o=n(87518);const s=1,a=(()=>{const e={encrypt:e=>e,decrypt:e=>e},t={};var n;return n={encrypt:(e,t)=>i().AES.encrypt(e,t).toString(),decrypt:(e,t)=>i().AES.decrypt(e,t).toString(i().enc.Utf8)},t[s]=n,n=>t[n]||e})();const l=new class{constructor(){this.featurePrefix="devinx3",this.verionPrefix="ver",this.fixVersion="000",this.fixSecret="ver000"}encrypt(e,t){return i().AES.encrypt(e,t).toString()}decrypt(e,t){return i().AES.decrypt(e,t).toString(i().enc.Utf8)}convertSecret(e){return e>=100&&e<=999?this.verionPrefix+e:this.fixSecret}getFeatureSuffix(e){return e===this.fixSecret?"S":"l"}getFeatureSecretIndex(e){if(e<100)return-1;const t=e-10-10,n=[],r=[17,27,23,3,19,11];for(let i=0;i<6;i++)n.push(10+(t*r[i]/30^0));return n}addSecret(e,t,n){return e.slice(0,t)+n+e.slice(t)}removeSecret(e,t){return e.slice(0,t)+e.slice(t+1)}convertBackupData(e,t,n,r){const i=a(n).encrypt(e,r);let o=this.convertSecret(t),s=this.encrypt(i,o);s.length<100&&(o=this.fixSecret,s=this.encrypt(i,o));const l=this.featurePrefix,c=s.length,d=this.getFeatureSuffix(o);if(o===this.fixSecret)return l+c+d+s;const u=this.getFeatureSecretIndex(c);let p=s;for(let a=u.length-1;a>=0;a--)p=this.addSecret(p,u[a],o[a]);return l+c+d+p}convertOriginData(e,t,n){if(!e)throw new Error("\u6570\u636e\u4e0d\u80fd\u4e3a\u7a7a");const r=e.slice(0,this.featurePrefix.length);if(r!==this.featurePrefix)throw new Error("\u5339\u914d\u7279\u5f81\u524d\u7f00\u5f02\u5e38");const i=r.length+10;let o="l",s=e.indexOf(o);if((s<0||s>=i)&&(o="S",s=e.indexOf(o),s<0||s>=i))throw new Error("\u5339\u914d\u7279\u5f81\u540e\u7f00\u5f02\u5e38");let l=Number(e.slice(r.length,s));if(!l)throw new Error("\u5339\u914d\u6570\u636e\u957f\u5ea6\u5f02\u5e38");const c=this.getFeatureSecretIndex(l),d=e.slice(s+1);let u="";if(-1===c)u=this.encrypt(e,d);else{let e=d,t="";for(let n=0;n<c.length;n++)t+=e[c[n]],e=this.removeSecret(e,c[n]);u=this.decrypt(e,t)}try{return a(t).decrypt(u,n)}catch(p){throw console.error(p),new Error("\u5bc6\u94a5\u9519\u8bef")}}},c=e=>i().MD5(e||"0").toString(i().enc.Hex),d=e=>(null===e||void 0===e?void 0:e.startsWith)&&e.startsWith(o.Je.PLATFORM),u={generateCode:c,generateVersion:()=>parseInt(Math.floor(((new Date).getTime()-17040384e5)/1e3),10).toString(16),canUpdate:(e,t)=>{if(!e)return!0;if(!t)return!1;const n=parseInt(e,16);return parseInt(t,16)>n},convertBasicButtons:e=>{const t=[];return e&&e.forEach(((e,n)=>{const r={...e};var i;r.code=(i=e.code||n,o.Je.PLATFORM+c(i)),t.push(r)})),t},isBasic:e=>null!==e&&void 0!==e&&e.code?d(e.code):d(e)}},38991:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Qt});var r=n(47313),i=n(68197),o=n(59624),s=n(61763),a=n(23232),l=n(73365);const c=e=>"devinx3.toolkit.edit.config.".concat(e),d=e=>"devinx3.toolkit.edit.combination.".concat(e),u=e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):null},p={editConfig:"editConfig",editCombination:"editCombination"},h=(()=>{const e={},t=e=>({query:t=>u(e(t)),list:t=>{return n=e(t),u(n)||[];var n},store:(t,n)=>((e,t)=>{localStorage.setItem(e,JSON.stringify(t))})(e(t),n)});return{registerMapper:(n,r)=>e[n]=t(r),getMapper:t=>e[t]}})(),g={},m=(e,t)=>e+"|"+t;const x={createRepository:function(e){const t=h.getMapper(e),n=e=>t.list(e)||[];return{forceList:n,list:t=>{const r=m(e,t);let i=g[r];return void 0===i&&(i=n(t),g[r]=i),[...i]},store:(n,r)=>{var i;return t.store(n,r),i=m(e,n),g[i]=void 0,!0}}},TYPE:p};h.registerMapper(p.editConfig,c),h.registerMapper(p.editCombination,d);const f=x;var y=void 0;const{createRepository:v,TYPE:j}=f;function C(e){const t=v(e);return{forceList:t.forceList,list:t.list,store:(n,r)=>{try{t.store(n,r)}catch(i){return console.log("store ".concat(e," error"),i),i.message}return!0}}}const S=C(j.editConfig),Z=C(j.editCombination),b=(e,t,n)=>{const r=e.forceList(t);for(let i of r)if(i.code===n)throw new Error("\u7f16\u7801\u91cd\u590d, \u8bf7\u4fee\u6539\u51b2\u91cd\u65b0\u6dfb\u52a0");return!0},w=(()=>{let e=1;return()=>e++})(),E={listAllConfig:e=>S.list(e),queryConfigByCode:(e,t)=>((e,t,n)=>{const r=e.list(t),i=[];for(let o of r)o.code===n&&i.push(o);return i})(S,e,t),queryConfigByName:(e,t)=>{var n;return(null===(n=E.listAllConfig(e))||void 0===n?void 0:n.filter((e=>e.name===t)))||[]},addConfig:(e,t,n)=>{t.code=n?t.code:null,t.code||(t.code=l.fp.generateCode(t.name+"-"+(new Date).getTime()+"-"+w())),b(S,e,t.code);const r=E.listAllConfig(e);return r.push(t),S.store(e,r)},updateConfig:(e,t,n)=>{const r=E.listAllConfig(e);for(let i=0;i<r.length;i++)if(r[i].code===t.code)return r[i].name=t.name,r[i].description=t.description,r[i].scriptContent=t.scriptContent,r[i].hidden=t.hidden?1:void 0,r[i].version=n?t.version||void 0:l.fp.generateVersion(),S.store(e,r);return!1},hiddenConfig:(e,t,n)=>{if(!t||0===t.length)return;const r=E.listAllConfig(e);for(let i=0;i<r.length;i++)t.includes(r[i].code)&&(r[i].hidden=n?1:void 0,r[i].version=l.fp.generateVersion());return S.store(e,r)},deleteConfig:(e,t)=>E.batchDeleteConfig(e,[t]),batchDeleteConfig:(e,t)=>{if(!(t&&t.length&&t.length>0))return!0;const n=E.listAllConfig(e);let r=!1;for(let i=0;i<n.length;i++)if(t.indexOf(n[i].code)>=0){const t=E.checkCombinationByConfig(e,[n[i].code]);if(!0!==t)return"\u5f53\u524d\u8282\u70b9\u88ab\u7f16\u6392 ["+t+"] \u5f15\u7528";n.splice(i,1),i--,r=!0}return r?S.store(e,n):"\u6570\u636e\u4e0d\u5b58\u5728, \u8bf7\u5237\u65b0\u9875\u9762"},listAllCombination:e=>Z.list(e),queryCombinationByCode:(e,t)=>((e,t,n)=>{const r=e.list(t);for(let i of r)if(i.id===n)return i;return null})(Z,e,t),checkCombinationByConfig:(e,t)=>{for(let n of E.listAllCombination(e))if(n.combination)for(let e of n.combination)if(t.indexOf(e)>=0)return n.name||"-";return!0},addCombination:(e,t)=>{const n=E.listAllCombination(e);return t.code=l.fp.generateCode(t.name+"-"+(new Date).getTime()+"-"+w()),b(Z,e,t.code),n.push(t),Z.store(e,n)},updateCombination:(e,t)=>{const n=E.listAllCombination(e);for(let r=0;r<n.length;r++)if(n[r].code===t.code)return n[r].name=t.name,n[r].description=t.description,n[r].combination=t.combination,n[r].version=l.fp.generateVersion(),Z.store(e,n);return"\u6570\u636e\u4e0d\u5b58\u5728, \u8bf7\u5237\u65b0\u9875\u9762"},deleteCombination:(e,t)=>E.batchDeleteCombination(e,[t]),batchDeleteCombination:(e,t)=>{if(!(t&&t.length&&t.length>0))return!0;let n=!1;const r=E.listAllCombination(e);for(let i=0;i<r.length;i++)t.indexOf(r[i].code)>=0&&(r.splice(i,1),i--,n=!0);return n?Z.store(e,r):"\u6570\u636e\u4e0d\u5b58\u5728, \u8bf7\u5237\u65b0\u9875\u9762"}},P=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise(((t,r)=>{let i=!1;try{i=e.apply(y,n)}catch(o){r(o.message)}!0===i?t.apply(y,n):i instanceof Array?t.apply(y,[i]):i instanceof Object?t.apply(y,i):r(i)}))},k=E;var T=n(7432),A=n(67407),R=n(46968),I=n(23983),L=n(66672),M=n(43299),N=n(3490),B=n(79036),D=n(68351),O=n(47548),K=n(24718),F=(n(8110),n(9518)),U=n.n(F);const V=e=>{let{ts:t}=e;const n=(()=>{const e=/^\t+$/,t=/^ +$/;return{AllTabs:e,AllSpaces:t,adjustMultilineIndentation:function(n,r,i){if(!r)return n;const o=/\r?\n/,s=n.split(o);if(1===s.length)return n;const a=o.exec(n)[0];return s.map(((n,o)=>o>0?function(n,r,i){const o=/^[\t ]+/.exec(n);if(!o)return n;const s=o[0];if(e.test(s)&&r<=s.length)return n.substring(r);if(t.test(s)&&r<=s.length/i)return n.substring(r*i);return n}(n,r,i):n)).join(a)},adjustLeadingWhitespace:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.split(/\r?\n/).map(((e,n)=>n?t+e:e)).join("\n")}}})(),r={findNodeAtPosition:(e,n)=>{const r=[];e.statements.forEach((function i(o){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const a=o.getStart(e),l=o.getEnd();(!t.isToken(o)||t.isIdentifier(o)||t.isTypeNode(o))&&a<=n&&n<l&&r.push({depth:s,node:o,width:l-a}),o.getChildren(e).forEach((e=>i(e,s+1)))}));const i=r.sort(((e,t)=>e.width===t.width?t.depth-e.depth:e.width-t.width));return i.length>0&&i[0].node},findClosestParent:(e,t)=>{for(;e&&e.kind!==t;)e=e.parent;return e},isAssignmentBinaryExpression:e=>[t.SyntaxKind.EqualsToken,t.SyntaxKind.PlusEqualsToken,t.SyntaxKind.MinusEqualsToken,t.SyntaxKind.SlashEqualsToken,t.SyntaxKind.AsteriskEqualsToken,t.SyntaxKind.AsteriskAsteriskEqualsToken,t.SyntaxKind.AmpersandEqualsToken,t.SyntaxKind.BarEqualsToken,t.SyntaxKind.BarBarEqualsToken,t.SyntaxKind.CaretEqualsToken,t.SyntaxKind.LessThanLessThanToken,t.SyntaxKind.LessThanLessThanEqualsToken,t.SyntaxKind.GreaterThanEqualsToken,t.SyntaxKind.GreaterThanGreaterThanEqualsToken,t.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,t.SyntaxKind.AmpersandAmpersandEqualsToken,t.SyntaxKind.QuestionQuestionToken,t.SyntaxKind.BarBarEqualsToken].includes(e.operatorToken.kind)},i=(()=>{const e=/^(get|read|create|retrieve|select|modify|update|use|find)(?<name>[A-Z].+?)?$/,n=/((By|With|From).*$)|(Sync$)|.*(?=Items|Lines$)/,r=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function i(e){const t=null===e||void 0===e?void 0:e.replace(n,"");return[...new Set([t,e])].filter((e=>e))}function o(t){var n,r;return null===(n=e.exec(t))||void 0===n||null===(r=n.groups)||void 0===r?void 0:r.name}function s(e){return t.isIdentifier(e.expression)?e.expression.text:t.isPropertyAccessExpression(e.expression)?e.expression.name.text:void 0}function a(e){return t.isIdentifier(e.expression)?e.expression.text:t.isPropertyAccessExpression(e.expression)?e.expression.name.text:void 0}return{inferVarTemplateName:e=>{if(t.isNewExpression(e))return[r(a(e))];if(t.isCallExpression(e)){const t=o(s(e));if(!t)return;return i(t).map(r)}},inferForVarTemplate:e=>{const n=function(e){if(t.isIdentifier(e))return e.text;if(t.isPropertyAccessExpression(e))return e.name.text;if(t.isCallExpression(e))return s(e)}(e);if(!n)return;const a=t.isCallExpression(e)?o(n):n.replace(/^(?:all)?(.+?)(?:List)?$/,"$1");return i(a).map(U().singular).filter((e=>e!==a)).map(r)}}})();return{getIndentCharacters:e=>e?e.insertSpaces?" ".repeat(e.tabSize):"\t":"",getPlaceholderWithOptions:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.length>1?"${".concat(t,"|").concat(e.join(","),"|}"):"${".concat(t,":").concat(e[0],"}")},AllTabs:n.AllTabs,AllSpaces:n.AllSpaces,adjustMultilineIndentation:n.adjustMultilineIndentation,adjustLeadingWhitespace:n.adjustLeadingWhitespace,findNodeAtPosition:r.findNodeAtPosition,findClosestParent:r.findClosestParent,isAssignmentBinaryExpression:r.isAssignmentBinaryExpression,inferVarTemplateName:i.inferVarTemplateName,inferForVarTemplate:i.inferForVarTemplate}},z={upper:e=>e.toUpperCase(),lower:e=>e.toLowerCase(),capitalize:e=>e.substring(0,1).toUpperCase()+e.substring(1)},J=e=>{const{monaco:t,ts:n}=e,r=V(e);class i{constructor(e,i,o){n.isAwaitExpression(i.parent)&&(i=i.parent),this.node=i,this.item={label:{label:e},kind:t.languages.CompletionItemKind.Snippet},this.code=r.adjustMultilineIndentation(i.getText(),null===o||void 0===o?void 0:o.indentSize,null===o||void 0===o?void 0:o.tabSize),this.indentInfo=o}build(){return this.item}description(e){return this.item.label.description=e,this}replace(e){const r=this.node.getSourceFile(),i=n.getLineAndCharacterOfPosition(r,this.node.getStart(r)),o=n.getLineAndCharacterOfPosition(r,this.node.getEnd()),s={startLineNumber:i.line+1,startColumn:i.character+1,endLineNumber:o.line+1,endColumn:o.character+2};if(/(?<!\\)\$/.test(e)){const n=this.code.replace(/\\/g,"\\\\").replace(/\$/g,"\\$");this.item.insertText=this._replaceExpression(e,n),this.item.insertTextRules=t.languages.CompletionItemInsertTextRule.InsertAsSnippet,this.item.additionalTextEdits=[{range:s,text:null}],this.item.keepWhitespace=!0}else this.item.insertText="",this.item.additionalTextEdits=[{range:s,text:this._replaceExpression(e.replace(/\\\$/g,"$$"),this.code)}];return this}_replaceExpression(e,t,n){const r=new RegExp(n||"{{expr(?::(upper|lower|capitalize))?}}","g");return e.replace(r,((e,n)=>n&&z[n]?z[n](t):t))}}return(e,t,n)=>new i(e,t,n)},q=e=>{const{ts:t}=e,n=V(e),r=J(e);class i{constructor(e){this.isSimpleExpression=e=>t.isExpressionStatement(e)&&!this.isStringLiteral(e),this.isPropertyAccessExpression=e=>e.kind===t.SyntaxKind.PropertyAccessExpression,this.isElementAccessExpression=e=>e.kind===t.SyntaxKind.ElementAccessExpression,this.isExpression=e=>this.isSimpleExpression(e)||this.isPropertyAccessExpression(e)||this.isElementAccessExpression(e),this.isIdentifier=e=>t.isIdentifier(e)&&!this.inTypeReference(e.parent),this.isUnaryExpression=e=>e.kind===t.SyntaxKind.PostfixUnaryExpression||e.kind===t.SyntaxKind.PrefixUnaryExpression,this.isCallExpression=e=>e.kind===t.SyntaxKind.CallExpression,this.isNewExpression=e=>e.kind===t.SyntaxKind.NewExpression,this.inFunctionArgument=e=>t.isCallExpression(e.parent)&&e.parent.arguments.includes(e),this.isObjectLiteral=e=>t.isBlock(e)&&(0===e.statements.length||e.statements.some((e=>t.isLabeledStatement(e)))),this.isStringLiteral=e=>t.isTemplateSpan(e)||t.isExpressionStatement(e)&&(t.isStringLiteral(e.expression)||t.isNoSubstitutionTemplateLiteral(e.expression)),this.isTypeNode=e=>!!t.isTypeNode(e)||e.parent&&this.inTypeReference(e.parent),this.inAwaitedExpression=e=>!this.isAnyFunction(e)&&(e.kind===t.SyntaxKind.AwaitExpression||e.parent&&this.inAwaitedExpression(e.parent)),this.inReturnStatement=e=>!this.isAnyFunction(e)&&(e.kind===t.SyntaxKind.ReturnStatement||e.parent&&this.inReturnStatement(e.parent)),this.inVariableDeclaration=e=>!this.isAnyFunction(e)&&(e.kind===t.SyntaxKind.VariableDeclaration||e.parent&&this.inVariableDeclaration(e.parent)),this.isBinaryExpression=e=>!!t.isBinaryExpression(e)||(t.isParenthesizedExpression(e)&&t.isBinaryExpression(e.expression)||e.parent&&this.isBinaryExpression(e.parent)),this.unwindBinaryExpression=function(e){let r=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&t.isParenthesizedExpression(e)&&t.isBinaryExpression(e.expression)?e.expression:n.findClosestParent(e,t.SyntaxKind.BinaryExpression);for(;r&&t.isBinaryExpression(r.parent);)r=r.parent;return r&&!n.isAssignmentBinaryExpression(r)?r:e},this.isAnyFunction=e=>t.isFunctionExpression(e)||t.isArrowFunction(e)||t.isMethodDeclaration(e),this.inAssignmentStatement=e=>!this.isAnyFunction(e)&&(t.isBinaryExpression(e)?n.isAssignmentBinaryExpression(e):e.parent&&this.inAssignmentStatement(e.parent)),this.inIfStatement=(e,n)=>t.isIfStatement(e)?!n||e.expression===n:e.parent&&this.inIfStatement(e.parent,e),this.inTypeReference=e=>!!t.isTypeReferenceNode(e)||e.parent&&this.inTypeReference(e.parent),this.keyword=e}}class o extends i{canUse(e){return!this.inIfStatement(e)&&!this.isTypeNode(e)&&!this.inAssignmentStatement(e)&&(this.isIdentifier(e)||this.isExpression(e)||this.isUnaryExpression(e)||this.isBinaryExpression(e)||this.isCallExpression(e))}}class s extends o{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"var")}buildCompletionItem(e,t){var i;e=this.unwindBinaryExpression(e);const o=null!==(i=n.inferVarTemplateName(e))&&void 0!==i?i:["name"];return r(this.keyword,e,t).description("".concat(this.keyword," name = expr")).replace("".concat(this.keyword," ").concat(n.getPlaceholderWithOptions(o)," = {{expr}}$0")).build()}canUse(e){return(super.canUse(e)||this.isNewExpression(e)||this.isObjectLiteral(e)||this.isStringLiteral(e))&&!this.inReturnStatement(e)&&!this.inFunctionArgument(e)&&!this.inVariableDeclaration(e)&&!this.inAssignmentStatement(e)}}class a extends i{canUse(e){return!this.inReturnStatement(e)&&!this.inIfStatement(e)&&!this.inFunctionArgument(e)&&!this.inVariableDeclaration(e)&&!this.inAssignmentStatement(e)&&!this.isTypeNode(e)&&!this.isBinaryExpression(e)&&(this.isIdentifier(e)||this.isPropertyAccessExpression(e)||this.isElementAccessExpression(e)||this.isCallExpression(e)||this.isArrayLiteral(e))}isArrayLiteral(e){return e.kind===t.SyntaxKind.ArrayLiteralExpression}getArrayItemNames(e){const t=n.inferForVarTemplate(e);return(null===t||void 0===t?void 0:t.length)>0?t:["item"]}}class l extends a{buildCompletionItem(e,i){const o=e.parent&&t.isAwaitExpression(e.parent),s=o?"(":"",a=o?")":"";return"forr"===this.keyword?r("forr",e,i).description("for (let i = expr.length - 1; i >= 0; i--)").replace("for (let ${1:i} = ".concat(s,"{{expr}}").concat(a,".length - 1; ${1} >= 0; ${1}--) {\n").concat(n.getIndentCharacters(i),"${0}\n}")).build():r("fori",e,i).description("for (let i = 0; i < expr.length; i++)").replace("for (let ${1:i} = 0; ${1} < ".concat(s,"{{expr}}").concat(a,".length; ${1}++) {\n").concat(n.getIndentCharacters(i),"${0}\n}")).build()}canUse(e){return super.canUse(e)&&!this.isArrayLiteral(e)&&!this.isCallExpression(e)}}return[new s,new s("let"),new s("const"),new l("fori"),new l("forr"),new class extends a{buildCompletionItem(e,t){const i=super.getArrayItemNames(e);return r("forof",e,t).description("for (let item of expr)").replace("for (let ".concat(n.getPlaceholderWithOptions(i)," of {{expr}}) {\n").concat(n.getIndentCharacters(t),"${0}\n}")).build()}}("forof"),new class extends a{buildCompletionItem(e,i){const o=e.parent&&t.isAwaitExpression(e.parent),s=o?"(":"",a=o?")":"",l=super.getArrayItemNames(e);return r("foreach",e,i).description("expr.forEach(item => )").replace("".concat(s,"{{expr}}").concat(a,".forEach(").concat(n.getPlaceholderWithOptions(l)," => {\n").concat(n.getIndentCharacters(i),"${0}\n})")).build()}}("foreach")]},W=(e,t)=>{const n={monaco:e,ts:t},r=V(n),i=q(n);const o=new class{provideCompletionItems(e,n,r,o){var s;const a=e.getLineContent(n.lineNumber).lastIndexOf(".",n.column-1),l=e.getWordAtPosition(n),c=(null!==(s=null===l||void 0===l?void 0:l.startColumn)&&void 0!==s?s:n.column)-1===a+1;if(-1===a||!c)return[];const d=[];try{const r=this._getNodeBeforeTheDot(e,n,a);if(r){const n=this._getIndentInfo(e,r),o=this._getNodeForReplacement(r);i.forEach((e=>{e.canUse(t.isNonNullExpression(r)?r.expression:r)&&d.push(e.buildCompletionItem(o,n))}))}}catch(u){console.warn("Error while building postfix autocomplete items:",u)}return d}_getNodeBeforeTheDot(e,n,i){const o=e.getValueInRange({startLineNumber:1,endLineNumber:n.lineNumber,startColumn:1,endColumn:i+1}),s=t.createSourceFile("test.ts",o,t.ScriptTarget.ES5,!0),a=t.getPositionOfLineAndCharacter(s,n.lineNumber-1,i-1),l=r.findNodeAtPosition(s,a);return t.isIdentifier(l)&&t.isPropertyAccessExpression(l.parent)?l.parent:l}_getNodeForReplacement(e){return t.isTemplateSpan(e)||t.isPrefixUnaryExpression(e.parent)||t.isPropertyAccessExpression(e.parent)?e.parent:t.isTypeReferenceNode(e.parent)||e.parent.parent&&t.isTypeReferenceNode(e.parent.parent)?r.findClosestParent(e,t.SyntaxKind.TypeReference):e}_getIndentInfo(e,n){var i,o;const s=(null===(i=e.getOptions())||void 0===i?void 0:i.tabSize)||4,a=(null===(o=e.getOptions())||void 0===o?void 0:o.insertSpaces)||true,l=n.getSourceFile(),c=t.getLineAndCharacterOfPosition(l,n.getStart(l)),d=e.getLineContent(c.line+1).substring(0,e.getLineFirstNonWhitespaceColumn(c.line+1)-1);let u=0;return r.AllTabs.test(d)?u=d.length:r.AllSpaces.test(d)&&(u=d.length/s),{tabSize:s,insertSpaces:a,indentSize:u,leadingWhitespace:d}}};return{triggerCharacters:["."],provideCompletionItems:(e,t,n,r)=>({suggestions:o.provideCompletionItems(e,t,n,r)||[]})}},$=(e,t)=>{(n.g.ts?Promise.resolve(n.g.ts):new Promise(((e,t)=>{n.e(389).then(n.bind(n,92389)).then((()=>{const r=n.g.ts;r||t(new Error("\u83b7\u53d6tsWorker\u5931\u8d25")),e(r)})).then(t)}))).then((n=>t(W(e,n)))).catch((e=>console.log("register postfix error",e)))};var _=n(17534);const H=new class{constructor(){this.dataSource={}}has(e){return e in this.dataSource}get(e){return this.dataSource[e]}set(e,t){this.dataSource[e]=t}},X=(e,t,n)=>{e.languages.typescript.javascriptDefaults.addExtraLib(t,n),e.editor.createModel(t,"typescript",e.Uri.parse(n))},G=[{name:"lodash",path:"https://cdn.jsdelivr.net/npm/@types/lodash@4.14.93/index.d.ts"},{name:"dayjs",path:"https://cdn.jsdelivr.net/npm/dayjs@1.11.6/index.d.ts"},{name:"cryptoJS",path:"https://cdn.jsdelivr.net/npm/@types/crypto-js@4.1.1/index.d.ts"},{name:"xlsx",path:"https://cdn.jsdelivr.net/npm/xlsx@0.18.5/types/index.d.ts"}],Q=[{name:"react",path:"https://cdn.jsdelivr.net/npm/@types/react@18.2.0/index.d.ts"}],Y=[{name:"antd",path:"https://cdn.jsdelivr.net/npm/antd@4.23.6/es/index.d.ts"}],ee=_.X.loadMonaco;const te=function(e){if(!e||_.Z.getFromCache(ee))return;_.Z.setToCache(ee,!0);const t=e.languages.typescript.javascriptDefaults.getExtraLibs()||{},n=[...Q,...G,...Y];Promise.all(n.map((e=>(e=>{const t=e.name,n={name:t};return H.has(t)?(n.content=H.get(t),Promise.resolve(n)):(async()=>{const t=await fetch(e.path);return n.content=await t.text(),n.content?n:null})()})(e)))).then((n=>{n.filter((e=>!!e)).forEach((n=>{H.set(n.name,n.content);const r="ts:web/".concat(n.name,"/index.d.ts");if(r in t)return;const i="declare module '".concat(n.name,"' { ").concat(n.content," }");X(e,i,r)}));const r="ts:inner/converter.d.ts";r in t||X(e,(e=>{const t=(e=>{if(!e||e.length<=0)return"(moduleName: string): null";let t="(moduleName: ";return t+=e.map((e=>"'"+e+"'")).join(" | "),t+=") => Promise<",t+=e.map((e=>"typeof import('"+e+"')")).join(" | "),t+=">",t})(e);return'\n    declare const inputData: (string | Object | File[]);\n    declare const inputObj: (Object | null);\n    declare const React: typeof import("react"),\n    interface ElementDefinition & Element {\n        type: string | Element;\n        props: any;\n        children?: string | number | ElementDefinition | ElementDefinition[]\n    }\n    declare const Util: ({\n        _: typeof import("lodash"),\n        dayjs: typeof import("dayjs"),\n        cryptoJS: typeof import("cryptoJS"),\n        XLSX: typeof import("xlsx"),\n        message: {\n            info(content: string, duration?: number): void;\n            success(content: string, duration?: number): void;\n            error(content: string, duration?: number): void;\n            warning(content: string, duration?: number): void;\n            loading(content: string, duration?: number): void;\n        },\n        importPlugin: '.concat(t,"\n    });")})(Y.map((e=>e.name))),r)})).catch((e=>console.error("load extraLibs error",e)));try{$(e,(t=>e.languages.registerCompletionItemProvider("javascript",t)))}catch(r){console.error("load completionPostfix error",r)}};var ne=n(2961),re=n(11868),ie=n(15702),oe=n(10129),se=n(44730),ae=n(74294),le=n(11635),ce=n(10199),de=n(69893),ue=n(82138),pe=n(82508),he=n(63557),ge=n(20052),me=n(59733),xe=n(38475);function fe(e){return"CanceledError"===e.name}function ye(e){let t="";if(e instanceof Array)for(let n=0;n<e.length;n++)t+="\n"+(n+1)+". "+e[n];else t+="\n"+e;return t}const ve="\n\n";function je(e){let{header:t,framework:n,needDesc:r,dependent:i,componentRules:o,output:s,codeQuality:a}=e,l=t||"";return n&&(t&&(l+=ve),l+="\u3010\u5f00\u53d1\u6846\u67b6\u3011"+ye(n)),r&&(l+="\n\n\u3010\u6838\u5fc3\u9700\u6c42\u3011\n\u8bf7\u751f\u6210\u7b26\u5408\u4ee5\u4e0b\u7ea6\u675f\u6761\u4ef6\u7684 JavaScript \u4ee3\u7801\u7247\u6bb5\uff1a"+ye(r)),i&&(l+="\n\n\u3010\u4f9d\u8d56\u7ba1\u7406\u3011"+ye(i)),o&&(l+="\n\n\u3010\u7ec4\u4ef6\u89c4\u8303\u3011"+ye(o)),s&&(l+="\n\n\u3010\u8f93\u51fa\u683c\u5f0f\u89c4\u8303\u3011"+ye(s)),a&&(l+="\n\n\u3010\u4ee3\u7801\u8d28\u91cf\u8981\u6c42\u3011"+ye(a)),l}let Ce="\u57fa\u7840\u5e93\u5fc5\u987b\u901a\u8fc7\u89e3\u6784Util\u83b7\u53d6\uff1a\nconst { _,dayjs,cryptoJS,XLSX,message } = Util;\n- _ : lodash\u5e93\n- dayjs : dayjs\u65e5\u671f\u5e93\n- cryptoJS : crypto-js\u52a0\u5bc6\u5e93\n- XLSX : SheetJS\u7684XLSX\u5e93\n- message: atnd\u7684message\u5bf9\u8c61\uff0c\u7528\u4e8e\u5168\u5c40\u5c55\u793a\u64cd\u4f5c\u53cd\u9988\u4fe1\u606f",Se=["\u53ef\u4f7f\u7528ES6\u89e3\u6784\u8bed\u6cd5\u5bfc\u5165\u7ec4\u4ef6","\u53ef\u4f7f\u7528\u7bad\u5934\u51fd\u6570\u5b9a\u4e49\u7ec4\u4ef6"],Ze=["\u5fc5\u987b\u901a\u8fc7ESLint\u6821\u9a8c","\u4fdd\u6301\u6700\u5c0f\u4f9d\u8d56\u539f\u5219","\u7ec4\u4ef6\u590d\u6742\u5ea6\u63a7\u5236\u5728\u5355\u4e2a\u6587\u4ef6\u5185"];const be={json:je({header:"JavaScript \u4ee3\u7801\u751f\u6210\u6307\u4ee4",needDesc:["\u4ee3\u7801\u5c06\u88ab\u6ce8\u5165 function anonymous(inputData, inputObj, Util) { /* \u6b64\u5904 */ return inputObj; } \u51fd\u6570\u4f53","inputData \u662fJSON\u5b57\u7b26\u4e32, inputObj \u662fJSON\u5bf9\u8c61","\u5fc5\u987b\u517c\u5bb9\u73b0\u4ee3\u6d4f\u89c8\u5668\u73af\u5883","\u8fd4\u56de\u503c\u7c7b\u578b\u9700\u4e3aJSON\u5bf9\u8c61\u6216JSON\u5b57\u7b26\u4e32"],dependent:Ce,componentRules:Se,codeQuality:Ze}),txt:je({header:"JavaScript \u4ee3\u7801\u751f\u6210\u6307\u4ee4",needDesc:["\u4ee3\u7801\u5c06\u88ab\u6ce8\u5165 function anonymous(inputData, Util) { /* \u6b64\u5904 */ return inputData; } \u51fd\u6570\u4f53","inputData \u662f\u591a\u884c\u6587\u672c","\u5fc5\u987b\u517c\u5bb9\u73b0\u4ee3\u6d4f\u89c8\u5668\u73af\u5883","\u8fd4\u56de\u503c\u7c7b\u578b\u9700\u4e3a\u5b57\u7b26\u4e32"],dependent:Ce,componentRules:Se,codeQuality:Ze}),customize:je({framework:"\u57fa\u4e8eReact\u51fd\u6570\u5f0f\u7ec4\u4ef6\u4f53\u7cfb\uff0c\u4f7f\u7528JavaScript\u8bed\u6cd5\u5f00\u53d1",dependent:[Ce,'\u5916\u90e8\u7ec4\u4ef6\u5fc5\u987b\u901a\u8fc7\u5f02\u6b65\u5bfc\u5165\uff1a\nconst { Button } = await importPlugin("antd");\nconst { ProCard } = await importPlugin("@ant-design/pro-components");\n* \u5141\u8bb8\u7684\u63d2\u4ef6\u6a21\u5757\uff1a\n- antd (5.6.1)\n- @ant-design/icons (5.0.0)\n- @ant-design/pro-components (2.5.11)\n- @monaco-editor/react (4.4.6)'],componentRules:["\u4e3b\u7ec4\u4ef6\u5fc5\u987b\u662f\u8fd4\u56deJSX\u7684\u51fd\u6570\u7ec4\u4ef6",...Se],output:"\u5fc5\u987b\u4e25\u683c\u9075\u5faa\u4ee5\u4e0b\u7ed3\u6784\uff1a\n    const { importPlugin } = Util;\n    return (async() => {\n      const { Button } = await importPlugin(\"antd\");\n      return () => {\n        return <Button value='hello'/>;\n      }\n    })();",codeQuality:[...Ze,"\u4f7f\u7528antd\u539f\u751f\u6837\u5f0f\u7cfb\u7edf"]})},we=e=>e?e.startsWith("customize")?be.customize:be[e]:null;var Ee=n(52984),Pe=n.n(Ee);const ke="devinx3.toolkit.ai.setting.model",Te=ke+".favorite";function Ae(e){return Pe().AES.encrypt(e,"devinx3").toString()}const Re=class{getFavoriteModel(){return window.localStorage.getItem(Te)}updateFavoriteModel(e){window.localStorage.setItem(Te,e)}setModelStore(e){window.localStorage.setItem(ke,JSON.stringify(e))}listModelStore(){const e=window.localStorage.getItem(ke);return e?JSON.parse(e):[]}setModel(e){this.setModelStore(e)}listModel(){return this.listModelStore()}getModel(e,t){for(const r of this.listModel())if(r.model===e)return t&&(r.secretKey=(n=r.secretKey,Pe().AES.decrypt(n,"devinx3").toString(Pe().enc.Utf8))),r;var n;return null}createModel(e){if(this.getModel(e.model))throw new Error("\u6a21\u578b"+e.model+"\u5df2\u5b58\u5728");e.secretKey&&(e.secretKey=Ae(e.secretKey)),this.setModel([...this.listModel(),e])}updateModel(e){const t=[];for(const n of this.listModel())n.model===e.model?(e.secretKey?e.secretKey=Ae(e.secretKey):e.secretKey=n.secretKey,t.push(e)):t.push(n);this.setModel(t)}deleteModel(e){const t=[];for(const n of this.listModel())n.model!==e&&t.push(n);this.setModel(t)}};var Ie=n(46417);const{TextArea:Le}=L.default,{Text:Me}=T.default,Ne="https://api.deepseek.com",Be="deepseek-chat",De="sk-********************************",Oe=r.memo((e=>{let{msg:t,editor:n}=e;const i=r.useMemo((()=>e=>{let{node:r,inline:i,className:o,children:s,...a}=e;const l=o?o.replace("language-",""):"",c=String(s).trimEnd("\n");return c.includes("\n")?(0,Ie.jsx)(Ke,{codeRange:t.codeRange,language:l,value:c,originEditor:n}):(0,Ie.jsx)("code",{...a,children:s})}),[t.codeRange,n]);return(0,Ie.jsx)(me.D,{components:{code:i},children:t.text})})),Ke=e=>{let{codeRange:t,value:n,language:l,originEditor:c}=e;const[d,u]=r.useState(!1),[p,h]=r.useState("");r.useEffect((()=>{if(c&&t){const e=c.getModel(),t=c.getSelection();h(e.getValueInRange(t)||"")}else h((null===c||void 0===c?void 0:c.getValue())||"")}),[d,t,c]);const g=e=>{c?t?c.executeEdits("",[{range:t,text:e,forceMoveMarkers:!0}]):c.setValue(e):A.ZP.error("\u7f16\u8f91\u5668\u4e0d\u5b58\u5728")};return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsxs)("div",{style:{backgroundColor:"#222222",padding:"10px",borderRadius:"4px"},children:[(0,Ie.jsxs)(i.Z,{gutter:16,children:[(0,Ie.jsx)(o.Z,{flex:2,children:"\u811a\u672c"}),(0,Ie.jsxs)(o.Z,{flex:"right",children:[(0,Ie.jsx)(Me,{copyable:{text:n}}),(0,Ie.jsx)(R.Z,{}),(0,Ie.jsx)(s.Z,{placement:"topRight",title:"\u5e94\u7528",children:(0,Ie.jsx)(a.ZP,{style:{backgroundColor:"transparent",borderColor:"transparent"},icon:(0,Ie.jsx)(le.Z,{style:{color:"white"}}),size:"small",onClick:()=>g(n)})}),(0,Ie.jsx)(R.Z,{}),(0,Ie.jsx)(s.Z,{placement:"topRight",title:"\u5bf9\u6bd4",children:(0,Ie.jsx)(a.ZP,{style:{backgroundColor:"transparent",borderColor:"transparent"},icon:(0,Ie.jsx)(ce.Z,{style:{color:"white"}}),size:"small",onClick:()=>u(!0)})})]})]}),(0,Ie.jsx)(i.Z,{children:(0,Ie.jsx)(K.default,{language:l,value:n,theme:"vs-dark",options:{readOnly:!0,lineNumbers:!1,scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1},folding:!1,minimap:{enabled:!1},wordWrap:"off",renderWhitespace:"none",scrollBeyondLastLine:!1,renderLineHighlight:!1,suggestOnTriggerCharacters:!1,quickSuggestions:!1,contextmenu:!1,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,overviewRulerBorder:!1},onMount:e=>{e.layout({height:e.getContentHeight()})}})})]}),(0,Ie.jsx)(Fe,{updateOriginalValue:g,openCodeDiffView:d,closeCodeDiffView:()=>u(!1),language:l,original:p,modified:n,originEditor:c})]})},Fe=e=>{let{openCodeDiffView:t,closeCodeDiffView:n,language:r,original:i,modified:o,updateOriginalValue:s}=e;return(0,Ie.jsx)(M.Z,{height:"80vh",width:"70vw",title:"\u5185\u5bb9\u5bf9\u6bd4",placement:"left",open:t,onClose:n,extra:(0,Ie.jsx)(a.ZP,{type:"primary",onClick:()=>s(o)&n(),children:"\u5e94\u7528"}),children:(0,Ie.jsx)(K.DiffEditor,{language:r,original:i,modified:o,theme:"vs-dark",options:{scrollbar:{vertical:"hidden",horizontal:"hidden"},folding:!1,minimap:{enabled:!1},wordWrap:"off",renderWhitespace:"none",scrollBeyondLastLine:!1,renderLineHighlight:!1,suggestOnTriggerCharacters:!1,quickSuggestions:!1,contextmenu:!1,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,overviewRulerBorder:!1,renderOverviewRuler:!1,hideUnchangedRegions:{enabled:!0}}})})},Ue=new Re,Ve=e=>{let{usedModelKey:t,setModelOptions:n}=e;const[s,l]=r.useState(!1),[c,d]=r.useState([]),[u,p]=r.useState(""),h=r.useCallback((()=>{let e=Ue.listModel();d(e),n(e.map((e=>e.model)))}),[n]);r.useEffect((()=>{h()}),[h]);return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(a.ZP,{onClick:()=>l(!0),children:(0,Ie.jsx)(de.Z,{})}),s?(0,Ie.jsxs)(M.Z,{height:"80vh",width:"60vw",title:"\u6a21\u578b\u914d\u7f6e",open:!0,onClose:()=>l(!1),children:[(0,Ie.jsx)(a.ZP,{type:"primary",onClick:()=>{p("")},style:{marginBottom:"10px"},children:"\u6dfb\u52a0"}),(0,Ie.jsxs)(i.Z,{children:[(0,Ie.jsx)(o.Z,{span:6,children:(0,Ie.jsx)(ie.Z,{onClick:e=>{p(e.key)},mode:"inline",selectedKeys:[u],style:{height:"100%",borderRight:0},items:c.map((e=>({key:e.model,label:e.model})))})}),(0,Ie.jsx)(o.Z,{span:16,children:(0,Ie.jsx)(ze,{usedModelKey:t,updateKey:e=>p(e)&h(),model:u,data:Ue.getModel(u)||{}})})]})]}):null]})},ze=e=>{let{usedModelKey:t,updateKey:n,model:s,data:l}=e;const[c]=oe.Z.useForm();r.useEffect((()=>{c.setFieldsValue({model:s,secretKey:"",baseURL:l.baseURL})}),[s,l,c]);return(0,Ie.jsxs)(oe.Z,{form:c,layout:"horizontal",children:[(0,Ie.jsx)(oe.Z.Item,{label:"\u6a21\u578b",name:"model",labelCol:{span:6},rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6a21\u578b"}],children:(0,Ie.jsx)(L.default,{placeholder:Be,disabled:!!s})}),(0,Ie.jsx)(oe.Z.Item,{label:"\u5bc6\u94a5",name:"secretKey",labelCol:{span:6},rules:[{required:!s,message:"\u8bf7\u8f93\u5165\u5bc6\u94a5"}],children:(0,Ie.jsx)(L.default,{placeholder:De})}),(0,Ie.jsx)(oe.Z.Item,{label:"baseURL",name:"baseURL",labelCol:{span:6},rules:[{required:!0,message:"\u8bf7\u8f93\u5165baseURL"}],children:(0,Ie.jsx)(L.default,{placeholder:Ne})}),(0,Ie.jsx)(i.Z,{justify:"end",style:{marginTop:"20px"},children:(0,Ie.jsxs)(o.Z,{children:[(0,Ie.jsx)(a.ZP,{type:"primary",onClick:async()=>{try{const t=await c.validateFields();try{s?Ue.updateModel(t):Ue.createModel(t),A.ZP.success("\u4fdd\u5b58\u6210\u529f"),n(t.model)}catch(e){A.ZP.error("\u4fdd\u5b58\u5931\u8d25: ".concat(e.message))}}catch(t){console.log("Validation Failed:",t)}},style:{marginRight:"10px"},children:"\u4fdd\u5b58"}),s&&s!==t?(0,Ie.jsx)(a.ZP,{type:"default",onClick:()=>{Ue.deleteModel(s),n("")},children:"\u5220\u9664"}):null]})})]})},Je={path:void 0,defaultData:{messages:[],conversation:null,inputMessage:"",errorMessage:"",codeSelect:"code"},data:null},qe=e=>{let{path:t,category:n,monaco:s,editor:l}=e;const c=(e=>e!==Je.path?Je.defaultData:Je.data||Je.defaultData)(t),[d,u]=r.useState(c.messages),[p,h]=r.useState(c.inputMessage),[g,m]=r.useState(Ue.getFavoriteModel()),[x,f]=r.useState([]),[y,v]=r.useState(!1),[j,C]=r.useState(c.errorMessage),S=r.useRef(null),[Z,b]=r.useState(c.conversation),[w,E]=r.useState(c.codeSelect);r.useEffect((()=>{((e,t)=>{Je.path=e,Je.data=t})(t,{messages:d,inputMessage:p,errorMessage:j,conversation:Z,codeSelect:w})}),[t,d,p,j,Z,w]);const P=e=>{u([]),C(""),b(null),k(e)},k=e=>{const t=Ue.getModel(e,!0);e?b(function(e){const t=xe.Z.create({baseURL:e.baseURL,headers:{Authorization:"Bearer ".concat(e.secretKey)}}),n=[];let r=null;return{config:e,system:e=>{n.push({role:"system",content:e})},user:e=>{n.push({role:"user",content:e})},chat:async()=>{r&&r.abort(),r=new AbortController;try{const i=(await t.post("/chat/completions",{model:e.model,messages:n},{signal:r.signal})).data.choices[0].message.content;return n.push({role:"assistant",content:i}),{content:i}}finally{r=null}},cancel:()=>{r&&(r.abort(),r=null)},isEmpty:()=>0===n.length,clear:()=>n.length=0}}({baseURL:t.baseURL||Ne,model:t.model||Be,secretKey:t.secretKey||De})):A.ZP.warning("\u6a21\u578b\u4e0d\u5b58\u5728, \u8bf7\u68c0\u67e5")};r.useEffect((()=>{!Z&&g&&k(g)}),[g,Z]),r.useEffect((()=>{setTimeout((()=>{var e;null===(e=S.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),100)}),[d]);const T=()=>{if(y)return;if(0===p.trim().length)return;if(!g)return void(x.length>0?A.ZP.warning("\u8bf7\u9009\u62e9\u6a21\u578b"):A.ZP.warning("\u8bf7\u914d\u7f6e\u6a21\u578b"));C(""),h(""),v(!0),(async()=>{try{u((e=>[...e,{text:p,sender:"user",time:new Date}]));const{range:e,content:t}=await(async e=>{try{if(Z.isEmpty()){const e=we(n);e&&Z.system(e)}let t=null;if(w&&l){let e;if("selection"===w){const n=l.getModel();t=l.getSelection(),e=n.getValueInRange(t)}else e=l.getValue();e&&Z.user("\u6700\u65b0\u4ee3\u7801:\n```\n"+e+"\n```")}return Z.user(e),{...await Z.chat({range:t}),range:t}}catch(t){throw fe(t)?t:(console.error("\u8bf7\u6c42\u6570\u636e\u5931\u8d25:",t),new Error("\u8bf7\u6c42\u5931\u8d25: "+t.message))}})(p);u((n=>[...n,{text:t,sender:"ai",codeRange:e,time:new Date}]))}catch(e){fe(e)?C(""):C(e.message)}})().finally((()=>v(!1)))};return(0,Ie.jsx)(ne.ZP,{theme:{algorithm:re.Z.darkAlgorithm},children:(0,Ie.jsxs)("div",{className:"devinx3-chat",children:[(0,Ie.jsxs)("div",{className:"devinx3-chat-header",children:[(0,Ie.jsx)(Me,{children:"AI \u52a9\u624b"}),(0,Ie.jsx)(a.ZP,{type:"link",style:{color:"white"},size:"small",icon:(0,Ie.jsx)(ue.Z,{}),disabled:y,onClick:()=>P(g)})]}),(0,Ie.jsxs)("div",{className:"devinx3-chat-message-list",children:[d.map(((e,t)=>(0,Ie.jsx)("div",{className:"devinx3-chat-message ".concat("user"===e.sender?"user":"ai"),children:"user"===e.sender?(0,Ie.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:e.text}):(0,Ie.jsx)("div",{children:(0,Ie.jsx)(Oe,{msg:e,editor:l})})},t))),y?(0,Ie.jsx)(a.ZP,{style:{backgroundColor:"transparent",borderColor:"transparent"},icon:(0,Ie.jsx)(pe.Z,{style:{color:"white"}})}):null,j?(0,Ie.jsx)(se.Z,{type:"error",style:{fontSize:"12px"},message:j}):null,(0,Ie.jsx)("div",{ref:S})]}),(0,Ie.jsxs)("div",{children:[(0,Ie.jsx)(Le,{style:{fontSize:"12px"},value:p,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),T())},placeholder:"\u8f93\u5165\u95ee\u9898...",autoSize:{minRows:6,maxRows:30}}),(0,Ie.jsxs)(i.Z,{style:{marginTop:"5px",marginBottom:"5px"},align:"middle",justify:"space-between",children:[(0,Ie.jsx)(o.Z,{children:(0,Ie.jsxs)(i.Z,{gutter:8,align:"middle",children:[(0,Ie.jsxs)(o.Z,{children:[(0,Ie.jsx)(Ve,{usedModelKey:g,setModelOptions:f}),(0,Ie.jsx)(ae.default,{value:g,onChange:e=>{m(e),Ue.updateFavoriteModel(e),P(e)},placement:"topLeft",options:x.map((e=>({value:e,label:e}))),disabled:y})]}),(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(ae.default,{style:{width:"90px"},value:w,onChange:E,placement:"topLeft",options:[{value:"code",label:"\u5168\u6587"},{value:"selection",label:"\u9009\u4e2d\u533a"}],allowClear:!0,disabled:y})})]})}),(0,Ie.jsx)(o.Z,{children:y?(0,Ie.jsx)(a.ZP,{icon:(0,Ie.jsx)(he.Z,{}),onClick:()=>{y&&(Z.cancel(),v(!0))},title:"\u53d6\u6d88"}):(0,Ie.jsx)(a.ZP,{icon:(0,Ie.jsx)(ge.Z,{}),onClick:T,title:"\u53d1\u9001"})})]})]})]})})},We=e=>{let{category:t,path:n,monacoInstance:i,editorInstance:o}=e;const s=document.body.offsetWidth,[a,l]=(0,r.useState)(.3*document.body.offsetWidth);return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)("div",{className:"resizer",onMouseDown:e=>{if(s<=0)return;e.preventDefault();const t=.3*s,n=.7*s,r=e=>{let r=e.clientX;r<t?r=t:r>n&&(r=n);l(s-r-2);const i=null===o||void 0===o?void 0:o.getContainerDomNode();o&&i&&o.layout({width:r,height:i.offsetHeight})},i=()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",i)},style:{cursor:"ew-resize",width:"2px",backgroundColor:"transparent"}}),(0,Ie.jsx)("div",{className:"devinx3-editor-sider",style:{width:a},children:(0,Ie.jsx)(qe,{category:t,path:n,monaco:i,editor:o})})]})},$e=e=>{var t;let{category:n,path:i,value:o,onChange:s,onSaveCode:l,onRunCode:c,onExit:d,beforeMount:u}=e;const[p,h]=(0,r.useState)(null),[g,m]=(0,r.useState)(null),x=r.useRef(null);return(0,Ie.jsxs)("div",{className:"devinx3-editor-container",children:[(0,Ie.jsx)(ne.ZP,{theme:{algorithm:re.Z.darkAlgorithm},children:(0,Ie.jsxs)("div",{className:"devinx3-editor-header",children:[(0,Ie.jsx)(a.ZP,{type:"text",onClick:d,children:"\u9000\u51fa"}),l?(0,Ie.jsx)(a.ZP,{type:"text",onClick:()=>{g&&l?l(g.getValue(),(()=>A.ZP.success("\u4fdd\u5b58\u6210\u529f"))):A.ZP.warning("\u6682\u4e0d\u652f\u6301\u4fdd\u5b58")},children:"\u4fdd\u5b58"}):null,c?(0,Ie.jsx)(a.ZP,{type:"text",onClick:()=>{if(g&&c){const e=g.getValue();l?l(e,(()=>c(e))):c(e)}else A.ZP.warning("\u6682\u4e0d\u652f\u6301\u8fd0\u884c")},children:"\u8fd0\u884c"}):null]})}),(0,Ie.jsxs)("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[(0,Ie.jsx)("div",{ref:x,className:"devinx3-editor-content",style:{flex:1},children:(0,Ie.jsx)(K.default,{language:"javascript",theme:"vs-dark",path:"".concat(i,"_innerAiEditor"),value:o,onChange:s,options:{minimap:{enabled:!1},fontSize:14,lineNumbers:"on",scrollBeyondLastLine:!1,roundedSelection:!1,padding:{top:5,bottom:5},automaticLayout:!0},beforeMount:u,onMount:(e,t)=>{m(e),h(t),t&&e&&(e.addCommand(t.KeyCode.Escape,d),e.addAction({id:"exit",label:"\u9000\u51fa",keybindings:[t.KeyCode.Escape],contextMenuGroupId:"z_devinx3CustomizeGroup50",run:d}))}})}),(0,Ie.jsx)(We,{category:n,path:i,containerWidth:(null===(t=x.current)||void 0===t?void 0:t.offsetWidth)||0,monacoInstance:p,editorInstance:g})]})]})},_e=e=>{let{prompt:t}=e;const[n,i]=r.useState(!1);return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(a.ZP,{size:"small",onClick:()=>i(!n),type:"link",children:"AI"}),(0,Ie.jsxs)(M.Z,{title:"AI",open:n,width:"30vw",onClose:()=>i(!1),footer:null,children:[(0,Ie.jsx)(a.ZP,{href:"https://www.deepseek.com/",target:"_blank",type:"link",children:"Deepseek"}),(0,Ie.jsx)(T.default.Text,{copyable:{text:t},children:"\u63d0\u793a\u8bcd"})]})]})},He=e=>{let{category:t,path:n,value:i,onChange:o,onSaveCode:s,onRunCode:a,beforeMount:l}=e;const[c,d]=r.useState(!1);if(!c)return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(D.Z,{icon:(0,Ie.jsx)(O.Z,{}),onClick:()=>d(!0),type:"primary",children:"AI"}),(0,Ie.jsx)(K.default,{height:"66vh",language:"javascript",theme:"vs-dark",path:n,value:i,onChange:o,beforeMount:te})]});const u=()=>{d(!1)};return(0,Ie.jsx)(M.Z,{title:null,placement:"bottom",height:"100%",closeIcon:null,onClose:u,open:!0,keyboard:!1,push:!1,style:{position:"absolute",top:0,left:0,right:0,bottom:0,padding:0},styles:{body:{padding:0}},children:(0,Ie.jsx)($e,{category:t,path:n,value:i,onChange:o,onSaveCode:s,onRunCode:a,beforeMount:l,onExit:u})})},Xe=e=>{let{category:t,path:n,value:i,onChange:o,editorHelpRender:s,onSaveCode:a,onRunCode:l}=e;const[c,d]=r.useState("1");return(0,Ie.jsxs)(Ie.Fragment,{children:[s&&s(),(0,Ie.jsx)("br",{}),(0,Ie.jsxs)(R.Z,{style:{marginTop:"5px",marginBottom:"13px"},children:[(0,Ie.jsx)(B.ZP.Group,{size:"small",optionType:"button",onChange:e=>d(e.target.value),options:[{label:"monaco",value:"1"},{label:"input",value:"0"}],value:c}),we(t)?(0,Ie.jsx)(_e,{prompt:we(t)}):null]}),"1"===c?(0,Ie.jsx)(He,{category:t,path:n,value:i,onChange:o,onSaveCode:a,onRunCode:l,beforeMount:te}):(0,Ie.jsx)(L.default.TextArea,{placeholder:"\u8bf7\u8f93\u5165\u811a\u672c",rows:8,value:i,onChange:e=>o(e.target.value)})]})};var Ge=n(87518),Qe=n(12019),Ye=n(44874),et=n(98769),tt=n(23988),nt=n(64162),rt=n.n(nt),it=n(93160);const{addConfig:ot,updateConfig:st,hiddenConfig:at,deleteConfig:lt}=k,{Text:ct}=T.default,dt=e=>{let{category:t,config:n,name:i,description:o,scriptContent:s,onAddSuccess:l}=e;const c=n.name,d=n.description||c,[u,p]=r.useState(i),[h,g]=r.useState(o);return(0,Ie.jsxs)(R.Z,{children:[(0,Ie.jsx)(a.ZP,{onClick:()=>{if(!s)return A.ZP.warn("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),!1;let e=gt({name:u||c,description:h||u||d,scriptContent:s});tt.Z.copyToClipboard(e)&&A.ZP.info("\u5df2\u590d\u5236\u5206\u4eab\u94fe\u63a5")},children:"\u5206\u4eab"}),(0,Ie.jsx)(I.Z,{icon:null,cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",onConfirm:()=>{if(!s)return A.ZP.warn("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),!1;P(ot,t,{name:u||c,description:h||u||d,scriptContent:s}).then((()=>{p(null),g(null),A.ZP.success("\u6dfb\u52a0\u8282\u70b9\u6210\u529f"),l()})).catch((e=>A.ZP.error("\u6dfb\u52a0\u8282\u70b9\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+e)))},title:(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(L.default,{addonBefore:"\u8282\u70b9\u540d\u79f0",placeholder:c,value:u,onChange:e=>p(e.target.value)}),(0,Ie.jsx)(L.default,{style:{marginTop:"3px"},addonBefore:"\u8282\u70b9\u4f5c\u7528",placeholder:d,value:h,onChange:e=>g(e.target.value)})]}),children:(0,Ie.jsx)(a.ZP,{children:"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u8282\u70b9"})})]})},ut=(()=>{let e=100;return()=>e++})(),pt=e=>{let{category:t,context:n,config:l,refreshScript:c,editorHelpRender:d,intelligent:u,aiRender:p}=e;const[h,g]=r.useState(!1),[m,x]=r.useState({}),[f,y]=r.useState(l.scriptContent);(0,r.useEffect)((()=>{let e=(e=>{if(e.getShareData()){let n=rt().decompressFromEncodedURIComponent(e.getShareData());e.clearShareData();let r={};try{r=JSON.parse(n)}catch(t){return void A.ZP.error("\u5206\u4eab\u6570\u636e\u683c\u5f0f\u5f02\u5e38")}return{name:r.name,description:r.description,scriptContent:r.scriptContent}}})(u);e&&(x(e),y(e.scriptContent),g(!0))}),[u]);return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(s.Z,{title:l.description,mouseEnterDelay:1,children:(0,Ie.jsx)(a.ZP,{onClick:()=>g(!0),children:l.name})}),(0,Ie.jsx)(M.Z,{title:l.name,open:h,width:"75%",onClose:()=>{g(!1)},footer:(0,Ie.jsx)(i.Z,{justify:"end",children:(0,Ie.jsxs)(R.Z,{children:[(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(dt,{category:t,config:l,name:m.name,description:m.description,scriptContent:f,onAddSuccess:()=>{g(!1),c()}},"add")}),(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(a.ZP,{type:"primary",onClick:()=>{if(!f)return void A.ZP.warn("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a");const e=ut(),t=Ge.Je.EXPAND_ADD+"CONVERT";n.onConvert(n.createScriptEvent(t,l.name,f,e)),g(!1)},children:"\u6267\u884c"},"convert")})]})}),children:(0,Ie.jsx)(Xe,{category:t,path:"".concat(t,"|").concat(Ge.Je.EXPAND_ADD,"CONVERT|script"),value:f,onChange:y,editorHelpRender:d,aiRender:p})})]})},ht=e=>{let{category:t,config:n,visible:s,setVisible:l,editorHelpRender:c,aiRender:d,refreshScript:u}=e;const[p,h]=r.useState(n.name),[g,m]=r.useState(n.description),[x,f]=r.useState(n.scriptContent),y=r.useRef(null),v=r.useRef(null),j=()=>l(!1);return r.useEffect((()=>{t.startsWith("customize")&&n.code?(y.current=(e,r)=>{const i={code:n.code,name:n.name,description:n.description,scriptContent:e};P(st,t,i).then((()=>r&&r())).catch((e=>console.log(e)&A.ZP.error("\u4fdd\u5b58\u4ee3\u7801\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+e)))},v.current=()=>{const e=window.location.href.indexOf("?"),t=-1===e?window.location.href:window.location.href.substring(0,e);window.open(t+"?clickType=node&clickCode="+n.code)}):(v.current=null,y.current=null)}),[t,n]),(0,Ie.jsxs)(M.Z,{open:s,width:"75%",onCancel:j,title:p!==n.name||g!==n.description||x!==n.scriptContent?(0,Ie.jsx)(ct,{style:{color:"#1890ff"},strong:!0,children:"\u7f16\u8f91\u8282\u70b9 *"}):(0,Ie.jsx)(ct,{children:"\u7f16\u8f91\u8282\u70b9"}),onClose:j,footer:(0,Ie.jsx)(i.Z,{justify:"end",children:(0,Ie.jsxs)(R.Z,{children:[(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(a.ZP,{onClick:()=>{h(n.name),m(n.description),f(n.scriptContent)},children:"\u91cd\u7f6e"},"reset")}),(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(a.ZP,{onClick:()=>{P(lt,t,n.code).then((()=>{A.ZP.success("\u5220\u9664\u8282\u70b9\u6210\u529f"),j(),u()})).catch((e=>A.ZP.error("\u5220\u9664\u8282\u70b9\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+e)))},children:"\u5220\u9664\u8282\u70b9"},"remove")}),(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(a.ZP,{type:"primary",onClick:()=>{if(!p)return void A.ZP.error("\u8282\u70b9\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a");if(!x)return void A.ZP.error("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a");const e={code:n.code,name:p,description:g||p,scriptContent:x};P(st,t,e).then((()=>{A.ZP.success("\u66f4\u65b0\u8282\u70b9\u6210\u529f"),j(),u()})).catch((e=>console.log(e)&A.ZP.error("\u66f4\u65b0\u8282\u70b9\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+e)))},children:"\u66f4\u65b0\u8282\u70b9"},"update")})]})}),children:[(0,Ie.jsx)(L.default,{addonBefore:"\u8282\u70b9\u540d\u79f0",value:p,onChange:e=>h(e.target.value)}),(0,Ie.jsx)(L.default,{style:{marginTop:"3px"},addonBefore:"\u8282\u70b9\u4f5c\u7528",value:g,onChange:e=>m(e.target.value)}),(0,Ie.jsx)(Xe,{category:t,path:"".concat(t,"|").concat(n.code,"|script"),value:x,onChange:f,onRunCode:v.current,onSaveCode:y.current,editorHelpRender:c,aiRender:d})]})},gt=e=>{let t={name:e.name+"(\u6765\u81ea\u5206\u4eab)",description:e.description,scriptContent:e.scriptContent},n=(0,it.MS)(t);const r=window.location.href.indexOf("?");return(-1===r?window.location.href:window.location.href.substring(0,r))+"?shareData="+n},mt=e=>{let{category:t,intelligent:n,config:i,handleConvert:o,editorHelpRender:l,aiRender:c,refreshScript:d}=e;const[u,p]=r.useState(!1),h=[{key:"edit",label:(0,Ie.jsx)(a.ZP,{shape:"circle",type:"text",onClick:e=>p(!0),icon:(0,Ie.jsx)(Qe.Z,{}),size:"small",children:"\u7f16\u8f91"})},{key:"hidden",label:(0,Ie.jsx)(a.ZP,{shape:"circle",type:"text",onClick:e=>{P(at,t,i.code).then((()=>{A.ZP.success("\u9690\u85cf\u6210\u529f"),d()})).catch((e=>console.log(e)&A.ZP.error("\u66f4\u65b0\u8282\u70b9\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+e)))},icon:(0,Ie.jsx)(Ye.Z,{}),size:"small",children:"\u9690\u85cf"})},{key:"share",label:(0,Ie.jsx)(a.ZP,{shape:"circle",type:"text",onClick:e=>{tt.Z.copyToClipboard(gt(i))&&A.ZP.info("\u5df2\u590d\u5236\u5206\u4eab\u94fe\u63a5")},icon:(0,Ie.jsx)(et.Z,{}),size:"small",children:"\u5206\u4eab"})}];return n.canClick(Ge.Jg.NODE,i.code)&&(n.clearClick(),setTimeout((()=>o(i)),0)),(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(N.Z,{arrow:!1,autoAdjustOverflow:!0,menu:{items:h},trigger:["contextMenu"],children:(0,Ie.jsx)("div",{children:(0,Ie.jsx)(s.Z,{title:i.description,mouseEnterDelay:1,children:(0,Ie.jsx)(a.ZP,{type:"dashed",onClick:e=>o(i),children:i.name})})})}),(0,Ie.jsx)(ht,{category:t,config:i,visible:u,setVisible:p,editorHelpRender:l,aiRender:c,refreshScript:d})]})};var xt=n(82027),ft=n(67019),yt=n(31283),vt=n(18708),jt=n(99613),Ct=n(55615),St=n(11829),Zt=n(47515),bt=n(24585),wt=n(31741),Et=n(66407),Pt=n(80445),kt=n(571),Tt=n(43036),At=n(10658),Rt=n.n(At);const{addConfig:It,queryConfigByCode:Lt,updateConfig:Mt,hiddenConfig:Nt,batchDeleteConfig:Bt}=k;window.__devinx3_call_231125__=e=>{let t=JSON.stringify(e);return{remark:"\u8f6c\u6362\u6210\u65b0\u7248\u672c\u7684\u5bfc\u5165\u6570\u636e(2025-06-01 \u5220\u9664\u6b64\u51fd\u6570)",result:t,download:()=>{Tt.Z.download(t,"download-v2.txt")}}};const Dt="secretKey",Ot=e=>{let{category:t,intelligent:n,dataSource:i,refreshScript:o}=e;const[c,d]=r.useState(!1),[u,p]=r.useState([]),[h,g]=r.useState(!1),[m,x]=r.useState(!1),[f,y]=r.useState(!1),[v,j]=r.useState(),[C,S]=r.useState(""),[Z,b]=r.useState(),[w,E]=r.useState(!1),k=e=>{const t=e.target.value,n=[...u],r=n.indexOf(t);e.target.checked?r<0&&n.push(t):r>=0&&n.splice(r,1),p(n),g(!!n.length&&n.length<i.length),x(n.length===i.length)},I=()=>{const e=[];for(let t of i)if(-1!==u.indexOf(t.code)){const n={...t};e.push(n)}return e},N=()=>{p([]),x(!1),g(!1)};let B=null;const D=e=>{if(0===u.length)return void A.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u9700\u5bfc\u51fa");const n=((e,t)=>(0,it.ay)(e,{secretKey:C,...t}))(I(),e),r="config-"+t+"-"+Rt()().format("MMDDHHmmss");Tt.Z.download(n,r)},O=e=>{P(Nt,t,u,e).then((()=>{A.ZP.success("\u9690\u85cf\u6210\u529f"),N(),o()})).catch((e=>A.ZP.error("\u9690\u85cf\u5931\u8d25")))},K=e=>E(!0)&setTimeout(e,0),F=()=>E(!1),U=(e,n)=>{if(!e)return void F();let r=null;try{r=(0,it.V2)(e,n||C)}catch(a){return A.ZP.error("\u5bfc\u5165\u5931\u8d25, \u5f02\u5e38\u6d88\u606f: "+a.message),void F()}if(!(r&&r.length&&r.length>0))return void F();let i=0,s="";Promise.all(r.map((async e=>{const n=Lt(t,e.code);if(1===(null===n||void 0===n?void 0:n.length))try{return console.debug("\u5bfc\u5165\u7684\u6570\u636e:",n[0]),l.fp.canUpdate(n[0].version,e.version)&&Mt(t,e,!0),i++}catch(r){return s=s+r+";"}else{if((null===n||void 0===n?void 0:n.length)>1)return"\u5bfc\u5165\u5931\u8d25: \u5b58\u5728\u591a\u4e2a\u76f8\u540c\u7684\u7f16\u7801: "+e.code+";";e.name=e.name+(e.code?"":"(by import)")}try{return It(t,e,!0),i++}catch(r){return s=s+r+";"}}))).finally((()=>{0!==i?(i===r.length?A.ZP.success("\u5168\u90e8\u5bfc\u5165\u6210\u529f"):A.ZP.warn("\u90e8\u5206\u5bfc\u5165\u6210\u529f, \u5f02\u5e38\u4e2a\u6570"+(r.length-i)+", \u5f02\u5e38\u6d88\u606f: "+s),F(),o()):A.ZP.error("\u5168\u90e8\u5bfc\u5165\u5931\u8d25, \u5f02\u5e38\u6d88\u606f: "+s)}))},V=(e,t,n)=>{if(w)return A.ZP.warn("\u6b63\u5728\u5bfc\u5165\u4e2d, \u8bf7\u7b49\u5f85"),!1;const r=null!==t&&void 0!==t&&t.length?t:Z;if((null===r||void 0===r?void 0:r.length)>0){if(!(e=>{try{return new URL(e)}catch(t){return!1}})(r))return A.ZP.error("\u65e0\u6548\u7684\u5bfc\u5165\u5730\u5740"),!1;K((()=>((e,t,n,r)=>{xe.Z.get(e,{responseType:"text"}).then((function(e){n(e.data,t)})).catch((t=>{r(),A.ZP.error("\u52a0\u8f7d\u5931\u8d25: "+e),console.debug("\u52a0\u8f7d\u5931\u8d25",t)})).finally((()=>r(void 0)))})(r,n,U,F)))}else K((()=>Tt.Z.readAsText({file:e,handleRead:U,handleError:F})));return!1};if(n.getImportUrl()){var z;let e=n.getImportUrl();const t=null===(z=_.Z.getSearchParams(e).get(Dt))||void 0===z?void 0:z.trim();n.clearImport(),V(null,e,t)}return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(a.ZP,{type:"link",style:{marginTop:"5px"},onClick:()=>d(!0),children:"\u811a\u672c\u8282\u70b9"}),(0,Ie.jsx)(M.Z,{title:"\u811a\u672c\u8282\u70b9",open:c,placement:"left",footer:null,onClose:()=>d(!1),closeIcon:null,extra:(0,Ie.jsx)(St.Z,{className:"ant-drawer-close",onClick:()=>d(!1)}),children:(0,Ie.jsx)(xt.Z,{spinning:w,children:(0,Ie.jsx)(ft.Z,{itemLayout:"horizontal",dataSource:i,rowKey:"code",header:(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(yt.Z,{indeterminate:h,disabled:0===i.length,checked:m,onChange:e=>{if(e.target.checked){const e=[];for(let t of i)e.push(t.code);p(e)}else p([]);g(!1),x(e.target.checked)},children:"\u5168\u9009"}),(0,Ie.jsx)(a.ZP,{type:"text",disabled:0===u.length,icon:(0,Ie.jsx)(Zt.Z,{}),onClick:()=>{0!==u.length?P(Bt,t,u).then((()=>{A.ZP.success("\u5220\u9664\u6210\u529f"),N(),o()})).catch((e=>A.ZP.error("\u5220\u9664\u5931\u8d25, \u539f\u56e0\u662f: "+e))):A.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u9700\u5220\u9664")},children:"\u5220\u9664"}),(0,Ie.jsx)(a.ZP,{type:"text",disabled:0===u.length,icon:(0,Ie.jsx)(bt.Z,{}),onClick:()=>{clearTimeout(B),B=setTimeout((()=>{clearTimeout(B),D({})}),555)},children:"\u5907\u4efd"}),(0,Ie.jsx)(a.ZP,{type:"text",disabled:0===u.length,onClick:()=>O(!0),icon:(0,Ie.jsx)(Ye.Z,{}),children:"\u9690\u85cf"}),(0,Ie.jsx)(a.ZP,{type:"text",disabled:0===u.length,onClick:()=>O(!1),icon:(0,Ie.jsx)(wt.Z,{}),children:"\u663e\u793a"}),(0,Ie.jsx)(s.Z,{title:"\u4e0d\u652f\u6301\u5bfc\u5165",mouseEnterDelay:2,children:(0,Ie.jsx)(a.ZP,{type:"text",disabled:0===u.length,icon:(0,Ie.jsx)(Et.Z,{}),onClick:()=>{if(0===u.length)return void A.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u6cd5\u590d\u5236");const e=I();tt.Z.copyToClipboard(JSON.stringify(e))&&A.ZP.success("\u590d\u5236\u6210\u529f")},children:"\u590d\u5236JSON\u8282\u70b9"})})]}),footer:(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(L.default,{style:{marginTop:"3px"},type:"url",placeholder:"\u5907\u4efd\u6587\u4ef6\u5730\u5740",value:Z,onChange:e=>{var t,n;const r=null===(t=e.target.value)||void 0===t?void 0:t.trim();b(r);const i=null===(n=_.Z.getSearchParams(r).get(Dt))||void 0===n?void 0:n.trim();S(i||"")},allowClear:!0}),(0,Ie.jsx)(L.default,{style:{marginTop:"3px"},type:"text",disabled:(null===Z||void 0===Z?void 0:Z.length)>0,addonBefore:"".concat(Dt,"="),placeholder:"\u5bc6\u94a5",value:C,onChange:e=>S(e.target.value),allowClear:!0}),(0,Ie.jsxs)(R.Z,{style:{marginTop:"3px"},children:[(null===Z||void 0===Z?void 0:Z.length)>0?(0,Ie.jsx)(a.ZP,{onClick:V,icon:(0,Ie.jsx)(Pt.Z,{}),children:"\u5bfc\u5165"}):(0,Ie.jsx)(vt.default,{maxCount:1,showUploadList:!1,beforeUpload:e=>V(e),children:(0,Ie.jsx)(a.ZP,{icon:(0,Ie.jsx)(Pt.Z,{}),children:"\u5bfc\u5165"})}),(0,Ie.jsx)(a.ZP,{onClick:()=>{if(!((null===Z||void 0===Z?void 0:Z.length)>0))return void A.ZP.warning("\u8bf7\u8f93\u5165\u5907\u4efd\u6587\u4ef6\u5730\u5740");const e=window.location.href.indexOf("?");let t=-1===e?window.location.href:window.location.href.substring(0,e);t=t+"?importUrl="+window.encodeURIComponent(Z),tt.Z.copyToClipboard(t),A.ZP.success("\u5df2\u590d\u5236\u5230\u7c98\u8d34\u677f")},children:"\u751f\u6210\u5bfc\u5165\u94fe\u63a5"})]})]}),renderItem:e=>(0,Ie.jsx)(ft.Z.Item,{actions:[(0,Ie.jsx)(kt.Z,{type:"link",tipTitle:"\u590d\u5236\u8282\u70b9\u7f16\u7801",onClick:()=>tt.Z.copyToClipboard(e.code)}),(0,Ie.jsx)(a.ZP,{type:"link",onClick:()=>{return t=e.scriptContent,j(t),void y(!0);var t},children:"\u811a\u672c"},"list-item-srcipt")],children:(0,Ie.jsx)(jt.Z,{loading:!1,children:(0,Ie.jsx)(ft.Z.Item.Meta,{avatar:(0,Ie.jsx)(yt.Z,{value:e.code,checked:u.indexOf(e.code)>=0,onChange:k}),title:(0,Ie.jsxs)(Ie.Fragment,{children:[e.hidden?(0,Ie.jsx)(Ye.Z,{}):(0,Ie.jsx)(wt.Z,{}),(0,Ie.jsx)(T.default.Text,{title:e.code,style:{marginLeft:"3px"},children:(0,Ie.jsx)("b",{children:e.name})})]}),description:e.description})})})})})}),(0,Ie.jsx)(Ct.Z,{title:"\u811a\u672c\u5185\u5bb9",open:f,width:"60%",footer:null,onCancel:()=>{j(null),y(!1)},children:(0,Ie.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:(0,Ie.jsx)(T.default.Paragraph,{code:!0,copyable:!0,children:v})})})]})},Kt=e=>{let{lang:t,category:n,context:r,intelligent:c,basicButtons:d,expandAddButton:u,editorHelpRender:p,aiRender:h,refreshManage:g}=e;d=l.fp.convertBasicButtons(d);const m=u?(e=>k.listAllConfig(e)||[])(n):[],x=e=>r.onConvert(r.createScriptEvent(e.code,e.name,e.scriptContent,e.version));return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsxs)(i.Z,{style:{marginTop:"10px"},children:[d.map(((e,t)=>(0,Ie.jsx)(o.Z,{style:{marginLeft:"10px"},children:(0,Ie.jsx)(s.Z,{title:e.description,mouseEnterDelay:1,children:(0,Ie.jsx)(a.ZP,{onClick:()=>x(e),children:e.name})})},t))),u?(0,Ie.jsx)(o.Z,{style:{marginLeft:"10px"},children:(0,Ie.jsx)(pt,{category:n,context:r,config:u,editorHelpRender:p,aiRender:h,intelligent:c,refreshScript:g})}):null]}),(0,Ie.jsxs)(i.Z,{style:{marginTop:"10px"},children:[(0,Ie.jsx)(Ot,{category:n,dataSource:m,intelligent:c,refreshScript:g}),m.filter((e=>!e.hidden)).map(((e,t)=>(0,Ie.jsx)(o.Z,{style:{marginLeft:"10px",marginTop:"5px"},children:(0,Ie.jsx)(mt,{category:n,config:e,intelligent:c,editorHelpRender:p,aiRender:h,refreshScript:g,handleConvert:x})},e.code+"-"+t)))]})]})};var Ft=n(19389),Ut=n(31118);const{addCombination:Vt,updateCombination:zt,deleteCombination:Jt}=k,{Text:qt}=T.default,Wt="\u81ea\u5b9a\u4e49\u7f16\u6392",$t=e=>{let{category:t,combinationConfig:n,refreshManage:i}=e;const[o,s]=r.useState(),[l,c]=r.useState();n.name=n.name||Wt,n.description=n.description||n.name;return(0,Ie.jsx)(I.Z,{icon:null,cancelText:"\u53d6\u6d88",okText:"\u65b0\u5efa",onConfirm:()=>{const e={};e.name=o||Wt,e.description=l||e.name,e.combination=[],P(Vt,t,e).then((()=>{A.ZP.success("\u521b\u5efa\u6210\u529f"),i()})).catch((e=>A.ZP.warn("\u521b\u5efa\u5931\u8d25, \u539f\u56e0\u662f"+e)))},placement:"right",title:(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(T.default.Title,{level:5,children:"\u65b0\u5efa\u7f16\u6392"}),(0,Ie.jsx)(L.default,{addonBefore:"\u7f16\u6392\u540d\u79f0",placeholder:n.name,value:o,onChange:e=>s(e.target.value)}),(0,Ie.jsx)(L.default,{style:{marginTop:"3px"},addonBefore:"\u7f16\u6392\u4f5c\u7528",placeholder:n.description,value:l,onChange:e=>c(e.target.value)})]}),children:(0,Ie.jsx)(a.ZP,{style:{marginLeft:"10px"},shape:"circle",type:"text",icon:(0,Ie.jsx)(ue.Z,{}),size:"small"})})},_t=e=>{let{visible:t,setVisible:n,handleAddConfig:i,configDataSource:o}=e;const[a,c]=r.useState(),d=[{title:"\u540d\u79f0",dataIndex:"name",render:(e,t)=>(0,Ie.jsx)(s.Z,{title:t.description,children:e})},{title:"\u7c7b\u522b",dataIndex:"costom",render:e=>1===e?(0,Ie.jsx)(T.default.Text,{type:"warning",children:"\u81ea\u5b9a\u4e49"}):(0,Ie.jsx)(T.default.Text,{type:"success",children:"\u7cfb\u7edf"})}],u=()=>{n(!1),c(void 0)},p={type:"radio",onChange:(e,t)=>{c(e[0])},selectedRowKeys:[a]};return(0,Ie.jsx)(Ct.Z,{title:"\u8282\u70b9\u9009\u62e9",open:t,cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",onCancel:u,onOk:()=>{i(a),u()},children:(0,Ie.jsx)(Ft.Z,{rowSelection:{...p},rowKey:"code",columns:d,dataSource:(()=>{const e=[];for(let t of o)e.push({code:t.code,name:t.name,description:t.description,costom:l.fp.isBasic(t)?0:1});return e})(),pagination:!1})})},Ht=e=>{let{category:t,combinationConfig:n,intelligent:c,refreshManage:d,handleConvert:u,configDataSource:p}=e;const[h,g]=r.useState(!1),[m,x]=r.useState(!1),[f,y]=r.useState(!1),[v,j]=r.useState(n.name),[C,S]=r.useState(n.description),[Z,b]=r.useState([...n.combination]);c.canClick(Ge.Jg.ARRANGE,n.code)&&(c.clearClick(),setTimeout((()=>u(n,n.combination)),0));const w=(e=>{const t={};for(let n of e)t[n.code]={...n};return t})(p),E=Z.map(((e,t)=>{const n=w[e]||{};return n.index=t,n})),T=()=>{g(!1)},I=e=>{y(e),x(!0)};return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(s.Z,{style:{marginLeft:"15px"},title:n.description,mouseEnterDelay:1,children:(0,Ie.jsx)(a.ZP,{type:"dashed",onClick:e=>u(n,n.combination),children:n.name})}),(0,Ie.jsx)(s.Z,{title:"\u7f16\u8f91",mouseEnterDelay:2,children:(0,Ie.jsx)(a.ZP,{shape:"circle",type:"text",onClick:e=>g(!0),icon:(0,Ie.jsx)(Qe.Z,{}),size:"small"})}),(0,Ie.jsxs)(M.Z,{open:h,onCancel:T,title:(()=>{if(Z.length!==n.combination.length)return!0;for(let e=0;e++;e<=Z.length)if(Z[e]!==n.combination[e])return!0;return v!==n.name||C!==n.description})()?(0,Ie.jsx)(qt,{style:{color:"#1890ff"},strong:!0,children:"\u7f16\u8f91\u7f16\u6392 *"}):(0,Ie.jsx)(qt,{children:"\u7f16\u8f91\u7f16\u6392"}),onClose:T,footer:(0,Ie.jsx)(i.Z,{justify:"end",children:(0,Ie.jsxs)(R.Z,{children:[(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(a.ZP,{onClick:()=>{j(n.name),S(n.description),b([...n.combination])},children:"\u91cd\u7f6e"},"reset")}),(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(a.ZP,{onClick:()=>{P(Jt,t,n.code).then((()=>{A.ZP.success("\u5220\u9664\u6210\u529f"),g(!1),d()})).catch((e=>A.ZP.success("\u5220\u9664\u5931\u8d25, \u539f\u56e0\u662f"+e)))},children:"\u5220\u9664\u7f16\u6392"},"delete")}),(0,Ie.jsx)(o.Z,{children:(0,Ie.jsx)(a.ZP,{type:"primary",onClick:()=>{if(0===Z.length)return void A.ZP.warn("\u8bf7\u5148\u7ef4\u62a4\u8282\u70b9");if(!v)return void A.ZP.warn("\u8bf7\u7ef4\u7f16\u6392\u540d\u79f0");for(const n of Z)if(!l.fp.isBasic(n)&&!k.queryConfigByCode(t,n))return void A.ZP.warn("\u811a\u672c\u8282\u70b9\u4e0d\u5b58\u5728, \u8bf7\u5237\u65b0\u9875\u9762");const e={code:n.code,name:v,description:C||v,combination:Z};P(zt,t,e).then((()=>{A.ZP.success("\u4fdd\u5b58\u6210\u529f"),g(!1),d()})).catch((e=>A.ZP.error("\u4fdd\u5b58\u5931\u8d25, \u539f\u56e0\u662f: "+e)))},children:"\u4fdd\u5b58\u7f16\u6392"})})]})}),children:[(0,Ie.jsx)(L.default,{addonBefore:"\u7f16\u6392\u540d\u79f0",value:v,onChange:e=>j(e.target.value)}),(0,Ie.jsx)(L.default,{style:{marginTop:"5px",marginBottom:"15px"},addonBefore:"\u7f16\u6392\u4f5c\u7528",value:C,onChange:e=>S(e.target.value)}),(0,Ie.jsx)(Ut.Z,{mode:"left",items:(e=>e&&0!==e.length?e.map(((e,t)=>({color:l.fp.isBasic(e)?"#52c41a":"#faad14",children:(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(s.Z,{title:"\u6dfb\u52a0",mouseEnterDelay:2,children:(0,Ie.jsx)(a.ZP,{shape:"circle",type:"text",icon:(0,Ie.jsx)(ue.Z,{}),onClick:e=>I(t)})}),(0,Ie.jsx)(s.Z,{title:"\u5220\u9664",mouseEnterDelay:2,children:(0,Ie.jsx)(a.ZP,{shape:"circle",type:"text",icon:(0,Ie.jsx)(Zt.Z,{}),onClick:e=>(e=>{Z.splice(e,1),b([...Z])})(t)})}),(0,Ie.jsx)(s.Z,{title:e.description,mouseEnterDelay:1,children:e.name})]})}))):[{color:"gray",children:(0,Ie.jsx)(s.Z,{title:"\u6dfb\u52a0",mouseEnterDelay:2,children:(0,Ie.jsx)(a.ZP,{shape:"circle",type:"text",icon:(0,Ie.jsx)(ue.Z,{}),onClick:e=>I(-1)})})}])(E)})]}),(0,Ie.jsx)(_t,{visible:m,setVisible:x,handleAddConfig:e=>{if(!m)return;const t=[];for(let n=0;n<Z.length;n++)t.push(Z[n]),n===f&&t.push(e);-1===f&&t.push(e),b(t)},configDataSource:p})]})},Xt=()=>(0,Ie.jsx)(a.ZP,{type:"link",disabled:!0,children:"\u811a\u672c\u7f16\u6392"}),Gt=e=>{let{lang:t,category:n,context:s,intelligent:a,basicButtons:c,expandAddButton:d}=e;const u=(e=>k.listAllCombination(e)||[])(n)||[],[p,h]=r.useState(!1),g=(e=>k.listAllConfig(e)||[])(n);if(0===g.length)return(0,Ie.jsx)(Ie.Fragment,{});c=l.fp.convertBasicButtons(c);const m=()=>h(!p),x=(e,t)=>{if(!t||0===t.length)return void A.ZP.error("\u4e0d\u5b58\u5728\u4efb\u4f55\u8282\u70b9");let r=null;const i=s.createScriptEvent(e.code,e.name,null,e.version);let o=i;if(t.forEach((e=>{const t=((e,t,n)=>{if(l.fp.isBasic(n))for(let r of t)if(n===r.code)return[r];return k.queryConfigByCode(e,n)||[]})(n,c,e)[0];return t?t.scriptContent?void(o=o.add(t.code,t.name,t.scriptContent,t.version)):(r="\u811a\u672c\u5185\u5bb9\u4e3a\u7a7a",null):(r="\u8282\u70b9\u4e0d\u5b58\u5728",null)})),!r)return s.onConvert(i);A.ZP.error(r)},f=[...c,...g];return(0,Ie.jsxs)(i.Z,{style:{marginTop:"10px"},children:[(0,Ie.jsxs)(o.Z,{children:[(0,Ie.jsx)(Xt,{}),(0,Ie.jsx)($t,{category:n,combinationConfig:d,refreshManage:m})]}),u.map(((e,t)=>(0,Ie.jsx)(o.Z,{style:{marginLeft:"10px"},children:(0,Ie.jsx)(Ht,{category:n,combinationConfig:e,intelligent:a,refreshManage:m,configDataSource:f,handleConvert:x})},t)))]})},Qt=e=>{let{lang:t,category:n,context:i,intelligent:o,buttons:s={},expandScriptButton:a={},expandCombinationButton:l={},editorHelpRender:c,aiRender:d}=e;const[u,p]=r.useState(!1);return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)(Kt,{lang:t,category:n,context:i,intelligent:o,basicButtons:s,expandAddButton:a,editorHelpRender:c,aiRender:d,refreshManage:()=>p(!u)}),(0,Ie.jsx)(Gt,{lang:t,category:n,context:i,intelligent:o,basicButtons:s,expandAddButton:l})]})}},571:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(47313),i=n(61763),o=n(23232),s=n(43681),a=n(66407),l=n(17534),c=n(46417);const d=e=>{const[t,n]=r.useState(!1),d=l.Z.omit(e,["tipTitle"]);return(0,c.jsx)(i.Z,{title:e.tipTitle||"\u590d\u5236",children:(0,c.jsx)(o.ZP,{...d,onClick:r=>{if(!t&&e.onClick){const t=e.onClick(r);return!0===t&&n(!0),t}},icon:t?(0,c.jsx)(s.Z,{style:{color:"#52c41a"}}):(0,c.jsx)(a.Z,{}),onMouseLeave:()=>{t&&n(!1)}})})}},43036:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={readAsText:e=>{let{file:t,handleRead:n,charset:r,handleError:i}=e;r||(r="utf8");const o=new FileReader;o.onload=()=>{n(o.result)},o.onerror=i,o.readAsText(t,r)},download:(e,t)=>{t||(t="download");let n=URL.createObjectURL(new Blob([e]));const r=document.createElement("a");r.href=n,r.setAttribute("download",t),document.body.appendChild(r),r.click(),document.body.removeChild(r)}}},17534:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,Z:()=>s});const r={},i={loadMonaco:"converter.loadEditor.loadMonaco.loaded"},o={getFromCache:e=>r[e],setToCache:(e,t)=>r[e]=t,getAdvanceKey:()=>"active=adv",enableAdvance:()=>(null!==r.adv&&void 0!==r.adv||(r.adv="1"===window.localStorage.getItem(o.getAdvanceKey())),!0===r.adv),setAdvance:()=>{r.adv=!0,window.localStorage.setItem(o.getAdvanceKey(),"1")},omit:(e,t)=>{const n=Object.assign({},e);for(let r=0;r<t.length;r+=1){delete n[t[r]]}return n},getSearchParams:e=>{const t=null!==e&&void 0!==e&&e.indexOf?e.indexOf("?"):-1;return new URLSearchParams(t<0?void 0:e.substring(t+1))}},s=o},42480:()=>{}}]);