(self.webpackChunktoolkit=self.webpackChunktoolkit||[]).push([[51],{3766:(t,n,e)=>{"use strict";e.r(n),e.d(n,{default:()=>C});var a=e(7313),c=e(2652),s=e(5291),u=e(6031),o=e.n(u),r=e(658),i=e.n(r),l=e(2984),h=e.n(l),p=e(8737),f=e(3988);const k={_:o(),dayjs:i(),cryptoJS:h(),XLSX:p,message:s.ZP};function d(t,n){return null===t||void 0===t?n:t}function D(t,n,e){return function(t,n,e){return new Function("inputData","inputObj","Util",t)(n,e,{...k})}(e,n,t?t(n):null)}function I(t,n,e){return new Promise(((a,c)=>{const s=t=>{return a((n=t)instanceof Object?JSON.stringify(n,null,2):d(n,""));var n},u=(t,n)=>console.error(n)&c(function(t,n){const e=n instanceof Object?d(n.message,""):n;return null===t||void 0===t?e:"".concat(t,": ").concat(e)}(t,n));let o=e,r="";for(let e=0;e<n.length;e++){const l=n[e],h=l.name,p=f.Z.isStr(l)?l:l.content;try{if(r=D(t,o,p),r instanceof Promise)return void r.then((u=>{e>=n.length-1?s(u):I(t,n.splice(e+1),u).then(a).catch(c)})).catch((t=>{u(h,t)}))}catch(i){return void u(h,i)}o=r}s(r)}))}var g=e(6417);class v{constructor(){this.checkInputData=null}setCheckInputData(t){this.checkInputData=t}onCheckInputData(t){return!this.checkInputData||this.checkInputData(t)}}const C=t=>{let{context:n,dataBlockRender:e,handleInputObj:s}=t;const[u,o]=a.useState(""),[r,i]=a.useState(""),[l,h]=a.useState(""),[p,f]=a.useState(!1),k=a.useMemo((()=>new v),[]);return n.setConvertHandler((t=>{p?console.warn("Conversion failed because loading"):(f(!0),setTimeout((()=>{const n=k.onCheckInputData(u);if(!0!==n)return i("")&h(n)&f(!1);const e=t=>i("")&h(t);I(s,t,u).then((t=>""===t?e("\u65e0\u6267\u884c\u7ed3\u679c"):i(t)&h(""))).catch(e).finally((()=>f(!1)))}),60))})),(0,g.jsx)(c.Z,{spinning:p,children:e({state:{inputData:u,setInputData:o,outputData:r,setOutputData:i,errorMsg:l,setErrorMsg:h},setCheckInputData:t=>k.setCheckInputData(t)})})}},2480:()=>{}}]);