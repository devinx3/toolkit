(self.webpackChunktoolkit=self.webpackChunktoolkit||[]).push([[51],{3766:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>w});var r=n(7313),a=n(2652),c=n(5291),o=n(8770),s=n(1739),u=n(6031),l=n.n(u),i=n(658),h=n.n(i),m=n(2984),p=n.n(m),d=n(8737),f=n(3988);const k={_:l(),dayjs:h(),cryptoJS:p(),XLSX:d,message:c.ZP},g="converter-container";function D(t,e){return null===t||void 0===t?e:t}function v(t,e,n){return function(t,e,n){return new Function("inputData","inputObj","Util",t)(e,n,{...k})}(n,e,t?t(e):null)}function C(t,e,n){return new Promise(((r,a)=>{const c=t=>{return r((e=t)instanceof Object?JSON.stringify(e,null,2):D(e,""));var e},o=(t,e)=>console.error(e)&a(function(t,e){const n=e instanceof Object?D(e.message,""):e;return null===t||void 0===t?n:"".concat(t,": ").concat(n)}(t,e));let s=n,u="";for(let n=0;n<e.length;n++){const i=e[n],h=i.name,m=f.Z.isStr(i)?i:i.content;try{if(u=v(t,s,m),u instanceof Promise)return void u.then((o=>{n>=e.length-1?c(o):C(t,e.splice(n+1),o).then(r).catch(a)})).catch((t=>{o(h,t)}))}catch(l){return void o(h,l)}s=u}c(u)}))}k.ReactHelper={createContainer:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=s.createRoot(document.getElementById(g)),a=a=>{let{onSuccess:c,onError:s}=a;try{const a=t=>n.unmount(),u=t=>a()&s(t),l=t({resolve:t=>a()&c(t),reject:t=>a()&s(t)}),i=l instanceof Array?l:[l];return r.createElement(o.Z,{onCancel:()=>u("\u5df2\u53d6\u6d88"),onOk:()=>u("\u5df2\u53d6\u6d88"),footer:null,maskClosable:!0,...e,open:!0,key:g+"-modal"},r.createElement(r.Fragment,{},...i))}catch(u){s(u)}};return new Promise(((t,e)=>{try{n.render(r.createElement(a,{onSuccess:t,onError:e}))}catch(c){e(c)}}))},createElement:r.createElement,createFragment:t=>{r.Fragment},useState:r.useState},k.importPlugin=t=>{if("antd"===t)return Promise.all([n.e(922),n.e(617)]).then(n.bind(n,4617));throw new Error("unknown moduleName")};var I=n(6417);class S{constructor(){this.checkInputData=null}setCheckInputData(t){this.checkInputData=t}onCheckInputData(t){return!this.checkInputData||this.checkInputData(t)}}const w=t=>{let{context:e,dataBlockRender:n,handleInputObj:c}=t;const[o,s]=r.useState(""),[u,l]=r.useState(""),[i,h]=r.useState(""),[m,p]=r.useState(!1),d=r.useMemo((()=>new S),[]);return e.setConvertHandler((t=>{m?console.warn("Conversion failed because loading"):(p(!0),setTimeout((()=>{const e=d.onCheckInputData(o);if(!0!==e)return l("")&h(e)&p(!1);const n=t=>l("")&h(t);C(c,t,o).then((t=>""===t?n("\u65e0\u6267\u884c\u7ed3\u679c"):l(t)&h(""))).catch(n).finally((()=>p(!1)))}),60))})),(0,I.jsx)(a.Z,{spinning:m,children:n({state:{inputData:o,setInputData:s,outputData:u,setOutputData:l,errorMsg:i,setErrorMsg:h},setCheckInputData:t=>d.setCheckInputData(t)})})}},2480:()=>{}}]);