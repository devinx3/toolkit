"use strict";(self.webpackChunktoolkit=self.webpackChunktoolkit||[]).push([[720],{6720:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var r=t(3433),l=t(9439),i=t(7313),a=t(7978),s=t(1656),c=t(5291),o=t(8197),d=t(9624),h=t(5705),x=t(9180),p=t(9491),u=t(685),j=t(473),Z=t(7222),g=t(6155),b=t(2231),m=t(1413),f={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},k=t(3847),y=function(e,n){return i.createElement(k.Z,(0,m.Z)((0,m.Z)({},e),{},{ref:n,icon:f}))};y.displayName="InboxOutlined";var T=i.forwardRef(y),v=t(3495),w=t(6986),S=t(1526),L=t(571),P=t(3988),C=t(3036),D=t(7518),N=t(1677),_=t(6417),U=(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(a.Z.Title,{level:3,children:"\u5e2e\u52a9\u6587\u6863"}),(0,_.jsx)(a.Z.Title,{level:4,children:"\u4f7f\u7528\u4ecb\u7ecd"}),(0,_.jsx)(a.Z.Paragraph,{children:"\u65b9\u6cd5\u7684\u5165\u53c2\u4e3a: inputData, Util"}),(0,_.jsx)(a.Z.Paragraph,{children:"\u65b9\u6cd5\u7684\u8fd4\u56de\u503c: \u652f\u6301\u8fd4\u56de Promise \u5bf9\u8c61, resolve\u65b9\u6cd5\u7684\u53c2\u6570\u5373\u4e3a\u8fd4\u56de\u503c, reject\u65b9\u6cd5\u7684\u53c2\u6570\u5373\u4e3a\u62a5\u9519\u63d0\u793a"}),(0,_.jsxs)(a.Z.Paragraph,{children:[(0,_.jsx)(a.Z.Text,{code:!0,copyable:!0,children:"inputData"}),": \u8f93\u5165\u6570\u636e"]}),(0,_.jsxs)(a.Z.Paragraph,{children:[(0,_.jsx)(a.Z.Text,{code:!0,copyable:!0,children:"inputObj"}),": \u8f93\u5165\u6570\u636e\u8f6c\u6362\u7684Json\u5bf9\u8c61"]}),(0,_.jsxs)(a.Z.Paragraph,{children:[(0,_.jsx)(a.Z.Text,{code:!0,copyable:!0,children:"Util"}),": \u5185\u7f6e\u7684\u5de5\u5177\u7c7b"]}),(0,_.jsxs)(a.Z.Paragraph,{children:["\u4f7f\u7528\u8005\u4ec5\u4ec5\u9700\u8981\u5b9e\u73b0",(0,_.jsx)("b",{children:"\u65b9\u6cd5\u4f53"})]}),(0,_.jsx)(a.Z.Title,{level:5,children:"\u8f6c\u6362\u65b9\u6cd5\u6837\u4f8b"}),(0,_.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:(0,_.jsx)(a.Z.Paragraph,{code:!0,copyable:{text:"return inputObj;"},children:"function anonymous(inputData, Util) {\n    // \u5904\u7406\u903b\u8f91\n    return inputData;\n}"})}),(0,_.jsx)("br",{})]}),X=(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(a.Z.Title,{level:3,children:"\u5e38\u7528\u5de5\u5177"}),(0,_.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:(0,_.jsx)(a.Z.Paragraph,{code:!0,copyable:!0,children:"const { _, dayjs, cryptoJS, XLSX, message } = Util"})}),(0,_.jsxs)(a.Z.Paragraph,{children:[(0,_.jsx)(a.Z.Title,{level:5,children:"\u5de5\u5177\u5e93"}),(0,_.jsx)(a.Z.Text,{code:!0,copyable:!0,children:"const { _ } = Util"}),(0,_.jsx)(a.Z.Link,{style:{marginLeft:"5px"},href:"https://www.lodashjs.com/",target:"_blank",children:"loadsh \u5b98\u7f51"})]}),(0,_.jsxs)(a.Z.Paragraph,{children:[(0,_.jsx)(a.Z.Title,{level:5,children:"\u65e5\u671f\u5de5\u5177"}),(0,_.jsx)(a.Z.Text,{code:!0,copyable:!0,children:"const { dayjs } = Util"}),(0,_.jsx)(a.Z.Link,{style:{marginLeft:"5px"},href:"https://dayjs.gitee.io/zh-CN/",target:"_blank",children:"Day.js \u5b98\u7f51"})]}),(0,_.jsxs)(a.Z.Paragraph,{children:[(0,_.jsx)(a.Z.Title,{level:5,children:"\u52a0\u5bc6\u5de5\u5177"}),(0,_.jsx)(a.Z.Text,{code:!0,copyable:!0,children:"const { cryptoJS } = Util"}),(0,_.jsx)(a.Z.Link,{style:{marginLeft:"5px"},href:"https://github.com/brix/crypto-js",target:"_blank",children:"crypto-js"})]}),(0,_.jsxs)(a.Z.Paragraph,{children:[(0,_.jsx)(a.Z.Title,{level:5,children:"\u6587\u4ef6\u5de5\u5177"}),(0,_.jsx)(a.Z.Text,{code:!0,copyable:!0,children:"const { XLSX } = Util"}),(0,_.jsx)(a.Z.Link,{style:{marginLeft:"5px"},href:"https://github.com/rockboom/SheetJS-docs-zh-CN/",target:"_blank",children:"SheetJS \u6587\u6863"})]}),(0,_.jsxs)(a.Z.Paragraph,{children:[(0,_.jsx)(a.Z.Title,{level:5,children:"\u6d88\u606f\u5de5\u5177"}),(0,_.jsx)(a.Z.Text,{code:!0,copyable:!0,children:"const { message } = Util"}),(0,_.jsx)(a.Z.Text,{children:"\u6d88\u606f\u63d0\u793a\u65b9\u6cd5\uff0c\u4f7f\u7528\u65b9\u5f0f\u548c\u53c2\u6570\u5982\u4e0b:"}),(0,_.jsx)("br",{}),(0,_.jsx)(a.Z.Text,{children:"(content: \u6d88\u606f\u5185\u5bb9, duration: \u81ea\u52a8\u5173\u95ed\u7684\u5ef6\u65f6, \u5355\u4f4d\u79d2, \u8bbe\u4e3a0\u65f6\u4e0d\u81ea\u52a8\u5173\u95ed)"}),(0,_.jsx)("br",{}),(0,_.jsx)(a.Z.Text,{code:!0,children:"message.success(content, [duration])"}),(0,_.jsx)("br",{}),(0,_.jsx)(a.Z.Text,{code:!0,children:"message.error(content, [duration])"}),(0,_.jsx)("br",{}),(0,_.jsx)(a.Z.Text,{code:!0,children:"message.info(content, [duration])"}),(0,_.jsx)("br",{}),(0,_.jsx)(a.Z.Text,{code:!0,children:"message.warning(content, [duration])"}),(0,_.jsx)("br",{}),(0,_.jsx)(a.Z.Text,{code:!0,children:"message.loading(content, [duration])"})]})]}),R=(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(a.Z.Title,{level:3,children:"\u6587\u4ef6\u8bfb\u53d6"}),(0,_.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:(0,_.jsx)(a.Z.Paragraph,{code:!0,copyable:!0,children:"const { XLSX } = Util;\nconst readExcel = (file, callbackWorkbook) => {\n    const reader = new FileReader();\n    reader.onload = function (e) {\n        const data = e.target.result;\n        const workbook = XLSX.read(data, { type: 'binary' });\n        callbackWorkbook(workbook)\n    };\n    reader.readAsBinaryString(file)\n}\n// \u5c06\u6307\u5b9a sheet, \u8f6c\u6362\u6210 JSON \u5bf9\u8c61\nconst getSheetJsonObj = (workbook, idx) => XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[idx]], {\n    defval: 'null'  //\u5355\u5143\u683c\u4e3a\u7a7a\u65f6\u7684\u9ed8\u8ba4\u503c\n});\nreturn new Promise((resolve, reject) => {\n    readExcel(inputData[0], workbook => {\n        try {\n            resolve(getSheetJsonObj(workbook, 0))\n        } catch (error) {\n            reject(error)\n        }\n    })\n})"})})]}),z=function(){return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(N.Z,{placement:"rightTop",content:U,title:null,trigger:"click",children:(0,_.jsx)(p.Z,{type:"link",children:"\u5e2e\u52a9\u6587\u6863"})}),(0,_.jsx)(N.Z,{placement:"rightTop",content:X,title:null,trigger:"click",children:(0,_.jsx)(p.Z,{type:"link",children:"\u5e38\u7528\u5de5\u5177"})}),(0,_.jsx)(N.Z,{placement:"rightTop",content:R,title:null,trigger:"click",children:(0,_.jsx)(p.Z,{type:"link",children:"\u6587\u4ef6\u8bfb\u53d6\u6837\u4f8b"})})]})},J=a.Z.Title,O=s.Z.Dragger,B=function(e){var n=e.state,t=e.setCheckInputData,a=n.inputData,g=n.setInputData,m=n.outputData,f=n.setOutputData,k=n.errorMsg,y=n.setErrorMsg,S=i.useState(),D=(0,l.Z)(S,2),N=D[0],U=D[1],X=i.useState(a),R=(0,l.Z)(X,2),z=R[0],J=R[1],B=function(e){g(e),f(""),y("")};t((function(){return!P.Z.isBlank(a)&&0!==a.length||(N?"\u8bf7\u4e0a\u4f20\u6587\u4ef6":"\u8bf7\u8f93\u5165\u6587\u672c")}));return(0,_.jsxs)(o.Z,{style:{marginTop:"20px"},children:[(0,_.jsxs)(d.Z,{span:7,children:[(0,_.jsxs)(h.Z,{children:[(0,_.jsx)(x.ZP.Group,{size:"small",optionType:"button",onChange:function(){var e=!N;U(e),J(a),B(!e||""!==z&&null!==z&&void 0!==z?z:[])},options:[{label:"\u6587\u672c",value:"0"},{label:"\u6587\u4ef6",value:"1"}],value:N?"1":"0"}),N?null:(0,_.jsx)(s.Z,{maxCount:1,beforeUpload:function(e){return C.Z.readAsText(e,g),!1},children:(0,_.jsx)(p.Z,{size:"small",icon:(0,_.jsx)(b.Z,{}),disabled:N,style:{marginLeft:"5px"},children:"\u5bfc\u5165"})})]}),N?(0,_.jsxs)(O,{name:"file",style:{marginTop:"5px"},multiple:!1,maxCount:3,fileList:a,beforeUpload:function(e,n){if(a.length>=3)return!1;for(var t=(0,r.Z)(a),l=0;l<n.length&&!(t.length+1>3);l++)t.push(n[l]);return B(t),s.Z.LIST_IGNORE},onRemove:function(e){var n=a.filter((function(n){return n.uid!==e.uid}));return B(n),!0},children:[(0,_.jsx)("p",{className:"ant-upload-drag-icon",children:(0,_.jsx)(T,{})}),(0,_.jsx)("p",{className:"ant-upload-text",children:"\u5355\u51fb\u6216\u62d6\u52a8\u6587\u4ef6\u5230\u6b64\u533a\u57df"}),(0,_.jsx)("p",{className:"ant-upload-hint",children:"\u652f\u6301\u6279\u91cf"})]}):(0,_.jsx)(u.Z.TextArea,{autoSize:{minRows:25,maxRows:40},disabled:N,style:{marginTop:"5px"},rows:30,placeholder:N?"\u5df2\u8f93\u5165\u6587\u4ef6":"\u5f85\u5904\u7406\u7684\u6587\u672c\u7247\u6bb5",value:N?"":a,onChange:function(e){B(e.target.value)}})]}),(0,_.jsx)(d.Z,{span:10,style:{marginLeft:"30px"},children:P.Z.isBlank(k)?P.Z.isBlank(m)?null:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Z.Z,{title:"\u8986\u76d6\u5f85\u5904\u7406\u8f93\u5165\u6846",children:(0,_.jsx)(p.Z,{type:"text",icon:(0,_.jsx)(v.Z,{}),onClick:function(){return g(m)},disabled:N})}),(0,_.jsx)(L.Z,{type:"text",onClick:function(){if(P.Z.copyToClipboard(m))return c.ZP.info("\u590d\u5236\u6210\u529f"),!0},size:"small"}),(0,_.jsx)(Z.Z,{title:"\u4e0b\u8f7d",children:(0,_.jsx)(w.Z,{style:{marginLeft:"8px"},onClick:function(){C.Z.download(m,"output.json")}})}),(0,_.jsx)("pre",{children:m})]}):(0,_.jsx)(j.Z,{message:k,type:"error"})})]})},E=function(e){return e.split("\n").map((function(e){return'"'.concat(e,'"')})).join(",")},F=function(){return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(J,{level:3,children:"\u7f16\u8f91\u6587\u672c"}),(0,_.jsx)(g.Z,{}),(0,_.jsx)(S.Z,{lang:D.b.TXT,manage:{buttons:[{name:"\u591a\u884c\u8f6c\u4e00\u884c",description:"\u591a\u884c\u5408\u5e76\u6210\u4e00\u884c",scriptContent:"const _INNER_ = ".concat(E.toString(),";return _INNER_(inputData);")},{name:"\u8f93\u51fa",description:"\u8f93\u51fa\u539f\u6570\u636e",scriptContent:"return inputData;"}],expandScriptButton:{name:"\u81ea\u5b9a\u4e49\u914d\u7f6e",description:"\u652f\u6301\u8f6c\u6362\u548c\u6dfb\u52a0\u81ea\u5b9a\u4e49\u914d\u7f6e",scriptContent:"return inputData;"},editorHelpRender:z},dataBlockRender:B})]})}}}]);