(self.webpackChunktoolkit=self.webpackChunktoolkit||[]).push([[51],{6945:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>b});var r=n(47313),c=n(72652),o=n(55291),a=n(28770),s=n(21739),u=n(16031),l=n.n(u),i=n(10658),h=n.n(i),p=n(52984),f=n.n(p),m=n(48737),d=n(23988),k=n(99884),D=n(46417);const I={_:l(),dayjs:h(),cryptoJS:f(),XLSX:m,message:o.ZP},g="converter-container";function y(t,e){return null===t||void 0===t?e:t}function v(t,e,n){return function(t,e,n){return new Function("inputData","inputObj","Util",t)(e,n,{...I})}(n,e,t?t(e):null)}function C(t,e,n){return new Promise(((r,c)=>{const o=t=>{return r((e=t)instanceof Object?JSON.stringify(e,null,2):y(e,""));var e},a=(t,e)=>console.error(e)&c(function(t,e){const n=e instanceof Object?y(e.message,""):e;return null===t||void 0===t?n:"".concat(t,": ").concat(n)}(t,e));let s=n,u="";for(let n=0;n<e.length;n++){const i=e[n],h=i.name,p=d.Z.isStr(i)?i:i.content;try{if(u=v(t,s,p),u instanceof Promise)return void u.then((a=>{n>=e.length-1?o(a):C(t,e.splice(n+1),a).then(r).catch(c)})).catch((t=>{a(h,t)}))}catch(l){return void a(h,l)}s=u}o(u)}))}I.UIHelper={createSchemaForm:t=>function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=s.createRoot(document.getElementById(g)),c=c=>{let{onSuccess:o,onError:s}=c;try{const c=t=>n.unmount(),u=t=>c()&s(t),l=t({resolve:t=>c()&o(t),reject:t=>c()&s(t)}),i=l instanceof Array?l:[l];return r.createElement(a.Z,{onCancel:()=>u("\u5df2\u53d6\u6d88"),onOk:()=>u("\u5df2\u53d6\u6d88"),footer:null,maskClosable:!0,...e,open:!0,key:g+"-modal"},r.createElement(r.Fragment,{},...i))}catch(u){s(u)}};return new Promise(((t,e)=>{try{n.render(r.createElement(c,{onSuccess:t,onError:e}))}catch(o){e(o)}}))}((e=>{const n=t(e)||{};return n.layoutType="From",(0,D.jsx)(k.Z,{...n})}))};class S{constructor(){this.checkInputData=null}setCheckInputData(t){this.checkInputData=t}onCheckInputData(t){return!this.checkInputData||this.checkInputData(t)}}const b=t=>{let{context:e,dataBlockRender:n,handleInputObj:o}=t;const[a,s]=r.useState(""),[u,l]=r.useState(""),[i,h]=r.useState(""),[p,f]=r.useState(!1),m=r.useMemo((()=>new S),[]);return e.setConvertHandler((t=>{p?console.warn("Conversion failed because loading"):(f(!0),setTimeout((()=>{const e=m.onCheckInputData(a);if(!0!==e)return l("")&h(e)&f(!1);const n=t=>l("")&h(t);C(o,t,a).then((t=>""===t?n("\u65e0\u6267\u884c\u7ed3\u679c"):l(t)&h(""))).catch(n).finally((()=>f(!1)))}),60))})),(0,D.jsx)(c.Z,{spinning:p,children:n({state:{inputData:a,setInputData:s,outputData:u,setOutputData:l,errorMsg:i,setErrorMsg:h},setCheckInputData:t=>m.setCheckInputData(t)})})}},42480:()=>{}}]);