(self.webpackChunktoolkit=self.webpackChunktoolkit||[]).push([[694],{7518:function(n,e,t){"use strict";t.d(e,{b:function(){return r}});var r={JSON:"json",TXT:"txt"}},1526:function(n,e,t){"use strict";t.d(e,{Z:function(){return te}});var r=t(1413),i=t(5671),o=t(3144),c=t(7313),a=t(9439),u=t(8197),s=t(9624),l=t(7222),d=t(9491),f=t(7762),h=function(n){return"devinx3.toolkit.".concat(n,"EditOnfig")},p=function(n){return"devinx3.toolkit.".concat(n,"EditCombination")},x=function(n){var e=localStorage.getItem(n);return e?JSON.parse(e):[]},v=function(n,e){localStorage.setItem(n,JSON.stringify(e))},g={editConfig:{list:function(n){return x(h(n))},store:function(n,e){return v(h(n),e)}},editCombination:{list:function(n){return x(p(n))},store:function(n,e){return v(p(n),e)}}},Z=t(7518),m=void 0,j=function(n){return g.editConfig.list(n)||[]},y=function(n){return g.editCombination.list(n)},C=function(){var n={};for(var e in Z.b){var t=Z.b[e];n[t]=j(t)}return n}(),b=function(){var n={};for(var e in Z.b)n[e]=y(e);return n}(),S=function(n,e){try{g.editConfig.store(n,e),C[n]=j(n)}catch(t){return console.log("storeEditConfig error",t),t.message}return!0},k=function(n,e){try{g.editCombination.store(n,e),b[n]=y(n)}catch(t){return console.log("storeEditCombination error",t),t.message}return!0},w=function(n,e){var t,r=(0,f.Z)(n);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.id===e)return i}}catch(o){r.e(o)}finally{r.f()}return null},P=function(n,e){var t,r=n(e),i=0,o=(0,f.Z)(r);try{for(o.s();!(t=o.n()).done;){var c=t.value;c.id>i&&(i=c.id)}}catch(a){o.e(a)}finally{o.f()}return i},T={listAllConfig:function(n){return C[n]=j(n),C[n]},queryConfigById:function(n,e){return w(C[n],e)},addConfig:function(n,e){return e.id=P(j,n)+1,C[n].push(e),S(n,C[n])},updateConfig:function(n,e){for(var t=C[n],r=0;r<t.length;r++)if(t[r].id===e.id)return t[r].name=e.name,t[r].description=e.description,t[r].scriptContent=e.scriptContent,S(n,t);return!1},deleteConfig:function(n,e){return T.batchDeleteConfig(n,[e])},batchDeleteConfig:function(n,e){if(!(e&&e.length&&e.length>0))return!0;for(var t=C[n],r=!1,i=0;i<t.length;i++)if(e.indexOf(t[i].id)>=0){var o=T.checkCombinationByConfig(n,[t[i].id]);if(!0!==o)return"\u5f53\u524d\u914d\u7f6e\u88ab\u7ec4\u5408 ["+o+"] \u5f15\u7528";t.splice(i,1),i--,r=!0}return r?S(n,t):"\u6570\u636e\u4e0d\u5b58\u5728, \u8bf7\u5237\u65b0\u9875\u9762"},listAllCombination:function(n){return b[n]=y(n),b[n]},queryCombinationById:function(n,e){return w(b[n],e)},checkCombinationByConfig:function(n,e){var t,r=(0,f.Z)(T.listAllCombination(n));try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.combination){var o,c=(0,f.Z)(i.combination);try{for(c.s();!(o=c.n()).done;){var a=o.value;if(e.indexOf(a)>=0)return i.name||"-"}}catch(u){c.e(u)}finally{c.f()}}}}catch(u){r.e(u)}finally{r.f()}return!0},addCombination:function(n,e){var t=b[n];return e.id=P(y,n)+1,t.push(e),k(n,t)},updateCombination:function(n,e){for(var t=b[n],r=0;r<t.length;r++)if(t[r].id===e.id)return t[r].name=e.name,t[r].description=e.description,t[r].combination=e.combination,k(n,t);return!1},deleteCombination:function(n,e){return T.batchDeleteCombination(n,[e])},batchDeleteCombination:function(n,e){if(!(e&&e.length&&e.length>0))return!0;for(var t=!1,r=b[n],i=0;i<r.length;i++)e.indexOf(r[i].id)>=0&&(r.splice(i,1),i--,t=!0);return!!t&&k(n,r)}},D=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return new Promise((function(e,r){var i=!1;try{i=n.apply(m,t)}catch(o){r(o.message)}!0===i?e.apply(m,t):r(i)}))},B=T,I=t(7978),O=t(5291),A=t(5900),H=t(685),F=t(7258),R=t(5705),E=t(9180),L=t(1347),M=t(4165),J=t(5861),N=(t(8157),t.p+"static/media/dayjs.b713e7d32170b7af60d1.dts"),U=t.p+"static/media/cryptoJS.99b46c4cc62155cf428a.dts",z=t.p+"static/media/xlsx.e28bf89ddd68832c813d.dts",V=new(function(){function n(){(0,i.Z)(this,n),this.dataSource={}}return(0,o.Z)(n,[{key:"has",value:function(n){return n in this.dataSource}},{key:"get",value:function(n){return this.dataSource[n]}},{key:"set",value:function(n,e){this.dataSource[n]=e}}]),n}()),X=function(n,e,t){n.languages.typescript.javascriptDefaults.addExtraLib(e,t),n.editor.createModel(e,"typescript",n.Uri.parse(t))},q=[{name:"dayjs",path:N},{name:"cryptoJS",path:U},{name:"xlsx",path:z}];var _=function(n){if(n){var e=n.languages.typescript.javascriptDefaults.getExtraLibs()||{};Promise.all(q.map((function(n){return function(n){var e=n.name,t={name:e};if(V.has(e))return t.content=V.get(e),Promise.resolve(t);var r=function(){var e=(0,J.Z)((0,M.Z)().mark((function e(){var r;return(0,M.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n.path);case 2:return r=e.sent,e.next=5,r.text();case 5:return t.content=e.sent,e.abrupt("return",t.content?t:null);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r()}(n)}))).then((function(t){t.filter((function(n){return!!n})).forEach((function(t){V.set(t.name,t.content);var r="ts:web/".concat(t.name,"/index.d.ts");if(!(r in e)){var i="declare module '".concat(t.name,"' { ").concat(t.content," }");X(n,i,r)}}));var r="ts:inner/converter.d.ts";r in e||X(n,'declare const inputData: (string | Object | File[]);\ndeclare const inputObj: (Object | null)\ndeclare const Util: ({\n    _: object,\n    dayjs: typeof import("dayjs"),\n    cryptoJS: typeof import("cryptoJS"),\n    XLSX: typeof import("xlsx"),\n    message: {\n        info(content: string, duration?: number): void;\n        success(content: string, duration?: number): void;\n        error(content: string, duration?: number): void;\n        warning(content: string, duration?: number): void;\n        loading(content: string, duration?: number): void;\n    }\n});',r)})).catch((function(n){return console.error("load extraLibs error",n)}))}},K=t(6417),G=function(n){var e=n.value,t=n.onChange,r=n.editorHelpRender,i=c.useState(!0),o=(0,a.Z)(i,2),u=o[0],s=o[1];return(0,K.jsxs)(K.Fragment,{children:[r&&r(),(0,K.jsx)("br",{}),(0,K.jsx)(R.Z,{style:{marginTop:"5px",marginBottom:"13px"},children:(0,K.jsx)(E.ZP.Group,{size:"small",optionType:"button",onChange:function(){return s(!u)},options:[{label:"monaco",value:"1"},{label:"input",value:"0"}],value:u?"1":"0"})}),u?(0,K.jsx)(L.ZP,{height:"90%",language:"javascript",theme:"vs-dark",value:e,onChange:t,beforeMount:_}):(0,K.jsx)(H.Z.TextArea,{placeholder:"\u8bf7\u8f93\u5165\u811a\u672c",rows:8,value:e,onChange:function(n){return t(n.target.value)}})]})},$=t(2019),Q=B.addConfig,W=B.updateConfig,Y=B.deleteConfig,nn=I.Z.Text,en=function(n){var e=n.lang,t=n.config,r=n.scriptContent,i=n.onAddSuccess,o=t.name,u=t.description||o,s=c.useState(),l=(0,a.Z)(s,2),f=l[0],h=l[1],p=c.useState(),x=(0,a.Z)(p,2),v=x[0],g=x[1];return(0,K.jsx)(A.Z,{icon:null,cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",onConfirm:function(){if(!r)return O.ZP.warn("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),!1;D(Q,e,{name:f||o,description:v||f||u,scriptContent:r}).then((function(){h(null),g(null),O.ZP.success("\u6dfb\u52a0\u914d\u7f6e\u6210\u529f"),i()})).catch((function(n){return O.ZP.error("\u6dfb\u52a0\u914d\u7f6e\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+n)}))},title:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(H.Z,{addonBefore:"\u529f\u80fd\u540d\u79f0",placeholder:o,value:f,onChange:function(n){return h(n.target.value)}}),(0,K.jsx)(H.Z,{style:{marginTop:"3px"},addonBefore:"\u529f\u80fd\u4f5c\u7528",placeholder:u,value:v,onChange:function(n){return g(n.target.value)}})]}),children:(0,K.jsx)(d.Z,{children:"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u914d\u7f6e"})})},tn=function(n){var e=n.lang,t=n.context,r=n.config,i=n.refreshScript,o=n.editorHelpRender,f=c.useState(!1),h=(0,a.Z)(f,2),p=h[0],x=h[1],v=c.useState(r.scriptContent),g=(0,a.Z)(v,2),Z=g[0],m=g[1];return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(l.Z,{title:r.description,children:(0,K.jsx)(d.Z,{onClick:function(){return x(!0)},children:r.name})}),(0,K.jsx)(F.Z,{title:r.name,open:p,width:"75%",onClose:function(){x(!1)},footer:(0,K.jsx)(u.Z,{justify:"end",children:(0,K.jsxs)(R.Z,{children:[(0,K.jsx)(s.Z,{children:(0,K.jsx)(en,{lang:e,config:r,scriptContent:Z,onAddSuccess:function(){x(!1),i()}},"add")}),(0,K.jsx)(s.Z,{children:(0,K.jsx)(d.Z,{type:"primary",onClick:function(){Z?(t.onConvert([Z]),x(!1)):O.ZP.warn("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a")},children:"\u8f6c\u6362"},"convert")})]})}),children:(0,K.jsx)(G,{value:Z,onChange:m,editorHelpRender:o})})]})},rn=function(n){var e=n.lang,t=n.config,r=n.visible,i=n.setVisible,o=n.editorHelpRender,l=n.refreshScript,f=c.useState(t.name),h=(0,a.Z)(f,2),p=h[0],x=h[1],v=c.useState(t.description),g=(0,a.Z)(v,2),Z=g[0],m=g[1],j=c.useState(t.scriptContent),y=(0,a.Z)(j,2),C=y[0],b=y[1],S=function(){return i(!1)};return(0,K.jsxs)(F.Z,{open:r,width:"75%",onCancel:S,title:p!==t.name||Z!==t.description||C!==t.scriptContent?(0,K.jsx)(nn,{style:{color:"#1890ff"},strong:!0,children:"\u7f16\u8f91\u914d\u7f6e *"}):(0,K.jsx)(nn,{children:"\u7f16\u8f91\u914d\u7f6e"}),onClose:S,footer:(0,K.jsx)(u.Z,{justify:"end",children:(0,K.jsxs)(R.Z,{children:[(0,K.jsx)(s.Z,{children:(0,K.jsx)(d.Z,{onClick:function(){x(t.name),m(t.description),b(t.scriptContent)},children:"\u91cd\u7f6e"},"reset")}),(0,K.jsx)(s.Z,{children:(0,K.jsx)(d.Z,{onClick:function(){D(Y,e,t.id).then((function(){O.ZP.success("\u5220\u9664\u914d\u7f6e\u6210\u529f"),S(),l()})).catch((function(n){return O.ZP.error("\u5220\u9664\u914d\u7f6e\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+n)}))},children:"\u5220\u9664\u914d\u7f6e"},"remove")}),(0,K.jsx)(s.Z,{children:(0,K.jsx)(d.Z,{type:"primary",onClick:function(){if(p)if(C){var n={id:t.id,name:p,description:Z||p,scriptContent:C};D(W,e,n).then((function(){O.ZP.success("\u66f4\u65b0\u914d\u7f6e\u6210\u529f"),S(),l()})).catch((function(n){return console.log(n)&O.ZP.error("\u66f4\u65b0\u914d\u7f6e\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+n)}))}else O.ZP.error("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a");else O.ZP.error("\u529f\u80fd\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a")},children:"\u66f4\u65b0\u914d\u7f6e"},"update")})]})}),children:[(0,K.jsx)(H.Z,{addonBefore:"\u529f\u80fd\u540d\u79f0",value:p,onChange:function(n){return x(n.target.value)}}),(0,K.jsx)(H.Z,{style:{marginTop:"3px"},addonBefore:"\u529f\u80fd\u4f5c\u7528",value:Z,onChange:function(n){return m(n.target.value)}}),(0,K.jsx)(G,{lang:e,value:C,onChange:b,editorHelpRender:o})]})},on=function(n){var e=n.lang,t=n.config,r=n.handleConvert,i=n.editorHelpRender,o=n.refreshScript,u=c.useState(!1),s=(0,a.Z)(u,2),f=s[0],h=s[1];return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(l.Z,{title:t.description,children:(0,K.jsx)(d.Z,{type:"dashed",onClick:function(n){return r(t.scriptContent)},children:t.name})}),(0,K.jsx)(l.Z,{title:"\u7f16\u8f91",children:(0,K.jsx)(d.Z,{shape:"circle",type:"text",onClick:function(n){return h(!0)},icon:(0,K.jsx)($.Z,{}),size:"small"})}),(0,K.jsx)(rn,{lang:e,config:t,visible:f,setVisible:h,editorHelpRender:i,refreshScript:o})]})},cn=t(2984),an=t.n(cn),un=new(function(){function n(){(0,i.Z)(this,n),this.featurePrefix="devinx3",this.verionPrefix="ver",this.fixVersion="000",this.fixSecret="ver000"}return(0,o.Z)(n,[{key:"encrypt",value:function(n,e){return an().AES.encrypt(n,e).toString()}},{key:"dencrypt",value:function(n,e){return an().AES.decrypt(n,e).toString(an().enc.Utf8)}},{key:"convertSecret",value:function(n){return n>=100&&n<=999?this.verionPrefix+n:this.fixSecret}},{key:"getFeatureSuffix",value:function(n){return n===this.fixSecret?"S":"l"}},{key:"getFeatureSecretIndex",value:function(n){if(n<100)return-1;for(var e=n-10-10,t=[],r=[17,27,23,3,19,11],i=0;i<6;i++)t.push(10+(e*r[i]/30^0));return t}},{key:"addSecret",value:function(n,e,t){return n.slice(0,e)+t+n.slice(e)}},{key:"removeSecret",value:function(n,e){return n.slice(0,e)+n.slice(e+1)}},{key:"convertExportData",value:function(n,e){var t=this.convertSecret(e),r=this.encrypt(n,t);r.length<100&&(t=this.fixSecret,r=this.encrypt(n,t));var i=this.featurePrefix,o=r.length,c=this.getFeatureSuffix(t);if(t===this.fixSecret)return i+o+c+r;for(var a=this.getFeatureSecretIndex(o),u=r,s=a.length-1;s>=0;s--)u=this.addSecret(u,a[s],t[s]);return i+o+c+u}},{key:"convertImportData",value:function(n){var e=n.slice(0,this.featurePrefix.length);if(e!==this.featurePrefix)throw new Error("\u5339\u914d\u7279\u5f81\u524d\u7f00\u5f02\u5e38");var t=e.length+10,r="l",i=n.indexOf(r);if((i<0||i>=t)&&(r="S",(i=n.indexOf(r))<0||i>=t))throw new Error("\u5339\u914d\u7279\u5f81\u540e\u7f00\u5f02\u5e38");var o=Number(n.slice(e.length,i));if(!o)throw new Error("\u5339\u914d\u6570\u636e\u957f\u5ea6\u5f02\u5e38");var c=this.getFeatureSecretIndex(o),a=n.slice(i+1);if(-1===c)return this.encrypt(n,a);for(var u=a,s="",l=0;l<c.length;l++)s+=u[c[l]],u=this.removeSecret(u,c[l]);return this.dencrypt(u,s)}}]),n}()),sn=function(n){var e=[];return n&&n.forEach((function(t,i){var o=(0,r.Z)({},t);o.id=-10-10*(n.length-i),e.push(o)})),e},ln=function(n){return n.id<=-10},dn=function(n){return n<=-10},fn=t(3433),hn=t(870),pn=t(2346),xn=t(2697),vn=t(1656),gn=t(627),Zn=t(7515),mn=t(4585),jn=t(6407),yn=t(445),Cn=t(3036),bn=t(3988),Sn=t(658),kn=t.n(Sn),wn=B.addConfig,Pn=B.batchDeleteConfig,Tn=function(n){var e=n.lang,t=n.dataSource,i=n.refreshScript,o=c.useState(!1),u=(0,a.Z)(o,2),s=u[0],h=u[1],p=c.useState([]),x=(0,a.Z)(p,2),v=x[0],g=x[1],Z=c.useState(!1),m=(0,a.Z)(Z,2),j=m[0],y=m[1],C=c.useState(!1),b=(0,a.Z)(C,2),S=b[0],k=b[1],w=c.useState(!1),P=(0,a.Z)(w,2),T=P[0],B=P[1],A=c.useState(),H=(0,a.Z)(A,2),F=H[0],R=H[1],E=function(n){var e=n.target.value,r=(0,fn.Z)(v),i=r.indexOf(e);n.target.checked?i<0&&r.push(e):i>=0&&r.splice(i,1),g(r),y(!!r.length&&r.length<t.length),k(r.length===t.length)};return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(d.Z,{type:"link",onClick:function(){return h(!0)},children:"\u914d\u7f6e\u7ba1\u7406"}),(0,K.jsx)(hn.Z,{title:"\u914d\u7f6e\u7ba1\u7406",open:s,footer:null,onCancel:function(){return h(!1)},children:(0,K.jsx)(pn.ZP,{itemLayout:"horizontal",dataSource:t,rowKey:"id",header:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(xn.Z,{indeterminate:j,disabled:0===t.length,checked:S,onChange:function(n){if(n.target.checked){var e,r=[],i=(0,f.Z)(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;r.push(o.id)}}catch(c){i.e(c)}finally{i.f()}g(r)}else g([]);y(!1),k(n.target.checked)},children:"\u5168\u9009"}),(0,K.jsx)(d.Z,{type:"text",disabled:0===t.length,icon:(0,K.jsx)(Zn.Z,{}),onClick:function(){0!==v.length?D(Pn,e,v).then((function(){O.ZP.success("\u5220\u9664\u6210\u529f"),g([]),k(!1),y(!1),i()})).catch((function(n){return O.ZP.error("\u5220\u9664\u5931\u8d25, \u539f\u56e0\u662f: "+n)})):O.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u9700\u5220\u9664")},children:"\u5220\u9664"}),(0,K.jsx)(d.Z,{type:"text",disabled:0===t.length,icon:(0,K.jsx)(mn.Z,{}),onClick:function(){if(0!==v.length){var n,e=[],i=(0,f.Z)(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,c=(0,r.Z)({},o);delete c.id,e.push(c)}}catch(s){i.e(s)}finally{i.f()}var a=un.convertExportData(JSON.stringify(t),101),u="config"+kn()().format("MMDDHHmmss");Cn.Z.download(a,u)}else O.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u9700\u5bfc\u51fa")},children:"\u5bfc\u51fa"}),(0,K.jsx)(l.Z,{title:"\u4e0d\u652f\u6301\u5bfc\u5165",children:(0,K.jsx)(d.Z,{type:"text",disabled:0===t.length,icon:(0,K.jsx)(jn.Z,{}),onClick:function(){0!==v.length?bn.Z.copyToClipboard(JSON.stringify(t))&&O.ZP.success("\u590d\u5236\u6210\u529f"):O.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u6cd5\u590d\u5236")},children:"\u590d\u5236JSON\u914d\u7f6e"})})]}),footer:(0,K.jsx)(vn.Z,{maxCount:1,beforeUpload:function(n){return function(n){return Cn.Z.readAsText(n,(function(n){var t=null;try{t=JSON.parse(un.convertImportData(n))}catch(c){return void O.ZP.error("\u5bfc\u5165\u5931\u8d25, \u5f02\u5e38\u6d88\u606f: "+c.message)}if(t&&t.length&&t.length>0){var r=0,o="";Promise.all(t.map(function(){var n=(0,J.Z)((0,M.Z)().mark((function n(t){return(0,M.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.name=t.name+"(by impory)",n.prev=1,n.next=4,D(wn,e,t);case 4:return n.abrupt("return",r++);case 7:return n.prev=7,n.t0=n.catch(1),n.abrupt("return",o=o+n.t0+";");case 10:case"end":return n.stop()}}),n,null,[[1,7]])})));return function(e){return n.apply(this,arguments)}}())).finally((function(){0!==r?(r===t.length?O.ZP.success("\u5168\u90e8\u5bfc\u5165\u6210\u529f"):O.ZP.warn("\u90e8\u5206\u5bfc\u5165\u6210\u529f, \u5f02\u5e38\u4e2a\u6570"+(t.length-r)+", \u5f02\u5e38\u6d88\u606f: "+o),i()):O.ZP.error("\u5168\u90e8\u5bfc\u5165\u5931\u8d25, \u5f02\u5e38\u6d88\u606f: ")}))}})),!1}(n)},children:(0,K.jsx)(d.Z,{icon:(0,K.jsx)(yn.Z,{}),children:"\u5bfc\u5165"})}),renderItem:function(n){return(0,K.jsx)(pn.ZP.Item,{actions:[(0,K.jsx)(d.Z,{type:"link",onClick:function(){return e=n.scriptContent,R(e),void B(!0);var e},children:"\u811a\u672c"},"list-item-srcipt")],children:(0,K.jsx)(gn.Z,{loading:!1,children:(0,K.jsx)(pn.ZP.Item.Meta,{avatar:(0,K.jsx)(xn.Z,{value:n.id,checked:v.indexOf(n.id)>=0,onChange:E}),title:n.name,description:n.description})})})}})}),(0,K.jsx)(hn.Z,{title:"\u811a\u672c\u5185\u5bb9",open:T,width:"60%",footer:null,onCancel:function(){R(null),B(!1)},children:(0,K.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:(0,K.jsx)(I.Z.Paragraph,{code:!0,copyable:!0,children:F})})})]})},Dn=function(n){var e=n.lang,t=n.context,r=n.basicButtons,i=n.expandAddButton,o=n.editorHelpRender,c=n.refreshManage;r=sn(r);var a=i?function(n){return B.listAllConfig(n)}(e):[],f=function(n){return t.onConvert([n])};return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)(u.Z,{style:{marginTop:"10px"},children:[r.map((function(n,e){return(0,K.jsx)(s.Z,{style:{marginLeft:"10px"},children:(0,K.jsx)(l.Z,{title:n.description,children:(0,K.jsx)(d.Z,{onClick:function(){return f(n.scriptContent)},children:n.name})})},e)})),i?(0,K.jsx)(s.Z,{style:{marginLeft:"10px"},children:(0,K.jsx)(tn,{lang:e,context:t,config:i,editorHelpRender:o,refreshScript:c})}):null]}),a.length>0&&(0,K.jsxs)(u.Z,{style:{marginTop:"10px"},children:[(0,K.jsx)(Tn,{lang:e,dataSource:a,refreshScript:c}),a.map((function(n,t){return(0,K.jsx)(s.Z,{style:{marginLeft:"10px"},children:(0,K.jsx)(on,{lang:e,config:n,editorHelpRender:o,refreshScript:c,handleConvert:f})},t)}))]})]})},Bn=t(6842),In=t(7966),On=t(2138),An=B.addCombination,Hn=B.updateCombination,Fn=B.deleteCombination,Rn=I.Z.Text,En="\u81ea\u5b9a\u4e49\u7ec4\u5408",Ln=function(n){var e=n.lang,t=n.combinationConfig,r=n.refreshManage,i=c.useState(),o=(0,a.Z)(i,2),u=o[0],s=o[1],l=c.useState(),f=(0,a.Z)(l,2),h=f[0],p=f[1];t.name=t.name||En,t.description=t.description||t.name;return(0,K.jsx)(A.Z,{icon:null,cancelText:"\u53d6\u6d88",okText:"\u65b0\u5efa",onConfirm:function(){var n={};n.name=u||En,n.description=h||n.name,n.combination=[],D(An,e,n).then((function(){O.ZP.success("\u521b\u5efa\u6210\u529f"),r()})).catch((function(n){return O.ZP.warn("\u521b\u5efa\u5931\u8d25, \u539f\u56e0\u662f"+n)}))},placement:"right",title:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(I.Z.Title,{level:5,children:"\u65b0\u5efa\u7ec4\u5408"}),(0,K.jsx)(H.Z,{addonBefore:"\u7ec4\u5408\u540d\u79f0",placeholder:t.name,value:u,onChange:function(n){return s(n.target.value)}}),(0,K.jsx)(H.Z,{style:{marginTop:"3px"},addonBefore:"\u7ec4\u5408\u4f5c\u7528",placeholder:t.description,value:h,onChange:function(n){return p(n.target.value)}})]}),children:(0,K.jsx)(d.Z,{style:{marginLeft:"10px"},shape:"circle",type:"text",icon:(0,K.jsx)(On.Z,{}),size:"small"})})},Mn=function(n){var e=n.visible,t=n.setVisible,i=n.handleAddConfig,o=n.configDataSource,u=c.useState(),s=(0,a.Z)(u,2),d=s[0],h=s[1],p=[{title:"\u540d\u79f0",dataIndex:"name",render:function(n,e){return(0,K.jsx)(l.Z,{title:e.description,children:n})}},{title:"\u7c7b\u522b",dataIndex:"costom",render:function(n){return 1===n?(0,K.jsx)(I.Z.Text,{type:"warning",children:"\u81ea\u5b9a\u4e49"}):(0,K.jsx)(I.Z.Text,{type:"success",children:"\u7cfb\u7edf"})}}],x=function(){t(!1),h(void 0)},v={type:"radio",onChange:function(n,e){h(Number(n))},selectedRowKeys:[d]};return(0,K.jsx)(hn.Z,{title:"\u914d\u7f6e\u9009\u62e9",open:e,cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",onCancel:x,onOk:function(){i(d),x()},children:(0,K.jsx)(Bn.Z,{rowSelection:(0,r.Z)({},v),rowKey:"id",columns:p,dataSource:function(){var n,e=[],t=(0,f.Z)(o);try{for(t.s();!(n=t.n()).done;){var r=n.value;e.push({id:r.id,name:r.name,description:r.description,costom:ln(r)?0:1})}}catch(i){t.e(i)}finally{t.f()}return e}(),pagination:!1})})},Jn=function(n){var e=n.lang,t=n.combinationConfig,i=n.refreshManage,o=n.handleConvert,h=n.configDataSource,p=c.useState(!1),x=(0,a.Z)(p,2),v=x[0],g=x[1],Z=c.useState(!1),m=(0,a.Z)(Z,2),j=m[0],y=m[1],C=c.useState(!1),b=(0,a.Z)(C,2),S=b[0],k=b[1],w=c.useState(t.name),P=(0,a.Z)(w,2),T=P[0],I=P[1],A=c.useState(t.description),E=(0,a.Z)(A,2),L=E[0],M=E[1],J=c.useState((0,fn.Z)(t.combination)),N=(0,a.Z)(J,2),U=N[0],z=N[1],V=function(n){var e,t={},i=(0,f.Z)(n);try{for(i.s();!(e=i.n()).done;){var o=e.value;t[o.id]=(0,r.Z)({},o)}}catch(c){i.e(c)}finally{i.f()}return t}(h),X=U.map((function(n,e){var t=V[n]||{};return t.index=e,t})),q=function(){g(!1)},_=function(n){k(n),y(!0)};return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(l.Z,{style:{marginLeft:"15px"},title:t.description,children:(0,K.jsx)(d.Z,{type:"dashed",onClick:function(n){return o(t.combination)},children:t.name})}),(0,K.jsx)(l.Z,{title:"\u7f16\u8f91",children:(0,K.jsx)(d.Z,{shape:"circle",type:"text",onClick:function(n){return g(!0)},icon:(0,K.jsx)($.Z,{}),size:"small"})}),(0,K.jsxs)(F.Z,{open:v,onCancel:q,title:function(){if(U.length!==t.combination.length)return!0;for(var n=0;n++;n<=U.length)if(U[n]!==t.combination[n])return!0;return T!==t.name||L!==t.description}()?(0,K.jsx)(Rn,{style:{color:"#1890ff"},strong:!0,children:"\u7f16\u8f91\u7ec4\u5408 *"}):(0,K.jsx)(Rn,{children:"\u7f16\u8f91\u7ec4\u5408"}),onClose:q,footer:(0,K.jsx)(u.Z,{justify:"end",children:(0,K.jsxs)(R.Z,{children:[(0,K.jsx)(s.Z,{children:(0,K.jsx)(d.Z,{onClick:function(){I(t.name),M(t.description),z((0,fn.Z)(t.combination))},children:"\u91cd\u7f6e"},"reset")}),(0,K.jsx)(s.Z,{children:(0,K.jsx)(d.Z,{onClick:function(){D(Fn,e,t.id).then((function(){O.ZP.success("\u5220\u9664\u6210\u529f"),g(!1),i()})).catch((function(n){return O.ZP.success("\u5220\u9664\u5931\u8d25, \u539f\u56e0\u662f"+n)}))},children:"\u5220\u9664\u7ec4\u5408"},"delete")}),(0,K.jsx)(s.Z,{children:(0,K.jsx)(d.Z,{type:"primary",onClick:function(){if(0!==U.length)if(T){var n,r=(0,f.Z)(U);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(!ln({id:o})&&!B.queryConfigById(e,o))return void O.ZP.warn("\u811a\u672c\u914d\u7f6e\u4e0d\u5b58\u5728, \u8bf7\u5237\u65b0\u9875\u9762")}}catch(a){r.e(a)}finally{r.f()}var c={id:t.id,name:T,description:L||T,combination:U};D(Hn,e,c).then((function(){O.ZP.success("\u4fdd\u5b58\u6210\u529f"),g(!1),i()})).catch((function(n){return O.ZP.error("\u4fdd\u5b58\u5931\u8d25, \u539f\u56e0\u662f: "+n)}))}else O.ZP.warn("\u8bf7\u7ef4\u62a4\u7ec4\u5408\u540d\u79f0");else O.ZP.warn("\u8bf7\u5148\u7ef4\u62a4\u8282\u70b9")},children:"\u4fdd\u5b58\u7ec4\u5408"})})]})}),children:[(0,K.jsx)(H.Z,{addonBefore:"\u7ec4\u5408\u540d\u79f0",value:T,onChange:function(n){return I(n.target.value)}}),(0,K.jsx)(H.Z,{style:{marginTop:"5px",marginBottom:"15px"},addonBefore:"\u7ec4\u5408\u4f5c\u7528",value:L,onChange:function(n){return M(n.target.value)}}),(0,K.jsxs)(In.Z,{mode:"left",children:[0===X.length&&(0,K.jsx)(In.Z.Item,{color:"gray",children:(0,K.jsx)(l.Z,{title:"\u6dfb\u52a0",children:(0,K.jsx)(d.Z,{shape:"circle",type:"text",icon:(0,K.jsx)(On.Z,{}),onClick:function(n){return _(-1)}})})},0),X.map((function(n,e){return(0,K.jsxs)(In.Z.Item,{color:n.id>0?"#faad14":"#52c41a",children:[(0,K.jsx)(l.Z,{title:"\u6dfb\u52a0",children:(0,K.jsx)(d.Z,{shape:"circle",type:"text",icon:(0,K.jsx)(On.Z,{}),onClick:function(n){return _(e)}})}),(0,K.jsx)(l.Z,{title:"\u5220\u9664",children:(0,K.jsx)(d.Z,{shape:"circle",type:"text",icon:(0,K.jsx)(Zn.Z,{}),onClick:function(n){return function(n){U.splice(n,1),z((0,fn.Z)(U))}(e)}})}),(0,K.jsx)(l.Z,{title:n.description,children:n.name})]},e)}))]})]}),(0,K.jsx)(Mn,{visible:j,setVisible:y,handleAddConfig:function(n){if(j){for(var e=[],t=0;t<U.length;t++)e.push(U[t]),t===S&&e.push(n);-1===S&&e.push(n),z(e)}},configDataSource:h})]})},Nn=function(){return(0,K.jsx)(d.Z,{type:"link",disabled:!0,children:"\u7ec4\u5408\u7ba1\u7406"})},Un=function(n){var e=n.lang,t=n.context,r=n.basicButtons,i=n.expandAddButton,o=function(n){return B.listAllCombination(n)||[]}(e)||[],l=c.useState(!1),d=(0,a.Z)(l,2),h=d[0],p=d[1],x=function(n){return B.listAllConfig(n)||[]}(e);if(0===x.length)return(0,K.jsx)(K.Fragment,{});r=sn(r);var v=function(){return p(!h)},g=function(n){if(n&&0!==n.length){var i=null,o=n.map((function(n){var t=function(n,e,t){if(dn(t)){var r,i=(0,f.Z)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(t===o.id)return o}}catch(c){i.e(c)}finally{i.f()}}return B.queryConfigById(n,t)}(e,r,n);return t?t.scriptContent?{name:t.name,content:t.scriptContent}:(i="\u811a\u672c\u5185\u5bb9\u4e3a\u7a7a",null):(i="\u914d\u7f6e\u4e0d\u5b58\u5728",null)}));if(!i)return t.onConvert(o);O.ZP.error(i)}else O.ZP.error("\u4e0d\u5b58\u5728\u4efb\u4f55\u914d\u7f6e")},Z=[].concat((0,fn.Z)(r),(0,fn.Z)(x));return(0,K.jsxs)(u.Z,{style:{marginTop:"10px"},children:[(0,K.jsxs)(s.Z,{children:[(0,K.jsx)(Nn,{}),(0,K.jsx)(Ln,{lang:e,combinationConfig:i,refreshManage:v})]}),o.map((function(n,t){return(0,K.jsx)(s.Z,{style:{marginLeft:"10px"},children:(0,K.jsx)(Jn,{lang:e,combinationConfig:n,refreshManage:v,configDataSource:Z,handleConvert:g})},t)}))]})},zn=function(n){var e=n.lang,t=n.context,r=n.buttons,i=void 0===r?{}:r,o=n.expandScriptButton,u=void 0===o?{}:o,s=n.expandCombinationButton,l=void 0===s?{}:s,d=n.editorHelpRender,f=c.useState(!1),h=(0,a.Z)(f,2),p=h[0],x=h[1];return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(Dn,{lang:e,context:t,basicButtons:i,expandAddButton:u,editorHelpRender:d,refreshManage:function(){return x(!p)}}),(0,K.jsx)(Un,{lang:e,context:t,basicButtons:i,expandAddButton:l})]})},Vn=t(2652),Xn=t(6031),qn=t.n(Xn),_n=t(3750),Kn={_:qn(),dayjs:kn(),cryptoJS:an(),XLSX:_n,message:O.ZP};function Gn(n,e){return null===n||void 0===n?e:n}function $n(n,e,t){return function(n,e,t){return new Function("inputData","inputObj","Util",n)(e,t,(0,r.Z)({},Kn))}(t,e,n?n(e):null)}function Qn(n,e,t){return new Promise((function(r,i){for(var o=function(n){return r((e=n)instanceof Object?JSON.stringify(e,null,2):Gn(e,""));var e},c=function(n,e){return console.error(e)&i(function(n,e){var t=e instanceof Object?Gn(e.message,""):e;return null===n||void 0===n?t:"".concat(n,": ").concat(t)}(n,e))},a=t,u="",s=function(t){var s=e[t],l=s.name,d=bn.Z.isStr(s)?s:s.content;try{if((u=$n(n,a,d))instanceof Promise)return u.then((function(c){t>=e.length-1?o(c):Qn(n,e.splice(t+1),c).then(r).catch(i)})).catch((function(n){c(l,n)})),{v:void 0}}catch(f){return c(l,f),{v:void 0}}a=u},l=0;l<e.length;l++){var d=s(l);if("object"===typeof d)return d.v}o(u)}))}var Wn=function(){function n(){(0,i.Z)(this,n),this.checkInputData=null}return(0,o.Z)(n,[{key:"setCheckInputData",value:function(n){this.checkInputData=n}},{key:"onCheckInputData",value:function(n){return!this.checkInputData||this.checkInputData(n)}}]),n}(),Yn=function(n){var e=n.context,t=n.dataBlockRender,r=n.handleInputObj,i=c.useState(""),o=(0,a.Z)(i,2),u=o[0],s=o[1],l=c.useState(""),d=(0,a.Z)(l,2),f=d[0],h=d[1],p=c.useState(""),x=(0,a.Z)(p,2),v=x[0],g=x[1],Z=c.useState(!1),m=(0,a.Z)(Z,2),j=m[0],y=m[1],C=c.useMemo((function(){return new Wn}),[]);return e.setConvertHandler((function(n){j?console.warn("Conversion failed because loading"):(y(!0),setTimeout((function(){var e=C.onCheckInputData(u);if(!0!==e)return h("")&g(e)&y(!1);var t=function(n){return h("")&g(n)};Qn(r,n,u).then((function(n){return""===n?t("\u65e0\u6267\u884c\u7ed3\u679c"):h(n)&g("")})).catch(t).finally((function(){return y(!1)}))}),60))})),(0,K.jsx)(Vn.Z,{spinning:j,children:t({state:{inputData:u,setInputData:s,outputData:f,setOutputData:h,errorMsg:v,setErrorMsg:g},setCheckInputData:function(n){return C.setCheckInputData(n)}})})},ne=function(){function n(){(0,i.Z)(this,n),this.convertHandler=null}return(0,o.Z)(n,[{key:"setConvertHandler",value:function(n){this.convertHandler=n}},{key:"hasConvertHandler",value:function(){return!!this.convertHandler}},{key:"onConvert",value:function(n){if(this.convertHandler)return this.convertHandler(n);console.warn("No convert handler")}}]),n}(),ee={};ee[Z.b.JSON]=function(n){return n instanceof Object?n:JSON.parse(n)};var te=function(n){var e=n.lang,t=void 0===e?"txt":e,i=n.manage,o=n.handleInputObj,a=n.dataBlockRender,u=c.useMemo((function(){return new ne}),[]),s=(0,r.Z)((0,r.Z)({lang:t},i),{},{context:u}),l={context:u,dataBlockRender:a,handleInputObj:o||ee[t]};return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(zn,(0,r.Z)({},s)),(0,K.jsx)(Yn,(0,r.Z)({},l))]})}},571:function(n,e,t){"use strict";var r=t(1413),i=t(9439),o=t(7313),c=t(7222),a=t(9491),u=t(3681),s=t(6407),l=t(7534),d=t(6417);e.Z=function(n){var e=o.useState(!1),t=(0,i.Z)(e,2),f=t[0],h=t[1],p=l.Z.omit(n,"tipTitle");return(0,d.jsx)(c.Z,{title:n.tipTitle||"\u590d\u5236",children:(0,d.jsx)(a.Z,(0,r.Z)((0,r.Z)({},p),{},{onClick:function(e){if(!f&&n.onClick){var t=n.onClick(e);return!0===t&&h(!0),t}},icon:f?(0,d.jsx)(u.Z,{style:{color:"#52c41a"}}):(0,d.jsx)(s.Z,{}),onMouseLeave:function(){f&&h(!1)}}))})}},3036:function(n,e){"use strict";var t={readAsText:function(n,e,t){t||(t="utf8");var r=new FileReader;r.onload=function(){e(r.result)},r.readAsText(n,t)},download:function(n,e){e||(e="download");var t=URL.createObjectURL(new Blob([n])),r=document.createElement("a");r.href=t,r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)}};e.Z=t},3988:function(n,e){"use strict";var t={underlineToHump:function(n){return n.replace(/_(\w)/g,(function(n,e){return e.toUpperCase()}))},humpToUnderline:function(n){return n.replace(/([A-Z])/g,"_$1").toLowerCase()},isStr:function(n){return"string"===typeof n},isBlank:function(n){return void 0===n||null===n||""===n},copyToClipboard:function(n){var e=document.createElement("textarea");e.value=n,document.body.appendChild(e),e.select();var t=document.execCommand("copy");return e.remove(),t}};e.Z=t},2480:function(){}}]);