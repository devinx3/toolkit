(self.webpackChunktoolkit=self.webpackChunktoolkit||[]).push([[400],{9659:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>We});var i=n(7313),r=n(8197),s=n(9624),o=n(7222),a=n(9491);const c=e=>"devinx3.toolkit.".concat(e,"EditOnfig"),l=e=>"devinx3.toolkit.".concat(e,"EditCombination"),d=e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):[]},p=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},u={editConfig:{list:e=>d(c(e)),store:(e,t)=>p(c(e),t)},editCombination:{list:e=>d(l(e)),store:(e,t)=>p(l(e),t)}};var h=n(7518),x=void 0;const m=e=>u.editConfig.list(e)||[],f=e=>u.editCombination.list(e),g=(()=>{const e={};for(const t in h.b){const n=h.b[t];e[n]=m(n)}return e})(),y=(()=>{const e={};for(const t in h.b)e[t]=f(t);return e})(),C=(e,t)=>{try{u.editConfig.store(e,t),g[e]=m(e)}catch(n){return console.log("storeEditConfig error",n),n.message}return!0},j=(e,t)=>{try{u.editCombination.store(e,t),y[e]=f(e)}catch(n){return console.log("storeEditCombination error",n),n.message}return!0},S=(e,t)=>{for(let n of e)if(n.id===t)return n;return null},v=(e,t)=>{const n=e(t);let i=0;for(let r of n)r.id>i&&(i=r.id);return i},Z={listAllConfig:e=>(g[e]=m(e),g[e]),queryConfigById:(e,t)=>S(g[e],t),queryConfigByName:(e,t)=>{var n;const i=[];return null===(n=m(e))||void 0===n||n.forEach((e=>{e.name===t&&i.push(e)})),i},addConfig:(e,t)=>(t.id=v(m,e)+1,g[e].push(t),C(e,g[e])),updateConfig:(e,t)=>{const n=g[e];for(let i=0;i<n.length;i++)if(n[i].id===t.id)return n[i].name=t.name,n[i].description=t.description,n[i].scriptContent=t.scriptContent,C(e,n);return!1},deleteConfig:(e,t)=>Z.batchDeleteConfig(e,[t]),batchDeleteConfig:(e,t)=>{if(!(t&&t.length&&t.length>0))return!0;const n=g[e];let i=!1;for(let r=0;r<n.length;r++)if(t.indexOf(n[r].id)>=0){const t=Z.checkCombinationByConfig(e,[n[r].id]);if(!0!==t)return"\u5f53\u524d\u914d\u7f6e\u88ab\u7ec4\u5408 ["+t+"] \u5f15\u7528";n.splice(r,1),r--,i=!0}return i?C(e,n):"\u6570\u636e\u4e0d\u5b58\u5728, \u8bf7\u5237\u65b0\u9875\u9762"},listAllCombination:e=>(y[e]=f(e),y[e]),queryCombinationById:(e,t)=>S(y[e],t),checkCombinationByConfig:(e,t)=>{for(let n of Z.listAllCombination(e))if(n.combination)for(let e of n.combination)if(t.indexOf(e)>=0)return n.name||"-";return!0},addCombination:(e,t)=>{const n=y[e];return t.id=v(f,e)+1,n.push(t),j(e,n)},updateCombination:(e,t)=>{const n=y[e];for(let i=0;i<n.length;i++)if(n[i].id===t.id)return n[i].name=t.name,n[i].description=t.description,n[i].combination=t.combination,j(e,n);return!1},deleteCombination:(e,t)=>Z.batchDeleteCombination(e,[t]),batchDeleteCombination:(e,t)=>{if(!(t&&t.length&&t.length>0))return!0;let n=!1;const i=y[e];for(let r=0;r<i.length;r++)t.indexOf(i[r].id)>=0&&(i.splice(r,1),r--,n=!0);return!!n&&j(e,i)}},E=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new Promise(((t,i)=>{let r=!1;try{r=e.apply(x,n)}catch(s){i(s.message)}!0===r?t.apply(x,n):r instanceof Array?t.apply(x,[r]):r instanceof Object?t.apply(x,r):i(r)}))},b=Z;var w=n(7978),T=n(5291),k=n(5900),P=n(685),A=n(7258),I=n(5705),N=n(9180),B=n(9424),L=(n(8110),n(9518)),O=n.n(L);const D=e=>{let{ts:t}=e;const n=(()=>{const e=/^\t+$/,t=/^ +$/;return{AllTabs:e,AllSpaces:t,adjustMultilineIndentation:function(n,i,r){if(!i)return n;const s=/\r?\n/,o=n.split(s);if(1===o.length)return n;const a=s.exec(n)[0];return o.map(((n,s)=>s>0?function(n,i,r){const s=/^[\t ]+/.exec(n);if(!s)return n;const o=s[0];if(e.test(o)&&i<=o.length)return n.substring(i);if(t.test(o)&&i<=o.length/r)return n.substring(i*r);return n}(n,i,r):n)).join(a)},adjustLeadingWhitespace:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.split(/\r?\n/).map(((e,n)=>n?t+e:e)).join("\n")}}})(),i={findNodeAtPosition:(e,n)=>{const i=[];e.statements.forEach((function r(s){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const a=s.getStart(e),c=s.getEnd();(!t.isToken(s)||t.isIdentifier(s)||t.isTypeNode(s))&&a<=n&&n<c&&i.push({depth:o,node:s,width:c-a}),s.getChildren(e).forEach((e=>r(e,o+1)))}));const r=i.sort(((e,t)=>e.width===t.width?t.depth-e.depth:e.width-t.width));return r.length>0&&r[0].node},findClosestParent:(e,t)=>{for(;e&&e.kind!==t;)e=e.parent;return e},isAssignmentBinaryExpression:e=>[t.SyntaxKind.EqualsToken,t.SyntaxKind.PlusEqualsToken,t.SyntaxKind.MinusEqualsToken,t.SyntaxKind.SlashEqualsToken,t.SyntaxKind.AsteriskEqualsToken,t.SyntaxKind.AsteriskAsteriskEqualsToken,t.SyntaxKind.AmpersandEqualsToken,t.SyntaxKind.BarEqualsToken,t.SyntaxKind.BarBarEqualsToken,t.SyntaxKind.CaretEqualsToken,t.SyntaxKind.LessThanLessThanToken,t.SyntaxKind.LessThanLessThanEqualsToken,t.SyntaxKind.GreaterThanEqualsToken,t.SyntaxKind.GreaterThanGreaterThanEqualsToken,t.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,t.SyntaxKind.AmpersandAmpersandEqualsToken,t.SyntaxKind.QuestionQuestionToken,t.SyntaxKind.BarBarEqualsToken].includes(e.operatorToken.kind)},r=(()=>{const e=/^(get|read|create|retrieve|select|modify|update|use|find)(?<name>[A-Z].+?)?$/,n=/((By|With|From).*$)|(Sync$)|.*(?=Items|Lines$)/,i=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function r(e){const t=null===e||void 0===e?void 0:e.replace(n,"");return[...new Set([t,e])].filter((e=>e))}function s(t){var n,i;return null===(n=e.exec(t))||void 0===n||null===(i=n.groups)||void 0===i?void 0:i.name}function o(e){return t.isIdentifier(e.expression)?e.expression.text:t.isPropertyAccessExpression(e.expression)?e.expression.name.text:void 0}function a(e){return t.isIdentifier(e.expression)?e.expression.text:t.isPropertyAccessExpression(e.expression)?e.expression.name.text:void 0}return{inferVarTemplateName:e=>{if(t.isNewExpression(e))return[i(a(e))];if(t.isCallExpression(e)){const t=s(o(e));if(!t)return;return r(t).map(i)}},inferForVarTemplate:e=>{const n=function(e){if(t.isIdentifier(e))return e.text;if(t.isPropertyAccessExpression(e))return e.name.text;if(t.isCallExpression(e))return o(e)}(e);if(!n)return;const a=t.isCallExpression(e)?s(n):n.replace(/^(?:all)?(.+?)(?:List)?$/,"$1");return r(a).map(O().singular).filter((e=>e!==a)).map(i)}}})();return{getIndentCharacters:e=>e?e.insertSpaces?" ".repeat(e.tabSize):"\t":"",getPlaceholderWithOptions:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.length>1?"${".concat(t,"|").concat(e.join(","),"|}"):"${".concat(t,":").concat(e[0],"}")},AllTabs:n.AllTabs,AllSpaces:n.AllSpaces,adjustMultilineIndentation:n.adjustMultilineIndentation,adjustLeadingWhitespace:n.adjustLeadingWhitespace,findNodeAtPosition:i.findNodeAtPosition,findClosestParent:i.findClosestParent,isAssignmentBinaryExpression:i.isAssignmentBinaryExpression,inferVarTemplateName:r.inferVarTemplateName,inferForVarTemplate:r.inferForVarTemplate}},F={upper:e=>e.toUpperCase(),lower:e=>e.toLowerCase(),capitalize:e=>e.substring(0,1).toUpperCase()+e.substring(1)},R=e=>{const{monaco:t,ts:n}=e,i=D(e);class r{constructor(e,r,s){n.isAwaitExpression(r.parent)&&(r=r.parent),this.node=r,this.item={label:{label:e},kind:t.languages.CompletionItemKind.Snippet},this.code=i.adjustMultilineIndentation(r.getText(),null===s||void 0===s?void 0:s.indentSize,null===s||void 0===s?void 0:s.tabSize),this.indentInfo=s}build(){return this.item}description(e){return this.item.label.description=e,this}replace(e){const i=this.node.getSourceFile(),r=n.getLineAndCharacterOfPosition(i,this.node.getStart(i)),s=n.getLineAndCharacterOfPosition(i,this.node.getEnd()),o={startLineNumber:r.line+1,startColumn:r.character+1,endLineNumber:s.line+1,endColumn:s.character+2};if(/(?<!\\)\$/.test(e)){const n=this.code.replace(/\\/g,"\\\\").replace(/\$/g,"\\$");this.item.insertText=this._replaceExpression(e,n),this.item.insertTextRules=t.languages.CompletionItemInsertTextRule.InsertAsSnippet,this.item.additionalTextEdits=[{range:o,text:null}],this.item.keepWhitespace=!0}else this.item.insertText="",this.item.additionalTextEdits=[{range:o,text:this._replaceExpression(e.replace(/\\\$/g,"$$"),this.code)}];return this}_replaceExpression(e,t,n){const i=new RegExp(n||"{{expr(?::(upper|lower|capitalize))?}}","g");return e.replace(i,((e,n)=>n&&F[n]?F[n](t):t))}}return(e,t,n)=>new r(e,t,n)},K=e=>{const{ts:t}=e,n=D(e),i=R(e);class r{constructor(e){this.isSimpleExpression=e=>t.isExpressionStatement(e)&&!this.isStringLiteral(e),this.isPropertyAccessExpression=e=>e.kind===t.SyntaxKind.PropertyAccessExpression,this.isElementAccessExpression=e=>e.kind===t.SyntaxKind.ElementAccessExpression,this.isExpression=e=>this.isSimpleExpression(e)||this.isPropertyAccessExpression(e)||this.isElementAccessExpression(e),this.isIdentifier=e=>t.isIdentifier(e)&&!this.inTypeReference(e.parent),this.isUnaryExpression=e=>e.kind===t.SyntaxKind.PostfixUnaryExpression||e.kind===t.SyntaxKind.PrefixUnaryExpression,this.isCallExpression=e=>e.kind===t.SyntaxKind.CallExpression,this.isNewExpression=e=>e.kind===t.SyntaxKind.NewExpression,this.inFunctionArgument=e=>t.isCallExpression(e.parent)&&e.parent.arguments.includes(e),this.isObjectLiteral=e=>t.isBlock(e)&&(0===e.statements.length||e.statements.some((e=>t.isLabeledStatement(e)))),this.isStringLiteral=e=>t.isTemplateSpan(e)||t.isExpressionStatement(e)&&(t.isStringLiteral(e.expression)||t.isNoSubstitutionTemplateLiteral(e.expression)),this.isTypeNode=e=>!!t.isTypeNode(e)||e.parent&&this.inTypeReference(e.parent),this.inAwaitedExpression=e=>!this.isAnyFunction(e)&&(e.kind===t.SyntaxKind.AwaitExpression||e.parent&&this.inAwaitedExpression(e.parent)),this.inReturnStatement=e=>!this.isAnyFunction(e)&&(e.kind===t.SyntaxKind.ReturnStatement||e.parent&&this.inReturnStatement(e.parent)),this.inVariableDeclaration=e=>!this.isAnyFunction(e)&&(e.kind===t.SyntaxKind.VariableDeclaration||e.parent&&this.inVariableDeclaration(e.parent)),this.isBinaryExpression=e=>!!t.isBinaryExpression(e)||(t.isParenthesizedExpression(e)&&t.isBinaryExpression(e.expression)||e.parent&&this.isBinaryExpression(e.parent)),this.unwindBinaryExpression=function(e){let i=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&t.isParenthesizedExpression(e)&&t.isBinaryExpression(e.expression)?e.expression:n.findClosestParent(e,t.SyntaxKind.BinaryExpression);for(;i&&t.isBinaryExpression(i.parent);)i=i.parent;return i&&!n.isAssignmentBinaryExpression(i)?i:e},this.isAnyFunction=e=>t.isFunctionExpression(e)||t.isArrowFunction(e)||t.isMethodDeclaration(e),this.inAssignmentStatement=e=>!this.isAnyFunction(e)&&(t.isBinaryExpression(e)?n.isAssignmentBinaryExpression(e):e.parent&&this.inAssignmentStatement(e.parent)),this.inIfStatement=(e,n)=>t.isIfStatement(e)?!n||e.expression===n:e.parent&&this.inIfStatement(e.parent,e),this.inTypeReference=e=>!!t.isTypeReferenceNode(e)||e.parent&&this.inTypeReference(e.parent),this.keyword=e}}class s extends r{canUse(e){return!this.inIfStatement(e)&&!this.isTypeNode(e)&&!this.inAssignmentStatement(e)&&(this.isIdentifier(e)||this.isExpression(e)||this.isUnaryExpression(e)||this.isBinaryExpression(e)||this.isCallExpression(e))}}class o extends s{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"var")}buildCompletionItem(e,t){var r;e=this.unwindBinaryExpression(e);const s=null!==(r=n.inferVarTemplateName(e))&&void 0!==r?r:["name"];return i(this.keyword,e,t).description("".concat(this.keyword," name = expr")).replace("".concat(this.keyword," ").concat(n.getPlaceholderWithOptions(s)," = {{expr}}$0")).build()}canUse(e){return(super.canUse(e)||this.isNewExpression(e)||this.isObjectLiteral(e)||this.isStringLiteral(e))&&!this.inReturnStatement(e)&&!this.inFunctionArgument(e)&&!this.inVariableDeclaration(e)&&!this.inAssignmentStatement(e)}}class a extends r{canUse(e){return!this.inReturnStatement(e)&&!this.inIfStatement(e)&&!this.inFunctionArgument(e)&&!this.inVariableDeclaration(e)&&!this.inAssignmentStatement(e)&&!this.isTypeNode(e)&&!this.isBinaryExpression(e)&&(this.isIdentifier(e)||this.isPropertyAccessExpression(e)||this.isElementAccessExpression(e)||this.isCallExpression(e)||this.isArrayLiteral(e))}isArrayLiteral(e){return e.kind===t.SyntaxKind.ArrayLiteralExpression}getArrayItemNames(e){const t=n.inferForVarTemplate(e);return(null===t||void 0===t?void 0:t.length)>0?t:["item"]}}class c extends a{buildCompletionItem(e,r){const s=e.parent&&t.isAwaitExpression(e.parent),o=s?"(":"",a=s?")":"";return"forr"===this.keyword?i("forr",e,r).description("for (let i = expr.length - 1; i >= 0; i--)").replace("for (let ${1:i} = ".concat(o,"{{expr}}").concat(a,".length - 1; ${1} >= 0; ${1}--) {\n").concat(n.getIndentCharacters(r),"${0}\n}")).build():i("fori",e,r).description("for (let i = 0; i < expr.length; i++)").replace("for (let ${1:i} = 0; ${1} < ".concat(o,"{{expr}}").concat(a,".length; ${1}++) {\n").concat(n.getIndentCharacters(r),"${0}\n}")).build()}canUse(e){return super.canUse(e)&&!this.isArrayLiteral(e)&&!this.isCallExpression(e)}}return[new o,new o("let"),new o("const"),new c("fori"),new c("forr"),new class extends a{buildCompletionItem(e,t){const r=super.getArrayItemNames(e);return i("forof",e,t).description("for (let item of expr)").replace("for (let ".concat(n.getPlaceholderWithOptions(r)," of {{expr}}) {\n").concat(n.getIndentCharacters(t),"${0}\n}")).build()}}("forof"),new class extends a{buildCompletionItem(e,r){const s=e.parent&&t.isAwaitExpression(e.parent),o=s?"(":"",a=s?")":"",c=super.getArrayItemNames(e);return i("foreach",e,r).description("expr.forEach(item => )").replace("".concat(o,"{{expr}}").concat(a,".forEach(").concat(n.getPlaceholderWithOptions(c)," => {\n").concat(n.getIndentCharacters(r),"${0}\n})")).build()}}("foreach")]},$=(e,t)=>{const n={monaco:e,ts:t},i=D(n),r=K(n);const s=new class{provideCompletionItems(e,n,i,s){var o;const a=e.getLineContent(n.lineNumber).lastIndexOf(".",n.column-1),c=e.getWordAtPosition(n),l=(null!==(o=null===c||void 0===c?void 0:c.startColumn)&&void 0!==o?o:n.column)-1===a+1;if(-1===a||!l)return[];const d=[];try{const i=this._getNodeBeforeTheDot(e,n,a);if(i){const n=this._getIndentInfo(e,i),s=this._getNodeForReplacement(i);r.forEach((e=>{e.canUse(t.isNonNullExpression(i)?i.expression:i)&&d.push(e.buildCompletionItem(s,n))}))}}catch(p){console.warn("Error while building postfix autocomplete items:",p)}return d}_getNodeBeforeTheDot(e,n,r){const s=e.getValueInRange({startLineNumber:1,endLineNumber:n.lineNumber,startColumn:1,endColumn:r+1}),o=t.createSourceFile("test.ts",s,t.ScriptTarget.ES5,!0),a=t.getPositionOfLineAndCharacter(o,n.lineNumber-1,r-1),c=i.findNodeAtPosition(o,a);return t.isIdentifier(c)&&t.isPropertyAccessExpression(c.parent)?c.parent:c}_getNodeForReplacement(e){return t.isTemplateSpan(e)||t.isPrefixUnaryExpression(e.parent)||t.isPropertyAccessExpression(e.parent)?e.parent:t.isTypeReferenceNode(e.parent)||e.parent.parent&&t.isTypeReferenceNode(e.parent.parent)?i.findClosestParent(e,t.SyntaxKind.TypeReference):e}_getIndentInfo(e,n){var r,s;const o=(null===(r=e.getOptions())||void 0===r?void 0:r.tabSize)||4,a=(null===(s=e.getOptions())||void 0===s?void 0:s.insertSpaces)||true,c=n.getSourceFile(),l=t.getLineAndCharacterOfPosition(c,n.getStart(c)),d=e.getLineContent(l.line+1).substring(0,e.getLineFirstNonWhitespaceColumn(l.line+1)-1);let p=0;return i.AllTabs.test(d)?p=d.length:i.AllSpaces.test(d)&&(p=d.length/o),{tabSize:o,insertSpaces:a,indentSize:p,leadingWhitespace:d}}};return{triggerCharacters:["."],provideCompletionItems:(e,t,n,i)=>({suggestions:s.provideCompletionItems(e,t,n,i)||[]})}},q=(e,t)=>{(n.g.ts?Promise.resolve(n.g.ts):new Promise(((e,t)=>{n.e(389).then(n.bind(n,2389)).then((()=>{const i=n.g.ts;i||t(new Error("\u83b7\u53d6tsWorker\u5931\u8d25")),e(i)})).then(t)}))).then((n=>t($(e,n)))).catch((e=>console.log("register postfix error",e)))};var M=n(7534);const U=new class{constructor(){this.dataSource={}}has(e){return e in this.dataSource}get(e){return this.dataSource[e]}set(e,t){this.dataSource[e]=t}},V=(e,t,n)=>{e.languages.typescript.javascriptDefaults.addExtraLib(t,n),e.editor.createModel(t,"typescript",e.Uri.parse(n))},_=[{name:"lodash",path:"https://cdn.jsdelivr.net/npm/@types/lodash@4.14.93/index.d.ts"},{name:"dayjs",path:"https://cdn.jsdelivr.net/npm/dayjs@1.11.6/index.d.ts"},{name:"cryptoJS",path:"https://cdn.jsdelivr.net/npm/@types/crypto-js@4.1.1/index.d.ts"},{name:"xlsx",path:"https://cdn.jsdelivr.net/npm/xlsx@0.18.5/types/index.d.ts"}],z=M.X.loadMonaco;const H=function(e){if(!e||M.Z.getFromCache(z))return;M.Z.setToCache(z,!0);const t=e.languages.typescript.javascriptDefaults.getExtraLibs()||{};Promise.all(_.map((e=>(e=>{const t=e.name,n={name:t};return U.has(t)?(n.content=U.get(t),Promise.resolve(n)):(async()=>{const t=await fetch(e.path);return n.content=await t.text(),n.content?n:null})()})(e)))).then((n=>{n.filter((e=>!!e)).forEach((n=>{U.set(n.name,n.content);const i="ts:web/".concat(n.name,"/index.d.ts");if(i in t)return;const r="declare module '".concat(n.name,"' { ").concat(n.content," }");V(e,r,i)}));const i="ts:inner/converter.d.ts";i in t||V(e,'declare const inputData: (string | Object | File[]);\ndeclare const inputObj: (Object | null)\ndeclare const Util: ({\n    _: typeof import("lodash"),,\n    dayjs: typeof import("dayjs"),\n    cryptoJS: typeof import("cryptoJS"),\n    XLSX: typeof import("xlsx"),\n    message: {\n        info(content: string, duration?: number): void;\n        success(content: string, duration?: number): void;\n        error(content: string, duration?: number): void;\n        warning(content: string, duration?: number): void;\n        loading(content: string, duration?: number): void;\n    }\n});',i)})).catch((e=>console.error("load extraLibs error",e)));try{q(e,(t=>e.languages.registerCompletionItemProvider("javascript",t)))}catch(n){console.error("load completionPostfix error",n)}};var W=n(6417);const J=e=>{let{value:t,onChange:n,editorHelpRender:r}=e;const[s,o]=i.useState(!0);return(0,W.jsxs)(W.Fragment,{children:[r&&r(),(0,W.jsx)("br",{}),(0,W.jsx)(I.Z,{style:{marginTop:"5px",marginBottom:"13px"},children:(0,W.jsx)(N.ZP.Group,{size:"small",optionType:"button",onChange:()=>o(!s),options:[{label:"monaco",value:"1"},{label:"input",value:"0"}],value:s?"1":"0"})}),s?(0,W.jsx)(B.ZP,{height:"90%",language:"javascript",theme:"vs-dark",value:t,onChange:n,beforeMount:H}):(0,W.jsx)(P.Z.TextArea,{placeholder:"\u8bf7\u8f93\u5165\u811a\u672c",rows:8,value:t,onChange:e=>n(e.target.value)})]})};var G=n(2019);const{addConfig:X,updateConfig:Q,deleteConfig:Y}=b,{Text:ee}=w.default,te=e=>{let{lang:t,config:n,scriptContent:r,onAddSuccess:s}=e;const o=n.name,c=n.description||o,[l,d]=i.useState(),[p,u]=i.useState();return(0,W.jsx)(k.Z,{icon:null,cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",onConfirm:()=>{if(!r)return T.ZP.warn("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),!1;E(X,t,{name:l||o,description:p||l||c,scriptContent:r}).then((()=>{d(null),u(null),T.ZP.success("\u6dfb\u52a0\u914d\u7f6e\u6210\u529f"),s()})).catch((e=>T.ZP.error("\u6dfb\u52a0\u914d\u7f6e\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+e)))},title:(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(P.Z,{addonBefore:"\u529f\u80fd\u540d\u79f0",placeholder:o,value:l,onChange:e=>d(e.target.value)}),(0,W.jsx)(P.Z,{style:{marginTop:"3px"},addonBefore:"\u529f\u80fd\u4f5c\u7528",placeholder:c,value:p,onChange:e=>u(e.target.value)})]}),children:(0,W.jsx)(a.Z,{children:"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u914d\u7f6e"})})},ne=e=>{let{lang:t,context:n,config:c,refreshScript:l,editorHelpRender:d}=e;const[p,u]=i.useState(!1),[h,x]=i.useState(c.scriptContent);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(o.Z,{title:c.description,mouseEnterDelay:1,children:(0,W.jsx)(a.Z,{onClick:()=>u(!0),children:c.name})}),(0,W.jsx)(A.Z,{title:c.name,open:p,width:"75%",onClose:()=>{u(!1)},footer:(0,W.jsx)(r.Z,{justify:"end",children:(0,W.jsxs)(I.Z,{children:[(0,W.jsx)(s.Z,{children:(0,W.jsx)(te,{lang:t,config:c,scriptContent:h,onAddSuccess:()=>{u(!1),l()}},"add")}),(0,W.jsx)(s.Z,{children:(0,W.jsx)(a.Z,{type:"primary",onClick:()=>{h?(n.onConvert([h]),u(!1)):T.ZP.warn("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a")},children:"\u8f6c\u6362"},"convert")})]})}),children:(0,W.jsx)(J,{value:h,onChange:x,editorHelpRender:d})})]})},ie=e=>{let{lang:t,config:n,visible:o,setVisible:c,editorHelpRender:l,refreshScript:d}=e;const[p,u]=i.useState(n.name),[h,x]=i.useState(n.description),[m,f]=i.useState(n.scriptContent),g=()=>c(!1);return(0,W.jsxs)(A.Z,{open:o,width:"75%",onCancel:g,title:p!==n.name||h!==n.description||m!==n.scriptContent?(0,W.jsx)(ee,{style:{color:"#1890ff"},strong:!0,children:"\u7f16\u8f91\u914d\u7f6e *"}):(0,W.jsx)(ee,{children:"\u7f16\u8f91\u914d\u7f6e"}),onClose:g,footer:(0,W.jsx)(r.Z,{justify:"end",children:(0,W.jsxs)(I.Z,{children:[(0,W.jsx)(s.Z,{children:(0,W.jsx)(a.Z,{onClick:()=>{u(n.name),x(n.description),f(n.scriptContent)},children:"\u91cd\u7f6e"},"reset")}),(0,W.jsx)(s.Z,{children:(0,W.jsx)(a.Z,{onClick:()=>{E(Y,t,n.id).then((()=>{T.ZP.success("\u5220\u9664\u914d\u7f6e\u6210\u529f"),g(),d()})).catch((e=>T.ZP.error("\u5220\u9664\u914d\u7f6e\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+e)))},children:"\u5220\u9664\u914d\u7f6e"},"remove")}),(0,W.jsx)(s.Z,{children:(0,W.jsx)(a.Z,{type:"primary",onClick:()=>{if(!p)return void T.ZP.error("\u529f\u80fd\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a");if(!m)return void T.ZP.error("\u811a\u672c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a");const e={id:n.id,name:p,description:h||p,scriptContent:m};E(Q,t,e).then((()=>{T.ZP.success("\u66f4\u65b0\u914d\u7f6e\u6210\u529f"),g(),d()})).catch((e=>console.log(e)&T.ZP.error("\u66f4\u65b0\u914d\u7f6e\u5931\u8d25, \u5931\u8d25\u539f\u56e0: "+e)))},children:"\u66f4\u65b0\u914d\u7f6e"},"update")})]})}),children:[(0,W.jsx)(P.Z,{addonBefore:"\u529f\u80fd\u540d\u79f0",value:p,onChange:e=>u(e.target.value)}),(0,W.jsx)(P.Z,{style:{marginTop:"3px"},addonBefore:"\u529f\u80fd\u4f5c\u7528",value:h,onChange:e=>x(e.target.value)}),(0,W.jsx)(J,{lang:t,value:m,onChange:f,editorHelpRender:l})]})},re=e=>{let{lang:t,config:n,handleConvert:r,editorHelpRender:s,refreshScript:c}=e;const[l,d]=i.useState(!1);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(o.Z,{title:n.description,mouseEnterDelay:1,children:(0,W.jsx)(a.Z,{type:"dashed",onClick:e=>r(n.scriptContent),children:n.name})}),(0,W.jsx)(o.Z,{title:"\u7f16\u8f91",mouseEnterDelay:2,children:(0,W.jsx)(a.Z,{shape:"circle",type:"text",onClick:e=>d(!0),icon:(0,W.jsx)(G.Z,{}),size:"small"})}),(0,W.jsx)(ie,{lang:t,config:n,visible:l,setVisible:d,editorHelpRender:s,refreshScript:c})]})};var se=n(2984),oe=n.n(se);const ae=new class{constructor(){this.featurePrefix="devinx3",this.verionPrefix="ver",this.fixVersion="000",this.fixSecret="ver000"}encrypt(e,t){return oe().AES.encrypt(e,t).toString()}dencrypt(e,t){return oe().AES.decrypt(e,t).toString(oe().enc.Utf8)}convertSecret(e){return e>=100&&e<=999?this.verionPrefix+e:this.fixSecret}getFeatureSuffix(e){return e===this.fixSecret?"S":"l"}getFeatureSecretIndex(e){if(e<100)return-1;const t=e-10-10,n=[],i=[17,27,23,3,19,11];for(let r=0;r<6;r++)n.push(10+(t*i[r]/30^0));return n}addSecret(e,t,n){return e.slice(0,t)+n+e.slice(t)}removeSecret(e,t){return e.slice(0,t)+e.slice(t+1)}convertExportData(e,t){let n=this.convertSecret(t),i=this.encrypt(e,n);i.length<100&&(n=this.fixSecret,i=this.encrypt(e,n));const r=this.featurePrefix,s=i.length,o=this.getFeatureSuffix(n);if(n===this.fixSecret)return r+s+o+i;const a=this.getFeatureSecretIndex(s);let c=i;for(let l=a.length-1;l>=0;l--)c=this.addSecret(c,a[l],n[l]);return r+s+o+c}convertImportData(e){if(!e)throw new Error("\u6570\u636e\u4e0d\u80fd\u4e3a\u7a7a");const t=e.slice(0,this.featurePrefix.length);if(t!==this.featurePrefix)throw new Error("\u5339\u914d\u7279\u5f81\u524d\u7f00\u5f02\u5e38");const n=t.length+10;let i="l",r=e.indexOf(i);if((r<0||r>=n)&&(i="S",r=e.indexOf(i),r<0||r>=n))throw new Error("\u5339\u914d\u7279\u5f81\u540e\u7f00\u5f02\u5e38");let s=Number(e.slice(t.length,r));if(!s)throw new Error("\u5339\u914d\u6570\u636e\u957f\u5ea6\u5f02\u5e38");const o=this.getFeatureSecretIndex(s),a=e.slice(r+1);if(-1===o)return this.encrypt(e,a);let c=a,l="";for(let d=0;d<o.length;d++)l+=c[o[d]],c=this.removeSecret(c,o[d]);return this.dencrypt(c,l)}},ce=e=>{const t=[];return e&&e.forEach(((n,i)=>{const r={...n};r.id=-10-10*(e.length-i),t.push(r)})),t},le=e=>e.id<=-10,de=e=>e<=-10;var pe=n(870),ue=n(2346),he=n(2652),xe=n(2697),me=n(1656),fe=n(627),ge=n(7515),ye=n(4585),Ce=n(6407),je=n(445),Se=n(3036),ve=n(3988),Ze=n(658),Ee=n.n(Ze);const be=6e4;function we(e,t){var n;t.completed=!0,null!==(n=t.scriptElement)&&void 0!==n&&n.parentNode&&t.scriptElement.parentNode.removeChild(t.scriptElement),t.timerId&&clearTimeout(t.timerId);try{void 0===t.overwritten?delete window[e.functionName]:window[e.functionName]=t.overwritten}catch(i){window[e.functionName]=void 0}}const Te=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={url:e,callbackParamName:t.callback||t.callbackParamName,functionName:t.name||"jsonp_".concat(Date.now(),"_").concat(Math.ceil(1e5*Math.random())),timeout:t.timeout||be};n.url="".concat(n.url).concat(-1===n.url.indexOf("?")?"?":"&").concat(n.functionName);const i={scriptId:"script_".concat(n.functionName),timerId:null,scriptElement:null,completed:!1,overwritten:void 0};return new Promise(((t,r)=>{i.overwritten=window[n.functionName],window[n.functionName]=e=>{t(e),we(n,i)},i.scriptElement=function(e,t){const n=document.createElement("script");return n.setAttribute("src","".concat(e.url).concat(e.callbackParamName,"=").concat(e.functionName)),n.id=t.scriptId,n}(n,i),i.scriptElement.onload=t=>{i.completed||(r(new Error("JSONP parse ".concat(e," response failed"))),we(n,i))},i.scriptElement.onerror=()=>{r(new Error("JSONP request to ".concat(e," failed"))),we(n,i)},document.head.appendChild(i.scriptElement),i.timerId=setTimeout((()=>{r(new Error("JSONP request to ".concat(e," timed out"))),we(n,i)}),n.timeout)}))},{addConfig:ke,queryConfigByName:Pe,updateConfig:Ae,batchDeleteConfig:Ie}=b,Ne="__devinx3_call_231125__",Be=e=>{let{lang:t,dataSource:n,refreshScript:r}=e;const[s,c]=i.useState(!1),[l,d]=i.useState([]),[p,u]=i.useState(!1),[h,x]=i.useState(!1),[m,f]=i.useState(!1),[g,y]=i.useState(),[C,j]=i.useState(),[S,v]=i.useState(),[Z,b]=i.useState(),[k,A]=i.useState(!1),I=e=>{const t=e.target.value,i=[...l],r=i.indexOf(t);e.target.checked?r<0&&i.push(t):r>=0&&i.splice(r,1),d(i),u(!!i.length&&i.length<n.length),x(i.length===n.length)},N=e=>{const t=[];for(let i of n)if(-1!==l.indexOf(i.id)){const n={...i};e&&delete n.id,t.push(n)}return t};let B=null;const L=e=>{if(0===l.length)return void T.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u9700\u5bfc\u51fa");const t=((e,t)=>{const n=ae.convertExportData(JSON.stringify(e),101);if(!t)return n;let i=Ne;return i+="({",i+="".concat("d",':"').concat(n,'"'),t instanceof Object&&Object.keys(t).length>0&&(i+=",".concat("c",":").concat(JSON.stringify(t))),i+="})",i})(N(!0),e),n="config"+Ee()().format("MMDDHHmmss");Se.Z.download(t,n)},O=()=>A(!1),D=()=>A(!1),F=(e,n)=>{var i;if(!e)return void D();let s=null;if(null!==(i=e)&&void 0!==i&&i.startsWith(Ne)){const t=Function,i="importContext",r={};r[Ne]=t=>{e=t.d,n=t.c};try{new t(i,i+"."+e)(r)}catch(c){return T.ZP.error("\u5bfc\u5165\u5931\u8d25, \u5f02\u5e38\u6d88\u606f: "+c.message),void D()}}n||(n={});try{s=JSON.parse(ae.convertImportData(e))}catch(c){return T.ZP.error("\u5bfc\u5165\u5931\u8d25, \u5f02\u5e38\u6d88\u606f: "+c.message),void D()}if(!(s&&s.length&&s.length>0))return void D();let o=0,a="";Promise.all(s.map((async e=>{if(n.coverByName){const n=await E(Pe,t,e.name);if(1===(null===n||void 0===n?void 0:n.length))try{return console.debug("\u5bfc\u5165\u7684\u6570\u636e:",n[0]),e.id=n[0].id,await E(Ae,t,e),o++}catch(i){return a=a+i+";"}else(null===n||void 0===n?void 0:n.length)>1&&T.ZP.warn("\u5339\u914d\u5230\u591a\u4e2a\u3010"+e.name+"\u3011, \u5c06\u4f1a\u65b0\u589e\u914d\u7f6e")}else e.name=e.name+"(by impory)";try{return await E(ke,t,e),o++}catch(i){return a=a+i+";"}}))).finally((()=>{0!==o?(o===s.length?T.ZP.success("\u5168\u90e8\u5bfc\u5165\u6210\u529f"):T.ZP.warn("\u90e8\u5206\u5bfc\u5165\u6210\u529f, \u5f02\u5e38\u4e2a\u6570"+(s.length-o)+", \u5f02\u5e38\u6d88\u606f: "+a),D(),r()):T.ZP.error("\u5168\u90e8\u5bfc\u5165\u5931\u8d25, \u5f02\u5e38\u6d88\u606f: ")}))},R=e=>{if(k)return T.ZP.warn("\u6b63\u5728\u5bfc\u5165\u4e2d, \u8bf7\u7b49\u5f85"),!1;if((null===Z||void 0===Z?void 0:Z.length)>0){const e=(e=>{try{return new URL(e)}catch(t){return!1}})(Z);if(!e)return T.ZP.error("\u65e0\u6548\u7684\u5bfc\u5165\u5730\u5740"),!1;if(e.protocol!==window.location.protocol)return T.ZP.warn("\u4e0d\u652f\u6301\u7684\u534f\u8bae, \u76ee\u524d\u4ec5\u652f\u6301 \u3010"+window.location.protocol+"\u3011\u5f00\u5934\u7684\u5bfc\u5165\u5730\u5740"),!1;O(),n=F,i=D,Te(t=Z,{name:Ne,timeout:3e4}).then((function(e){if(!e)throw new Error("\u6570\u636e\u683c\u5f0f\u5f02\u5e38");const t=e.d;if("string"!==typeof t)throw new Error("\u6570\u636e\u683c\u5f0f\u5f02\u5e38");const i=e.c;if(i&&"object"!==typeof i)throw new Error("\u6570\u636e\u683c\u5f0f\u5f02\u5e38");n(t,i)})).catch((e=>{i(),T.ZP.error("\u52a0\u8f7d\u5931\u8d25: "+t),console.debug("\u52a0\u8f7d\u5931\u8d25",e)})).finally((()=>i(void 0)))}else O(),Se.Z.readAsText({file:e,handleRead:F,handleError:D});var t,n,i;return!1};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(a.Z,{type:"link",onClick:()=>c(!0),children:"\u914d\u7f6e\u7ba1\u7406"}),(0,W.jsx)(pe.Z,{title:"\u914d\u7f6e\u7ba1\u7406",open:s,footer:null,onCancel:()=>c(!1),children:(0,W.jsx)(ue.ZP,{itemLayout:"horizontal",dataSource:n,rowKey:"id",header:(0,W.jsxs)(he.Z,{spinning:k,children:[(0,W.jsx)(xe.Z,{indeterminate:p,disabled:0===n.length,checked:h,onChange:e=>{if(e.target.checked){const e=[];for(let t of n)e.push(t.id);d(e)}else d([]);u(!1),x(e.target.checked)},children:"\u5168\u9009"}),(0,W.jsx)(a.Z,{type:"text",disabled:0===n.length,icon:(0,W.jsx)(ge.Z,{}),onClick:()=>{0!==l.length?E(Ie,t,l).then((()=>{T.ZP.success("\u5220\u9664\u6210\u529f"),d([]),x(!1),u(!1),r()})).catch((e=>T.ZP.error("\u5220\u9664\u5931\u8d25, \u539f\u56e0\u662f: "+e))):T.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u9700\u5220\u9664")},children:"\u5220\u9664"}),(0,W.jsx)(a.Z,{type:"text",disabled:0===n.length,icon:(0,W.jsx)(ye.Z,{}),onClick:()=>{clearTimeout(B),B=setTimeout((()=>{clearTimeout(B);const e={};S&&(e.coverByName=1),L(e)}),555)},onDoubleClick:()=>{clearTimeout(B),j(!0)},children:"\u5bfc\u51fa"}),(0,W.jsx)(o.Z,{title:"\u4e0d\u652f\u6301\u5bfc\u5165",mouseEnterDelay:2,children:(0,W.jsx)(a.Z,{type:"text",disabled:0===n.length,icon:(0,W.jsx)(Ce.Z,{}),onClick:()=>{if(0===l.length)return void T.ZP.info("\u6ca1\u6709\u9009\u4e2d\u4efb\u4f55\u884c, \u65e0\u6cd5\u590d\u5236");const e=N(!0);ve.Z.copyToClipboard(JSON.stringify(e))&&T.ZP.success("\u590d\u5236\u6210\u529f")},children:"\u590d\u5236JSON\u914d\u7f6e"})})]}),footer:(0,W.jsxs)(he.Z,{spinning:k,children:[(0,W.jsx)(P.Z,{type:"url",placeholder:"\u914d\u7f6e\u5bfc\u5165\u6587\u4ef6\u5730\u5740",value:Z,onChange:e=>{var t;b(null===(t=e.target.value)||void 0===t?void 0:t.trim())},allowClear:!0}),(null===Z||void 0===Z?void 0:Z.length)>0?(0,W.jsx)(a.Z,{onClick:R,icon:(0,W.jsx)(je.Z,{}),children:"\u5bfc\u5165"}):(0,W.jsx)(me.default,{maxCount:1,beforeUpload:e=>R(e),children:(0,W.jsx)(a.Z,{icon:(0,W.jsx)(je.Z,{}),children:"\u5bfc\u5165"})})]}),renderItem:e=>(0,W.jsx)(ue.ZP.Item,{actions:[(0,W.jsx)(a.Z,{type:"link",onClick:()=>{return t=e.scriptContent,y(t),void f(!0);var t},children:"\u811a\u672c"},"list-item-srcipt")],children:(0,W.jsx)(fe.Z,{loading:!1,children:(0,W.jsx)(ue.ZP.Item.Meta,{avatar:(0,W.jsx)(xe.Z,{value:e.id,checked:l.indexOf(e.id)>=0,onChange:I}),title:e.name,description:e.description})})})})}),(0,W.jsx)(pe.Z,{title:"\u811a\u672c\u5185\u5bb9",open:m,width:"60%",footer:null,onCancel:()=>{y(null),f(!1)},children:(0,W.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:(0,W.jsx)(w.default.Paragraph,{code:!0,copyable:!0,children:g})})}),(0,W.jsx)(pe.Z,{title:"\u5bfc\u51fa URL \u6587\u4ef6\u914d\u7f6e",open:C,width:"20%",footer:null,onCancel:()=>j(!1),children:(0,W.jsx)(xe.Z,{checked:S,onChange:e=>v(e.target.checked),on:!0,children:"\u540c\u540d\u8986\u76d6"})})]})},Le=e=>{let{lang:t,context:n,basicButtons:i,expandAddButton:c,editorHelpRender:l,refreshManage:d}=e;i=ce(i);const p=c?(e=>b.listAllConfig(e))(t):[],u=e=>n.onConvert([e]);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(r.Z,{style:{marginTop:"10px"},children:[i.map(((e,t)=>(0,W.jsx)(s.Z,{style:{marginLeft:"10px"},children:(0,W.jsx)(o.Z,{title:e.description,mouseEnterDelay:1,children:(0,W.jsx)(a.Z,{onClick:()=>u(e.scriptContent),children:e.name})})},t))),c?(0,W.jsx)(s.Z,{style:{marginLeft:"10px"},children:(0,W.jsx)(ne,{lang:t,context:n,config:c,editorHelpRender:l,refreshScript:d})}):null]}),p.length>0&&(0,W.jsxs)(r.Z,{style:{marginTop:"10px"},children:[(0,W.jsx)(Be,{lang:t,dataSource:p,refreshScript:d}),p.map(((e,n)=>(0,W.jsx)(s.Z,{style:{marginLeft:"10px"},children:(0,W.jsx)(re,{lang:t,config:e,editorHelpRender:l,refreshScript:d,handleConvert:u})},n)))]})]})};var Oe=n(9026),De=n(7966),Fe=n(2138);const{addCombination:Re,updateCombination:Ke,deleteCombination:$e}=b,{Text:qe}=w.default,Me="\u81ea\u5b9a\u4e49\u7ec4\u5408",Ue=e=>{let{lang:t,combinationConfig:n,refreshManage:r}=e;const[s,o]=i.useState(),[c,l]=i.useState();n.name=n.name||Me,n.description=n.description||n.name;return(0,W.jsx)(k.Z,{icon:null,cancelText:"\u53d6\u6d88",okText:"\u65b0\u5efa",onConfirm:()=>{const e={};e.name=s||Me,e.description=c||e.name,e.combination=[],E(Re,t,e).then((()=>{T.ZP.success("\u521b\u5efa\u6210\u529f"),r()})).catch((e=>T.ZP.warn("\u521b\u5efa\u5931\u8d25, \u539f\u56e0\u662f"+e)))},placement:"right",title:(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(w.default.Title,{level:5,children:"\u65b0\u5efa\u7ec4\u5408"}),(0,W.jsx)(P.Z,{addonBefore:"\u7ec4\u5408\u540d\u79f0",placeholder:n.name,value:s,onChange:e=>o(e.target.value)}),(0,W.jsx)(P.Z,{style:{marginTop:"3px"},addonBefore:"\u7ec4\u5408\u4f5c\u7528",placeholder:n.description,value:c,onChange:e=>l(e.target.value)})]}),children:(0,W.jsx)(a.Z,{style:{marginLeft:"10px"},shape:"circle",type:"text",icon:(0,W.jsx)(Fe.Z,{}),size:"small"})})},Ve=e=>{let{visible:t,setVisible:n,handleAddConfig:r,configDataSource:s}=e;const[a,c]=i.useState(),l=[{title:"\u540d\u79f0",dataIndex:"name",render:(e,t)=>(0,W.jsx)(o.Z,{title:t.description,children:e})},{title:"\u7c7b\u522b",dataIndex:"costom",render:e=>1===e?(0,W.jsx)(w.default.Text,{type:"warning",children:"\u81ea\u5b9a\u4e49"}):(0,W.jsx)(w.default.Text,{type:"success",children:"\u7cfb\u7edf"})}],d=()=>{n(!1),c(void 0)},p={type:"radio",onChange:(e,t)=>{c(Number(e))},selectedRowKeys:[a]};return(0,W.jsx)(pe.Z,{title:"\u914d\u7f6e\u9009\u62e9",open:t,cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",onCancel:d,onOk:()=>{r(a),d()},children:(0,W.jsx)(Oe.Z,{rowSelection:{...p},rowKey:"id",columns:l,dataSource:(()=>{const e=[];for(let t of s)e.push({id:t.id,name:t.name,description:t.description,costom:le(t)?0:1});return e})(),pagination:!1})})},_e=e=>{let{lang:t,combinationConfig:n,refreshManage:c,handleConvert:l,configDataSource:d}=e;const[p,u]=i.useState(!1),[h,x]=i.useState(!1),[m,f]=i.useState(!1),[g,y]=i.useState(n.name),[C,j]=i.useState(n.description),[S,v]=i.useState([...n.combination]),Z=(e=>{const t={};for(let n of e)t[n.id]={...n};return t})(d),w=S.map(((e,t)=>{const n=Z[e]||{};return n.index=t,n})),k=()=>{u(!1)},N=e=>{f(e),x(!0)};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(o.Z,{style:{marginLeft:"15px"},title:n.description,mouseEnterDelay:1,children:(0,W.jsx)(a.Z,{type:"dashed",onClick:e=>l(n.combination),children:n.name})}),(0,W.jsx)(o.Z,{title:"\u7f16\u8f91",mouseEnterDelay:2,children:(0,W.jsx)(a.Z,{shape:"circle",type:"text",onClick:e=>u(!0),icon:(0,W.jsx)(G.Z,{}),size:"small"})}),(0,W.jsxs)(A.Z,{open:p,onCancel:k,title:(()=>{if(S.length!==n.combination.length)return!0;for(let e=0;e++;e<=S.length)if(S[e]!==n.combination[e])return!0;return g!==n.name||C!==n.description})()?(0,W.jsx)(qe,{style:{color:"#1890ff"},strong:!0,children:"\u7f16\u8f91\u7ec4\u5408 *"}):(0,W.jsx)(qe,{children:"\u7f16\u8f91\u7ec4\u5408"}),onClose:k,footer:(0,W.jsx)(r.Z,{justify:"end",children:(0,W.jsxs)(I.Z,{children:[(0,W.jsx)(s.Z,{children:(0,W.jsx)(a.Z,{onClick:()=>{y(n.name),j(n.description),v([...n.combination])},children:"\u91cd\u7f6e"},"reset")}),(0,W.jsx)(s.Z,{children:(0,W.jsx)(a.Z,{onClick:()=>{E($e,t,n.id).then((()=>{T.ZP.success("\u5220\u9664\u6210\u529f"),u(!1),c()})).catch((e=>T.ZP.success("\u5220\u9664\u5931\u8d25, \u539f\u56e0\u662f"+e)))},children:"\u5220\u9664\u7ec4\u5408"},"delete")}),(0,W.jsx)(s.Z,{children:(0,W.jsx)(a.Z,{type:"primary",onClick:()=>{if(0===S.length)return void T.ZP.warn("\u8bf7\u5148\u7ef4\u62a4\u8282\u70b9");if(!g)return void T.ZP.warn("\u8bf7\u7ef4\u62a4\u7ec4\u5408\u540d\u79f0");for(const n of S)if(!le({id:n})&&!b.queryConfigById(t,n))return void T.ZP.warn("\u811a\u672c\u914d\u7f6e\u4e0d\u5b58\u5728, \u8bf7\u5237\u65b0\u9875\u9762");const e={id:n.id,name:g,description:C||g,combination:S};E(Ke,t,e).then((()=>{T.ZP.success("\u4fdd\u5b58\u6210\u529f"),u(!1),c()})).catch((e=>T.ZP.error("\u4fdd\u5b58\u5931\u8d25, \u539f\u56e0\u662f: "+e)))},children:"\u4fdd\u5b58\u7ec4\u5408"})})]})}),children:[(0,W.jsx)(P.Z,{addonBefore:"\u7ec4\u5408\u540d\u79f0",value:g,onChange:e=>y(e.target.value)}),(0,W.jsx)(P.Z,{style:{marginTop:"5px",marginBottom:"15px"},addonBefore:"\u7ec4\u5408\u4f5c\u7528",value:C,onChange:e=>j(e.target.value)}),(0,W.jsxs)(De.Z,{mode:"left",children:[0===w.length&&(0,W.jsx)(De.Z.Item,{color:"gray",children:(0,W.jsx)(o.Z,{title:"\u6dfb\u52a0",mouseEnterDelay:2,children:(0,W.jsx)(a.Z,{shape:"circle",type:"text",icon:(0,W.jsx)(Fe.Z,{}),onClick:e=>N(-1)})})},0),w.map(((e,t)=>(0,W.jsxs)(De.Z.Item,{color:e.id>0?"#faad14":"#52c41a",children:[(0,W.jsx)(o.Z,{title:"\u6dfb\u52a0",mouseEnterDelay:2,children:(0,W.jsx)(a.Z,{shape:"circle",type:"text",icon:(0,W.jsx)(Fe.Z,{}),onClick:e=>N(t)})}),(0,W.jsx)(o.Z,{title:"\u5220\u9664",mouseEnterDelay:2,children:(0,W.jsx)(a.Z,{shape:"circle",type:"text",icon:(0,W.jsx)(ge.Z,{}),onClick:e=>(e=>{S.splice(e,1),v([...S])})(t)})}),(0,W.jsx)(o.Z,{title:e.description,mouseEnterDelay:1,children:e.name})]},t)))]})]}),(0,W.jsx)(Ve,{visible:h,setVisible:x,handleAddConfig:e=>{if(!h)return;const t=[];for(let n=0;n<S.length;n++)t.push(S[n]),n===m&&t.push(e);-1===m&&t.push(e),v(t)},configDataSource:d})]})},ze=()=>(0,W.jsx)(a.Z,{type:"link",disabled:!0,children:"\u7ec4\u5408\u7ba1\u7406"}),He=e=>{let{lang:t,context:n,basicButtons:o,expandAddButton:a}=e;const c=(e=>b.listAllCombination(e)||[])(t)||[],[l,d]=i.useState(!1),p=(e=>b.listAllConfig(e)||[])(t);if(0===p.length)return(0,W.jsx)(W.Fragment,{});o=ce(o);const u=()=>d(!l),h=e=>{if(!e||0===e.length)return void T.ZP.error("\u4e0d\u5b58\u5728\u4efb\u4f55\u914d\u7f6e");let i=null;const r=e.map((e=>{const n=((e,t,n)=>{if(de(n))for(let i of t)if(n===i.id)return i;return b.queryConfigById(e,n)})(t,o,e);return n?n.scriptContent?{name:n.name,content:n.scriptContent}:(i="\u811a\u672c\u5185\u5bb9\u4e3a\u7a7a",null):(i="\u914d\u7f6e\u4e0d\u5b58\u5728",null)}));if(!i)return n.onConvert(r);T.ZP.error(i)},x=[...o,...p];return(0,W.jsxs)(r.Z,{style:{marginTop:"10px"},children:[(0,W.jsxs)(s.Z,{children:[(0,W.jsx)(ze,{}),(0,W.jsx)(Ue,{lang:t,combinationConfig:a,refreshManage:u})]}),c.map(((e,n)=>(0,W.jsx)(s.Z,{style:{marginLeft:"10px"},children:(0,W.jsx)(_e,{lang:t,combinationConfig:e,refreshManage:u,configDataSource:x,handleConvert:h})},n)))]})},We=e=>{let{lang:t,context:n,buttons:r={},expandScriptButton:s={},expandCombinationButton:o={},editorHelpRender:a}=e;const[c,l]=i.useState(!1);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Le,{lang:t,context:n,basicButtons:r,expandAddButton:s,editorHelpRender:a,refreshManage:()=>l(!c)}),(0,W.jsx)(He,{lang:t,context:n,basicButtons:r,expandAddButton:o})]})}},2480:()=>{}}]);